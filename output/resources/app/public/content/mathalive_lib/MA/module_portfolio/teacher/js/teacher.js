!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/",s(s.s=28)}([function(t,e){t.exports=React},function(t,e){t.exports=mobxReact},function(t,e){t.exports=mobx},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.App=void 0;const i=s(19),n=s(4);function o(t){if(!t)return t;console.log("init student",t),t.displayMode=""+t.displayMode=="2"?"2":"1",t.gender=t.gender,""===t.nickname&&(t.nickname=t.name);let e=t.avatar&&""!==t.avatar?t.avatar:"";return""===e&&(e="f"===t.gender||"F"===t.gender?"/content/mathalive_lib/images/default_candy.png":"/content/mathalive_lib/images/default_cheese.png",t.avatar=e),t}class r{static get isMobile(){return r._isMobile}static get tempEl(){return r._tempEl}static pub_init(){const t=navigator.userAgent;r._isMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t)||/android/i.test(t),r._tempBnd=document.createElement("div"),r._tempBnd.style.display="none",r._tempEl=document.createElement("div"),r._tempBnd.appendChild(r._tempEl),null===document.body?document.addEventListener("DOMContentLoaded",t=>{document.body.appendChild(r._tempBnd)}):document.body.appendChild(r._tempBnd)}static get students(){return r._students}static get student(){return r._student}static get lang(){return r._lang}static get isDvlp(){return r._isDvlp}static get data_url(){return r._data_url}static get lesson(){return r._lesson}static get book(){return r._book}static get nextBook(){return r._nextBook}static get prevBook(){return r._prevBook}static get addOnHost(){return r._addOnHost}static setaddOnHost(t){r._addOnHost=t}static pub_load(t,e,s,i,n,a,l){r._lesson=i,r._book=s,r._nextBook=a,r._prevBook=l,r._students=[],t&&Array.isArray(t)&&t.forEach((t,e)=>{r._students[e]=o(t)}),r._student=o(e),n&&""!==n&&(r._addOnHost=n)}static pub_reloadStudents(t){n.getStudents((e,s)=>{for(;r._students.length>0;)r._students.pop();for(;r._students_inited.length>0;)r._students_inited.pop();for(let t=0,s=e.length;t<s;t++)r.isDvlp?r._students[t]=o(e[t]):r._students[t]=o({id:e[t].id,name:e[t].name,thumb:e[t].defaultThumbnail,avatar:e[t].profileThumbnail,nickname:""!==e[t].nickName?e[t].nickName:e[t].name,displayMode:e[t].displayMode,gender:e[t].gender,inited:!0}),console.log("student",e[t]),r._students_inited.push(e[t].id);t()})}static pub_parseStyle(t){return r._tempEl.style.cssText=t,r._tempEl.style}static pub_initAudio(){r._common_audio=document.getElementById("common_audio"),r._ding_audio=document.getElementById("ding_audio"),r._dingend_audio=document.getElementById("dingend_audio"),r._btn_audio=document.getElementById("btn_audio"),r._correct_audio=document.getElementById("correct_audio"),r._wrong_audio=document.getElementById("wrong_audio"),r._topad_audio=document.getElementById("topad_audio"),r._goodjob_audio=document.getElementById("goodjob_audio"),r._btn_back_audio=document.getElementById("btn_back_audio"),r._btn_page_audio=document.getElementById("btn_page_audio"),r._popup_audio=document.getElementById("popup_audio"),r._clock_audio=document.getElementById("clock_audio"),r._ts_bgm_audio=document.getElementById("ts_bgm_audio"),r._bs_audio=document.getElementById("bs_audio"),r._bb_audio=document.getElementById("bb_audio"),r._cd_audio=document.getElementById("cd_audio"),r._tc_audio=document.getElementById("tc_audio"),r._te_audio=document.getElementById("te_audio"),r._trg_bgm_audio=document.getElementById("trg_bgm_audio"),r._afc_audio=document.getElementById("afc_audio"),r._trs_audio=document.getElementById("trs_audio"),r._btn_choice_audio=document.getElementById("btn_choice_audio"),r._retry_audio=document.getElementById("retry_audio"),r._sorry_audio=document.getElementById("sorry_audio"),r._great_audio=document.getElementById("great_audio"),r._memorygame_flipcard_audio=document.getElementById("flipcard_audio"),r._ispy_gameclick_audio=document.getElementById("gameclick_audio"),r._game_timesetting_start_audio=document.getElementById("game_timesetting_start"),r._solution_btn_audio=document.getElementById("solution_btn_audio"),r._game_result_audio=document.getElementById("game_result_audio"),r._open_problom_audio=document.getElementById("open_problom_audio"),r._quiz_done_audio=document.getElementById("quiz_done_audio"),r._hit_up_audio=document.getElementById("hu_audio"),r._hit_down_audio=document.getElementById("hd_audio"),r._hit_good_audio=document.getElementById("hg_audio"),r._hit_wrong_audio=document.getElementById("hw_audio"),r._pick_presenter=document.getElementById("pick_presenter"),r._game_good_audio=document.getElementById("gg_audio")}static pub_playClock(){r._clock_audio&&(r._clock_audio.currentTime=4.5,r._clock_audio.play())}static pub_playPopup(){r._popup_audio&&(r._popup_audio.currentTime=0,r._popup_audio.play())}static pub_playBtnPage(){r._btn_page_audio&&(r._btn_page_audio.currentTime=0,r._btn_page_audio.play())}static pub_playBtnBack(){r._btn_back_audio&&(r._btn_back_audio.currentTime=0,r._btn_back_audio.play())}static pub_playGoodjob(){r._goodjob_audio&&(r._goodjob_audio.currentTime=0,r._goodjob_audio.play())}static pub_playDing(){r._ding_audio&&(r._ding_audio.currentTime=0,r._ding_audio.play())}static pub_playDingend(){r._dingend_audio&&(r._dingend_audio.currentTime=0,r._dingend_audio.play())}static pub_playToPad(){r._topad_audio&&(r._topad_audio.currentTime=0,r._topad_audio.play())}static pub_playBtnTab(){r._btn_audio&&(r._btn_audio.currentTime=0,r._btn_audio.play())}static pub_playCorrect(){r._correct_audio&&(r._correct_audio.currentTime=0,r._correct_audio.play())}static pub_playWrong(){r._wrong_audio&&(r._wrong_audio.currentTime=0,r._wrong_audio.play())}static pub_playTeamSelectBgm(){r._ts_bgm_audio&&(r._ts_bgm_audio.currentTime=0,r._ts_bgm_audio.play())}static pub_stopTeamSelectBgm(){r._ts_bgm_audio&&(r._ts_bgm_audio.pause(),r._ts_bgm_audio.currentTime=0)}static pub_playStartButton(){r._bs_audio&&(r._bs_audio.currentTime=0,r._bs_audio.play())}static pub_playBasicButton(){r._bb_audio&&(r._bb_audio.currentTime=0,r._bb_audio.play())}static pub_playCountDown(){r._cd_audio&&(r._cd_audio.currentTime=0,r._cd_audio.play())}static pub_playTimerClock(){r._tc_audio&&(r._tc_audio.currentTime=0,r._tc_audio.play())}static pub_stopTimerClock(){r._tc_audio&&(r._tc_audio.pause(),r._tc_audio.currentTime=0)}static pub_playTimerEnd(){r._te_audio&&(r._te_audio.currentTime=0,r._te_audio.play())}static pub_playResultGraph(){r._trg_bgm_audio&&(r._trg_bgm_audio.currentTime=0,r._trg_bgm_audio.play())}static pub_playFireworksClapping(){r._afc_audio&&(r._afc_audio.currentTime=0,r._afc_audio.play())}static pub_playTotalResult(){r._trs_audio&&(r._trs_audio.currentTime=0,r._trs_audio.play())}static pub_playChoiceBtn(){r._btn_choice_audio&&(r._btn_choice_audio.currentTime=0,r._btn_choice_audio.play())}static pub_playsorry(){r._sorry_audio&&(r._sorry_audio.currentTime=0,r._sorry_audio.play())}static pub_playretry(){r._retry_audio&&(r._retry_audio.currentTime=0,r._retry_audio.play())}static pub_playgreat(){r._great_audio&&(r._great_audio.currentTime=0,r._great_audio.play())}static pub_playFlipCard(){r._memorygame_flipcard_audio&&(r._memorygame_flipcard_audio.currentTime=0,r._memorygame_flipcard_audio.play())}static pub_playGameClick(){r._ispy_gameclick_audio&&(r._ispy_gameclick_audio.currentTime=0,r._ispy_gameclick_audio.play())}static pub_game_timesetting_start(){r._game_timesetting_start_audio&&(r._game_timesetting_start_audio.currentTime=0,r._game_timesetting_start_audio.play())}static pub_solution_btn_click(){r._solution_btn_audio&&(r._solution_btn_audio.currentTime=0,r._solution_btn_audio.play())}static pub_playGameresult(){r._game_result_audio&&(r._game_result_audio.currentTime=0,r._game_result_audio.play())}static pub_openProblom(){r._open_problom_audio&&(r._open_problom_audio.currentTime=0,r._open_problom_audio.play())}static pub_quizDone(){r._quiz_done_audio&&(r._quiz_done_audio.currentTime=0,r._quiz_done_audio.play())}static pub_pick_presenter(){r._pick_presenter&&(r._pick_presenter.currentTime=0,r._pick_presenter.play())}static pub_stop(){null!=r._common_audio.onended&&r._common_audio.onended.call(r._common_audio,new Event("ended")),r._common_audio.oncanplaythrough=null,isNaN(r._common_audio.duration)||r._common_audio.paused||r._common_audio.pause()}static pub_play(t,e){r.pub_stop(),t=i.nteString(t,"");const s=i.nteString(r._common_audio.getAttribute("src"),"");if(""===t&&""===s)return void(null!=e&&e(!0));""!==t&&s!==t&&(r._common_audio.src=t);const n=t=>{r._common_audio.onended=null,null!==e&&e(!0),r._common_audio.removeEventListener("error",n)};r._common_audio.onended=t=>{r._common_audio.onended=null,null!==e&&e(!!t),r._common_audio.removeEventListener("error",n)},r._common_audio.addEventListener("error",n),isNaN(r._common_audio.duration)?(r._common_audio.oncanplaythrough=t=>{0!==r._common_audio.currentTime&&(r._common_audio.currentTime=0),r._common_audio.play(),r._common_audio.oncanplaythrough=null},r._common_audio.load()):(0!==r._common_audio.currentTime&&(r._common_audio.currentTime=0),r._common_audio.oncanplaythrough=null,r._common_audio.play())}static pub_set(t,e,s){r._isDvlp=e,r._lang=s,n.set(e)}static pub_addInitedStudent(t){let e=!0;for(let s=0,i=r._students_inited.length;s<i;s++){r._students_inited[s]===t.id&&(e=!1)}e&&r._students_inited.push(t.id);const s=r._start_idx>0&&r._students.length>0&&r._students_inited.length>=r._students.length;return s&&(window.clearTimeout(r._start_idx),r._start_idx=-1),s}static pub_start(t){0===r._students.length||r._students_inited.length>=r._students.length?t():r._start_idx=window.setTimeout(t,2e3)}static pub_clear(){for(;r._students.length>0;)r._students.pop();for(;r._students_inited.length>0;)r._students_inited.pop()}static pub_playHitup(){r._hit_up_audio&&(r._hit_up_audio.currentTime=0,r._hit_up_audio.play())}static pub_playHitdown(){r._hit_down_audio&&(r._hit_down_audio.currentTime=0,r._hit_down_audio.play())}static pub_playHitgood(){r._hit_good_audio&&(r._hit_good_audio.currentTime=0,r._hit_good_audio.play())}static pub_playHitwrong(){r._hit_wrong_audio&&(r._hit_wrong_audio.currentTime=0,r._hit_wrong_audio.play())}static pub_playGamegood(){r._game_good_audio&&(r._game_good_audio.currentTime=0,r._game_good_audio.play())}}e.App=r,r._isMobile=!1,r._students=[],r._students_inited=[],r._student=null,r._lang="ko",r._isDvlp=!1,r._data_url="../data/",r._lesson="",r._book="",r._nextBook=!1,r._prevBook=!1,r._start_idx=-1,r.isStarted=!1,r._addOnHost="https://addonsapi.fel40.com"},function(t,e,s){"use strict";var i=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.postAttention=e.postViewDiv=e.getPreviewDmsResult=e.getPreviewResult=e.showSGiftBox=e.showSLivePointPop=e.launchSTool=e.clearPenTool=e.hidePenTool=e.showPenTool=e.showRecordTool=e.showSendButton=e.alertToStudent=e.showSLoading=e.showSMathKit=e.clearSPenTool=e.takePicture=e.uploadInclassReport=e.stopVideoRecord=e.startVideoRecord=e.switchCamera=e.stopCamera=e.pauseRecordPlayer=e.playRecordPlayer=e.startCustomCamera=e.startCamera=e.getStudents=e.uploadFileToServerMulti=e.uploadImageToServer=e.uploadFileToServer=e.stopVoiceRecord=e.startVoiceRecord=e.sendTeacher=e.disableSoftwareKeyboard=e.sendPAD=e.sendPADToID=e.sendLauncher=e.uploadStudentReport=e.addStudentForStudentReportType6=e.hideStudentReportListPage=e.showStudentReportListPage=e.showStudentReportUI=e.hideStudentReportUI=e.startStudentReportProcess=e.finishContentPage=e.showTMathKit=e.alertToTeacher=e.showTLoading=e.clearTPenTool=e.getBookCaptureInfo=e.uploadTImageToServer=e.useFractionBar=e.logOut=e.exitClass=e.getNaviInfo=e.launchPadTool=e.launchTool=e.exitBook=e.gotoBookByKey=e.gotoBook=e.set=void 0;const n=s(6);let o=!1;e.set=function(t){o=t},e.gotoBook=function(t,e){if(console.log("felsocket gotoBook",t,e),!o)try{window.tsoc_o.gotoBook(t,e)}catch(t){}},e.gotoBookByKey=function(t){if(console.log("felsocket gotoBookByKey",t),!o)try{window.tsoc_o.gotoBookByKey(t)}catch(t){}},e.exitBook=function(){if(console.log("felsocket exitBook"),!o)try{window.tsoc_o.exitBook()}catch(t){}},e.launchTool=function(t){if(console.log("felsocket launchTool",t),!o)try{window.tsoc_o.launchTool(t)}catch(t){}},e.launchPadTool=function(t){if(console.log("felsocket launchPadTool",t),!o)try{window.tsoc_o.launchPadTool(t)}catch(t){}},e.getNaviInfo=function(t){if(console.log("felsocket getNaviInfo",t),!o)try{window.tsoc_o.getNaviInfo(t)}catch(t){}},e.exitClass=function(){if(console.log("felsocket exitClass"),!o)try{window.tsoc_o.exitClass()}catch(t){}},e.logOut=function(){if(console.log("felsocket logOut"),!o)try{window.tsoc_o.logOut()}catch(t){}},e.useFractionBar=function(){if(console.log("felsocket useFractionBar"),!o)try{window.tsoc_o.useFractionBar()}catch(t){}},e.uploadTImageToServer=function(t,e,s,i){if(console.log("felsocket uploadTImageToServer",e,s,i),!o)try{window.tsoc_o.uploadImageToServer(t,e,s,i)}catch(t){}},e.getBookCaptureInfo=function(t){if(console.log("felsocket getBookCaptureInfo"),!o)try{window.tsoc_o.getBookCaptureInfo(t)}catch(t){}},e.clearTPenTool=function(){if(console.log("felsocket clearTPenTool"),!o)try{window.tsoc_o.clearPenTool()}catch(t){}},e.showTLoading=function(t){if(console.log("felsocket showTLoading",t),!o)try{window.tsoc_o.showLoading(t)}catch(t){}},e.alertToTeacher=function(t){if(console.log("felsocket alertToTeacher",t),!o)try{window.tsoc_o.alert(t)}catch(t){}},e.showTMathKit=function(t){if(console.log("felsocket showTMathKit",t),!o)try{window.tsoc_o.showMathKit(t)}catch(t){}},e.finishContentPage=function(){if(!o)try{window.tsoc_o.finishContentPage()}catch(t){}},e.startStudentReportProcess=function(t,e,s){if(!o)try{window.tsoc_o.startStudentReportProcess(t,e,s)}catch(t){}},e.hideStudentReportUI=function(){if(!o)try{window.tsoc_o.hideStudentReportUI()}catch(t){}},e.showStudentReportUI=function(){if(!o)try{window.tsoc_o.showStudentReportUI()}catch(t){}},e.showStudentReportListPage=function(){if(!o)try{window.tsoc_o.showStudentReportListPage()}catch(t){}},e.hideStudentReportListPage=function(){if(!o)try{window.tsoc_o.hideStudentReportListPage()}catch(t){}},e.addStudentForStudentReportType6=function(t){if(!o)try{window.tsoc_o.addStudentForStudentReportType6(t)}catch(t){}},e.uploadStudentReport=function(t,e,s){if(!o)try{window.psoc_o.uploadStudentReport(t,e,s)}catch(t){}},e.sendLauncher=function(t,e){if(5!==t||o)if(6!==t||o)if(7!==t||o){if(8===t)if(console.log("felsocket gotoPrevBook"),o)try{window.top.tsoc_o.gotoPrevBook()}catch(t){}else try{window.tsoc_o.gotoPrevBook()}catch(t){}else if(9===t)if(console.log("felsocket gotoNextBook"),o)try{window.top.tsoc_o.gotoNextBook()}catch(t){}else try{window.tsoc_o.gotoNextBook()}catch(t){}}else try{window.tsoc_o.setTitleBar(e)}catch(t){}else try{window.tsoc_o.showTitleBar()}catch(t){}else try{window.tsoc_o.hideTitleBar()}catch(t){}},e.sendPADToID=function(t,e,s){const i={type:e,data:s};if(o)try{window.top.tsoc_o.sendPADToID(t,i)}catch(t){}else try{window.tsoc_o.sendPADToID(t,i)}catch(t){}},e.sendPAD=function(t,e){const s={type:t,data:e};if(o)try{window.top.tsoc_o.sendAll(s)}catch(t){}else try{window.tsoc_o.sendAll(s)}catch(t){}},e.disableSoftwareKeyboard=function(){try{window.psoc_o.disableSoftwareKeyboard()}catch(t){}},e.sendTeacher=function(t,e){const s={type:t,data:e};if(o)try{null!==window.opener&&window.opener.tsoc_o.sendTeacher(s)}catch(t){}else try{window.psoc_o.sendTeacher(s)}catch(t){}},e.startVoiceRecord=function(){try{window.psoc_o.startVoiceRecord()}catch(t){}},e.stopVoiceRecord=function(){try{window.psoc_o.stopVoiceRecord()}catch(t){}},e.uploadFileToServer=function(t){try{window.psoc_o.uploadFileToServer(t)}catch(t){}},e.uploadImageToServer=function(t,e,s,i){try{window.psoc_o.uploadImageToServer(t,e,s,i)}catch(t){}},e.uploadFileToServerMulti=function(t){try{window.psoc_o.uploadFileToServerMulti(t)}catch(t){}},e.getStudents=function(t){if(o)if(window.top.tsoc_o)try{window.top.tsoc_o.getStudents(t)}catch(t){}else t([],!1);else try{window.tsoc_o.getStudents(t)}catch(t){}},e.startCamera=function(t){if(!o)try{window.psoc_o.startCamera(t)}catch(t){}},e.startCustomCamera=function(t){o||window.parent.postMessage({from:"content",srcFrame:"book",type:"startCustomCamera",msg:t},"*")},e.playRecordPlayer=function(){o||window.parent.postMessage({from:"content",srcFrame:"book",type:"playRecordPlayer"},"*")},e.pauseRecordPlayer=function(){o||window.parent.postMessage({from:"content",srcFrame:"book",type:"pauseRecordPlayer"},"*")},e.stopCamera=function(){if(!o)try{window.psoc_o.stopCamera()}catch(t){}},e.switchCamera=function(t){if(!o)try{window.psoc_o.switchCamera(t)}catch(t){}},e.startVideoRecord=function(){if(!o)try{window.psoc_o.startVideoRecord()}catch(t){}},e.stopVideoRecord=function(){if(!o)try{window.psoc_o.stopVideoRecord()}catch(t){}},e.uploadInclassReport=function(t){if(!o)try{window.tsoc_o.uploadInclassReport(t)}catch(t){}},e.takePicture=function(t){if(!o)try{window.psoc_o.takePicture(t)}catch(t){}},e.clearSPenTool=function(){if(console.log("felsocket clearPenTool"),!o)try{window.psoc_o.clearPenTool()}catch(t){}},e.showSMathKit=function(t){if(console.log("felsocket showSMathKit",t),!o)try{window.psoc_o.showMathKit(t)}catch(t){}},e.showSLoading=function(t){if(console.log("felsocket showSLoading",t),!o)try{window.psoc_o.showLoading(t)}catch(t){}},e.alertToStudent=function(t){if(console.log("felsocket alertToStudent",t),!o)try{window.psoc_o.alert(t)}catch(t){}},e.showSendButton=function(t,e){if(console.log("felsocket showSendButton"),!o)try{window.psoc_o.showSendButton(t,e)}catch(t){}},e.showRecordTool=function(t){if(console.log("felsocket showRecordTool",t),!o)try{window.psoc_o.showRecordTool(t)}catch(t){}},e.showPenTool=function(){if(console.log("felsocket showPentool"),!o)try{window.psoc_o.showPenTool()}catch(t){}},e.hidePenTool=function(){if(console.log("felsocket hidePentool"),!o)try{window.psoc_o.hidePenTool()}catch(t){}},e.clearPenTool=function(){if(console.log("felsocket clearPenTool"),!o)try{window.psoc_o.clearPenTool()}catch(t){}},e.launchSTool=function(t){if(console.log("felsocket launchTool",t),!o)try{window.psoc_o.launchTool(t)}catch(t){}},e.showSLivePointPop=function(t){if(console.log("felsocket showLivePointPop"),!o)try{window.psoc_o.showLivePointPop(t)}catch(t){}},e.showSGiftBox=function(t,e){if(console.log("felsocket showGiftBox"),!o)try{window.psoc_o.showGiftBox(t,e)}catch(t){}},e.getPreviewResult=function(t){return i(this,void 0,void 0,(function*(){return new Promise(e=>{if(o)e([]);else{let s=!1;const i=t=>{s||(s=!0,e(t))};window.tsoc_o.getPreviewResult(i,t),n.delay(()=>{s||(s=!0,e([]))},5e3)}})}))},e.getPreviewDmsResult=function(t){return i(this,void 0,void 0,(function*(){return new Promise(e=>{if(o)e([]);else{let s=!1;const i=t=>{s||(s=!0,e(t))};window.tsoc_o.getPreviewDmsResult(i,t),n.delay(()=>{s||(s=!0,e([]))},5e3)}})}))},e.postViewDiv=function(t){return i(this,void 0,void 0,(function*(){console.log("postViewDiv",t),window.top.postMessage({type:"viewDiv",msg:t,from:"content"},"*")}))},e.postAttention=function(t){return i(this,void 0,void 0,(function*(){console.log("postAttention",t),window.top.postMessage({type:"attention",msg:t,from:"content"},"*")}))}},function(t,e,s){"use strict";var i=s(20),n=Object.prototype.toString;function o(t){return"[object Array]"===n.call(t)}function r(t){return void 0===t}function a(t){return null!==t&&"object"==typeof t}function l(t){return"[object Function]"===n.call(t)}function d(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),o(t))for(var s=0,i=t.length;s<i;s++)e.call(null,t[s],s,t);else for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.call(null,t[n],n,t)}t.exports={isArray:o,isArrayBuffer:function(t){return"[object ArrayBuffer]"===n.call(t)},isBuffer:function(t){return null!==t&&!r(t)&&null!==t.constructor&&!r(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:a,isUndefined:r,isDate:function(t){return"[object Date]"===n.call(t)},isFile:function(t){return"[object File]"===n.call(t)},isBlob:function(t){return"[object Blob]"===n.call(t)},isFunction:l,isStream:function(t){return a(t)&&l(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:d,merge:function t(){var e={};function s(s,i){"object"==typeof e[i]&&"object"==typeof s?e[i]=t(e[i],s):e[i]=s}for(var i=0,n=arguments.length;i<n;i++)d(arguments[i],s);return e},deepMerge:function t(){var e={};function s(s,i){"object"==typeof e[i]&&"object"==typeof s?e[i]=t(e[i],s):e[i]="object"==typeof s?t({},s):s}for(var i=0,n=arguments.length;i<n;i++)d(arguments[i],s);return e},extend:function(t,e,s){return d(e,(function(e,n){t[n]=s&&"function"==typeof e?i(e,s):e})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e){t.exports=_},function(t,e,s){"use strict";var i=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.getBounds=e.getTimeStr=e.wait=void 0;const n=s(6);e.wait=function(t){return i(this,void 0,void 0,(function*(){return new Promise(e=>{n.delay(e,t)})}))},e.getTimeStr=function(t,e){const s=Math.round(e/1e3);let i=Math.round(t/1e3),n=Math.floor(i/60),o=Math.floor(n/60),r="";return i%=60,n%=60,o>0||s>=3600?(r=o+":",r+=n>=10?n+":":"0"+n+":"):s>=600?r+=n>=10?n+":":"0"+n+":":r=n+":",r+=i>=10?i:"0"+i,r},e.getBounds=function(t){const e={left:0,top:0,width:0,height:0};if(!t)return e;try{const s=t.getBoundingClientRect();e.left=s.left,e.top=s.top,e.width=s.width,e.height=s.height}catch(t){}const s=t.ownerDocument,i=s.body,n=s.documentElement;e.left=e.left-(n.clientLeft||i.clientLeft||0),e.top=e.top-(n.clientTop||i.clientTop||0);const o=s.defaultView;return e.left+=o.pageXOffset||n.scrollLeft||i.scrollLeft,e.top+=o.pageYOffset||n.scrollTop||i.scrollTop,e}},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0});const n=s(0),o=s(2),r=s(1),a=s(17),l=s(19);let d=class extends n.Component{constructor(t){super(t),this.m_btnH=0,this.m_max=0,this.m_sy=-1,this.m_vy=-1,this.m_time=-1,this.m_bSend=!1,this.m_state={y:0,alpha:1,tDur:0,aDur:0,isOn:!1,disabled:!1},this._ref=t=>{if(this.m_max>0||!t)return;t.setAttribute("touch-action","none");const e=window.getComputedStyle(t),s=l.nteFloat(e.height,0),i=l.nteFloat(e.bottom,0);s>0&&(this.m_btnH=s,"pad"===this.props.type?this.m_max=i-s-35:this.m_max=s+i+10,this.props.view||(this.m_state.y=this.m_max))},this._down=t=>{this.m_state.isOn||this.m_state.disabled||void 0!==this.props.disable&&this.props.disable||(this.m_state.y=this.props.originY,this.m_state.alpha=1,this.m_state.tDur=0,this.m_state.aDur=0,this.m_state.isOn=!0,this.m_vy=0,this.m_time=Date.now())},this._start=(t,e)=>{this.m_sy=e.y,this.m_bSend=!0},this._drag=(t,e)=>{if(!this.m_state.isOn||this.m_state.disabled)return;let s=e.y-this.m_sy;"teacher"===this.props.type?(e.deltaY<-1?this.m_bSend=!1:e.deltaY>=0&&(this.m_bSend=!0),s<0&&(s=0)):(e.deltaY>1?this.m_bSend=!1:e.deltaY<=0&&(this.m_bSend=!0),s>0&&(s=0)),!1===this.props.preventDrag&&(this.m_state.y=s+this.props.originY);const i=Date.now();this.m_vy=e.deltaY/(i-this.m_time),this.m_time=i},this._stop=(t,e)=>{if(this.m_state.isOn&&!this.m_state.disabled)if(this.m_bSend){let t=.5*this.m_vy*1e3,s=e.y-this.m_sy;"teacher"===this.props.type?(t<this.m_btnH?t=this.m_btnH:t>4*this.m_btnH&&(t=4*this.m_btnH),s<0&&(s=0)):(-1*t<this.m_btnH?t=-this.m_btnH:-1*t>4*this.m_btnH&&(t=-4*this.m_btnH),s>0&&(s=0)),this.m_state.tDur=.5,this.m_state.aDur=.5,this.m_state.alpha=0,this.m_state.y=s+t+this.props.originY,this.props.onSend()}else this.m_state.isOn=!1,this.m_state.tDur=.3,this.m_state.aDur=0,this.m_state.y=this.props.originY},t.sended?(this.m_state.alpha=0,this.m_state.disabled=!0):t.view?(this.m_state.y=t.originY,this.m_state.alpha=1,this.m_state.tDur=.3,this.m_state.aDur=0,this.m_state.isOn=!1,this.m_state.disabled=!1):t.view||(this.m_state.y=t.originY,this.m_state.alpha=0,this.m_state.tDur=.3,this.m_state.aDur=.3,this.m_state.isOn=!1,this.m_state.disabled=!0)}componentWillReceiveProps(t){t.sended&&!this.props.sended?(this.m_state.alpha=0,this.m_state.disabled=!0):t.view&&!this.props.view?(this.m_state.y=t.originY,this.m_state.alpha=1,t.preventUpWhenView?(this.m_state.tDur=0,this.m_state.aDur=.3):(this.m_state.tDur=.3,this.m_state.aDur=0),this.m_state.isOn=!1,this.m_state.disabled=!1):!t.view&&this.props.view?(this.m_state.y=this.m_max,this.m_state.alpha=0,this.m_state.tDur=.3,this.m_state.aDur=.3,this.m_state.isOn=!1,this.m_state.disabled=!0):!t.view||t.sended||this.m_state.isOn||t.originY===this.props.originY||(this.m_state.y=t.originY,this.m_state.tDur=.3,this.m_state.aDur=0),!this.props.isRetry&&t.isRetry&&(this.m_state.y=t.originY,this.m_state.alpha=1,t.preventUpWhenView?(this.m_state.tDur=0,this.m_state.aDur=.3):(this.m_state.tDur=.3,this.m_state.aDur=0),this.m_state.isOn=!1,this.m_state.disabled=!1)}render(){const{y:t,tDur:e,aDur:s,alpha:i,isOn:o,disabled:r}=this.m_state;let l={transform:`translateY(${t}px)`,transition:`transform ${e}s, opacity ${s/2}s ${s/2}s`,opacity:i,pointerEvents:r||!this.props.view?"none":"auto"};this.props.preventDrag&&(l={});const d=[];return"pad"===this.props.type?d.push("fel_toteacher"):d.push("fel_topad"),o&&d.push("on"),this.props.isVisiblePenTool&&this.props.isVisiblePenTool&&d.push("up"),n.createElement(a.DraggableCore,{onMouseDown:this._down,onDrag:this._drag,onStart:this._start,onStop:this._stop},n.createElement("button",{ref:this._ref,className:d.join(" ")+(this.props.className?" "+this.props.className:""),style:l},n.createElement("span",{className:"revise"+(this.props.isRevise?" on":""),style:{display:this.props.isRevise?"":"none"}})))}};i([o.observable],d.prototype,"m_state",void 0),d=i([r.observer],d),e.default=d},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r},n=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.SendnShare=e.SubmitList=void 0;const o=s(0),r=s(2),a=s(1),l=s(3),d=s(6),p=s(7),c=s(16),h=s(46),u=s(47),m=s(49),_=s(17),v=s(4);var b,y;!function(t){t[t.LODING=0]="LODING",t[t.READY=1]="READY",t[t.PLAY=2]="PLAY",t[t.PAUSE=3]="PAUSE",t[t.STOP=4]="STOP"}(b||(b={})),function(t){t[t.VIEW=0]="VIEW",t[t.READY=1]="READY",t[t.WAIT_START=2]="WAIT_START",t[t.RECORDING=3]="RECORDING",t[t.WAIT_END=4]="WAIT_END",t[t.RECORDED=5]="RECORDED",t[t.SENDING=6]="SENDING",t[t.SENDED=7]="SENDED"}(y||(y={}));let f=class extends o.Component{constructor(t){super(t),this.m_view=!1,this._curIdx=-1,this._sIdx=-1,this._imageIdx=0,this._time=0,this.playlistOpen=!1,this.beatSelect={image:0,mp3:""},this.beatProg=1,this.presenterBeat=[],this.beatList=[],this.beatPlayTime=[57,53,50,49,56,47],this.beatAudio=new Audio,this.getBeatTime=0,this._audio=new m.MPlayer(new m.MConfig(!1)),this._video=new m.MPlayer(new m.MConfig(!0)),this._playCnt=0,this._loaded=!1,this.recordState="",this.recordType="",this.cTime=0,this.recordUrl="",this._isPlay=!1,this.isFull=!1,this._videoState=1,this._onBack=(t,e)=>{let s=this.props.submitStudents[this._curIdx][this._sIdx].student.id;this.props.onClosed(t,s),this.props.onSendLiveget(s),this._isPlay=!1,this._video.bPlay&&this._video.pause(),this._video.destory(),this._audio.bPlay&&this._audio.pause(),this._audio.destory(),this.recordState=""},this._onPrev=()=>{if(l.App.pub_playBtnTab(),0===this._sIdx)return;if(this._sIdx--,"video"===this.recordState){const t=this.props.submitStudents[this._curIdx][this._sIdx].videos[0];if(""===t||!t)return void this._sIdx++}else if("audio"===this.recordState){const t=this.props.submitStudents[this._curIdx][this._sIdx].audios[0];if(""===t||!t)return void this._sIdx++}if(this.props.submitStudents[this._curIdx][this._sIdx].nosubmit)return void this._sIdx++;p.wait(1e3);let t=this.props.submitStudents[this._curIdx][this._sIdx].student.id;t&&this._stopClick(),this.props.onPrev(t),this._imagebox.scrollTop=0,this._video.unload(),this._audio.unload(),this.beatAudio.pause,"lyrics_lab"===this.recordType&&(this.beatAudio.src=this.props.submitStudents[this._curIdx][this._sIdx].beat[0],this.beatAudio.play,this.beatAudio.loop=!0),this.presenterBeatRender(),"audio"===this.recordState?this._audio.load(this.props.submitStudents[this._curIdx][this._sIdx].audios[0]):"video"===this.recordState&&this._video.load(this.props.submitStudents[this._curIdx][this._sIdx].videos[0])},this._onNext=()=>{if(l.App.pub_playBtnTab(),this._sIdx===this.props.submitStudents[this._curIdx].length-1)return;if(this._sIdx++,"video"===this.recordState){const t=this.props.submitStudents[this._curIdx][this._sIdx].videos[0];if(""===t||!t)return void this._sIdx--}else if("audio"===this.recordState){const t=this.props.submitStudents[this._curIdx][this._sIdx].audios[0];if(""===t||!t)return void this._sIdx--}if(this.props.submitStudents[this._curIdx][this._sIdx].nosubmit)return void this._sIdx--;p.wait(1e3);let t=this.props.submitStudents[this._curIdx][this._sIdx].student.id;t&&this._stopClick(),this.props.onNext(t),this._imagebox.scrollTop=0,this._video.unload(),this._audio.unload(),this.beatAudio.pause,"lyrics_lab"===this.recordType&&(this.beatAudio.src=this.props.submitStudents[this._curIdx][this._sIdx].beat[0],this.beatAudio.play,this.beatAudio.loop=!0),this.presenterBeatRender(),"audio"===this.recordState?this._audio.load(this.props.submitStudents[this._curIdx][this._sIdx].audios[0]):"video"===this.recordState&&this._video.load(this.props.submitStudents[this._curIdx][this._sIdx].videos[0])},this.presenterBeatRender=()=>{this.presenterBeat=[];let t=["a","b","c","d","e","f"];for(let e=0;e<this.beatList.length;e++)this.props.submitStudents[this._curIdx][this._sIdx].beat[0]===this.beatList[e]?this.presenterBeat.unshift(o.createElement("li",{key:"beat"+e},o.createElement("button",{onClick:()=>this.beatPlay(e),className:this.beatSelect.mp3===this.beatList[e]&&2===this.beatProg?t[e]+" check pause":this.beatSelect.mp3===this.beatList[e]&&4===this.beatProg?t[e]+" check play":""+t[e]}))):this.presenterBeat.push(o.createElement("li",{key:"beat"+e},o.createElement("button",{onClick:()=>this.beatPlay(e),className:this.beatSelect.mp3===this.beatList[e]&&2===this.beatProg?t[e]+" check pause":this.beatSelect.mp3===this.beatList[e]&&4===this.beatProg?t[e]+" check play":""+t[e]})));this.forceUpdate()},this._refBox=t=>{!this._box&&t&&(this._box=t)},this._refImageBox=t=>{!this._imagebox&&t&&(this._imagebox=t,this._imagebox&&(this._imagebox.scrollTop=0))},this._refAudio=t=>{!this._audio.media&&t&&this._audio.mediaInited(t)},this._refVideo=t=>{!this._video.media&&t&&(this._video.mediaInited(t),this._video.addOnState((t,e)=>{3===t&&(this._loaded=!0,this._video.gotoAndPause(0))}))},this.playEnd=()=>{this.beatAudio.pause(),this.beatAudio.currentTime=0,this.beatProg=4,d.delay(()=>{this._audio.gotoAndPause(0),this._video.gotoAndPause(0),this._isPlay=!1},500)},this._stopClick=()=>{l.App.pub_playBtnTab(),this._audio.gotoAndPause(0),this._video.gotoAndPause(0),this.beatProg=4,this.beatAudio.pause(),this.beatAudio.currentTime=0,this._isPlay=!1},this._onPlayStop=t=>{l.App.pub_playBtnTab(),"lyrics_lab"===this.recordType&&(4===this.beatProg||1===this.beatProg?(this.beatAudio.play(),this.beatProg=2,this.beatAudio.currentTime=0):2===this.beatProg?(this.beatProg=3,this.beatAudio.pause()):3===this.beatProg&&(this.beatProg=2,this.beatAudio.play(),this.beatAudio.currentTime=t)),"audio"===this.recordState?this._audio.bPlay?(this._audio.pause(),this._isPlay=!1):(this._audio.play(),this._isPlay=!0):"video"===this.recordState&&(this._video.bPlay?(this._video.pause(),this._isPlay=!1):(this._video.play(),this._isPlay=!0))},this.dragStart=(t,e)=>{},this.dragStop=(t,e)=>{},this.barTimeCheck=()=>n(this,void 0,void 0,(function*(){var t;if("lyrics_lab"===this.recordType){this.beatProg=3,this.beatAudio.pause(),this.beatAudio.currentTime=0,yield p.wait(300);const e=null===(t=document.querySelector(".audio_box .control .video_time .crt_time"))||void 0===t?void 0:t.childNodes[0].nodeValue;let s;const i=this.beatAudio.src.substr(-5,1);if(e&&(s=e.split(":")),s&&"0"===s[0])this.beatAudio.currentTime=Number(s[1]);else if(s&&"1"===s[0])switch(i){case"1":this.beatAudio.currentTime=1+Number(s[1]);break;case"2":this.beatAudio.currentTime=2+Number(s[1]);break;case"3":this.beatAudio.currentTime=3+Number(s[1]);break;case"4":this.beatAudio.currentTime=1+Number(s[1]);break;case"5":this.beatAudio.currentTime=0+Number(s[1]);break;case"6":this.beatAudio.currentTime=3+Number(s[1])}(this._audio.bPlay||this._video.bPlay)&&(this.beatProg=2,this.beatAudio.play())}})),this._toggleFullscreen=()=>{l.App.pub_playBtnTab(),document.fullscreenElement===this._box||document.webkitFullscreenElement===this._box?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():this._box.requestFullscreen?this._box.requestFullscreen():this._box.webkitRequestFullscreen&&this._box.webkitRequestFullscreen(),this.isFull=!this.isFull},this._toggleMute=()=>{l.App.pub_playBtnTab(),this._audio.setMuted(!this._audio.muted),this._video.setMuted(!this._video.muted)},this._playlistOpen=()=>{this.playlistOpen=!this.playlistOpen},this.beatPlay=t=>{if(this.beatAudio.loop=!0,this.cTime=this.beatAudio.currentTime,this.beatSelect.mp3!==this.beatList[t])return this.beatSelect.mp3=this.beatAudio.src=this.beatList[t],this.beatSelect.image=t,this.beatProg=2,this.beatAudio.play(),void this.presenterBeatRender();2===this.beatProg?(this.beatProg=4,this.beatAudio.pause()):(this.beatProg=2,this.beatAudio.currentTime=this.cTime,this.beatAudio.play()),this.presenterBeatRender()};for(let t=1;t<7;t++)this.beatList.push(`/content/mathalive_lib/MA/module_portfolio/common/beat0${t}.mp3`)}componentDidUpdate(t){if(this.props.view&&!t.view){this.m_view=!0,this._curIdx=this.props.quizIdx,this.beatAudio.loop=!0,this._sIdx=d.findIndex(this.props.submitStudents[this._curIdx],{student:{id:this.props.studentId}}),this.recordType="lyrics_lab"===this.props.submitStudents[this._curIdx][this._sIdx].recordType?"lyrics_lab":"","lyrics_lab"===this.recordType?(this.presenterBeatRender(),this.beatAudio.src=this.props.submitStudents[this._curIdx][this._sIdx].beat[0]):this.beatAudio.src="";const t=this.props.submitStudents[this._curIdx][this._sIdx].record;"video"===t?(this.recordState="video",this.recordUrl=this.props.submitStudents[this._curIdx][this._sIdx].videos[0],this._video.load(this.recordUrl)):"audio"===t?(this.recordState="audio",this.recordUrl=this.props.submitStudents[this._curIdx][this._sIdx].audios[0],this._audio.load(this.recordUrl)):(this._videoState=1,this.recordState="",this.recordUrl=""),this.beatProg=1,this.playlistOpen=!1}else!this.props.view&&t.view&&(l.App.pub_playBtnTab(),this._imagebox.scrollTop=0,this.beatAudio.pause(),this._video.bPlay&&this._video.pause(),this._audio.bPlay&&this._audio.pause(),this._video.destory(),this._audio.destory(),this.beatProg=1,this.playlistOpen=!1,this.m_view=!1)}render(){const{from:t,studentId:e,showhide:s,contentType:i,contentName:n}=this.props;let r,a=0,l="",d="",p="",m="";console.log("this.props.submitStudents",this.props.submitStudents),this.props.submitStudents&&this.props.submitStudents.length>0&&this._curIdx>-1&&this._sIdx>-1&&(a=this.props.submitStudents[this._curIdx][this._sIdx].livePoint,void 0!==this.props.submitStudents[this._curIdx][this._sIdx].student.displayMode&&"1"===this.props.submitStudents[this._curIdx][this._sIdx].student.displayMode?(l=this.props.submitStudents[this._curIdx][this._sIdx].student.thumb,d=this.props.submitStudents[this._curIdx][this._sIdx].student.name):(l=this.props.submitStudents[this._curIdx][this._sIdx].student.avatar,d=void 0!==this.props.submitStudents[this._curIdx][this._sIdx].student.nickname&&""!==this.props.submitStudents[this._curIdx][this._sIdx].student.nickname?this.props.submitStudents[this._curIdx][this._sIdx].student.nickname:this.props.submitStudents[this._curIdx][this._sIdx].student.name),this.props.submitStudents[this._curIdx][this._sIdx].images&&(r=this.props.submitStudents[this._curIdx][this._sIdx].images,r&&(null==r?void 0:r.length)<=0?"type01"===i?r[0]="/content/mathalive_lib/MA/module_portfolio/common/bg_s_math_journal.png":"type02"===i?r[0]="/content/mathalive_lib/MA/module_portfolio/common/bg_s_role_playing.png":"type03"===i?r[0]="/content/mathalive_lib/MA/module_portfolio/common/bg_s_concept_board.png":"type04"===i?r[0]="/content/mathalive_lib/MA/module_portfolio/common/bg_s_lyrics_lab.png":"type05"===i?r[0]="/content/mathalive_lib/MA/module_portfolio/common/temp_letme_explain_problem.png":"pink"===i?r[0]="/content/mathalive_lib/MA/steam_portfolio/common/bg_t_pink.png":"orange"===i?r[0]="/content/mathalive_lib/MA/steam_portfolio/common/bg_t_orange.png":"blue"===i?r[0]="/content/mathalive_lib/MA/steam_portfolio/common/bg_t_blue.png":"green"===i?r[0]="/content/mathalive_lib/MA/steam_portfolio/common/bg_t_green.png":"purple"===i&&(r[0]="/content/mathalive_lib/MA/steam_portfolio/common/bg_t_purple.png"):void 0===r&&(console.log("img_send_error images"),r=[],r[0]="/content/mathalive_lib/images/img_send_error.png")),p=this.props.submitStudents[this._curIdx][this._sIdx].student.id+"",m=this.props.submitStudents[this._curIdx][this._sIdx].student.gender?this.props.submitStudents[this._curIdx][this._sIdx].student.gender:"");const v={position:"absolute",opacity:1,right:0,top:0,width:420,height:238,objectFit:"fill",overflow:"hidden",borderRadius:"6px 6px 0 0",zIndex:40};return o.createElement(c.CoverPopup,{className:"result_popup "+this.recordState,view:this.m_view,onClosed:this._onBack.bind(this,t,e)},o.createElement(u.MALiveHeader,{view:this.m_view,thumb:l,showhide:s,studentName:d,livePoint:a,gender:m,contentType:i,contentName:n}),r?void 0:o.createElement("div",{className:"result_cnt "+i},o.createElement("div",{className:"img_wrap no_image"},o.createElement("img",{className:"submitimg",src:"/content/mathalive_lib/images/img_send_error.png"}))),r&&(null==r?void 0:r.length)>0?r.map((t,e)=>o.createElement("div",{key:"q_"+e,className:"result_cnt "+i},o.createElement("div",{className:"wrap_bg"},o.createElement("div",{className:"img_wrap",ref:this._refImageBox},o.createElement(o.Fragment,null,"video"===this.recordState?o.createElement(_.default,{onStart:(t,e)=>this.dragStart(e,0),onStop:(t,e)=>this.dragStop(e,0)},o.createElement("div",{className:"video-wrapper",ref:this._refBox},o.createElement("div",{className:"video"},o.createElement("video",{controls:!1,style:v,autoPlay:!1,ref:this._refVideo})),o.createElement("div",{className:"btn-box video"},o.createElement("div",{className:"center-box"},o.createElement("div",{className:"audio_box_container"},o.createElement("div",{className:"audio_box",onClick:this.barTimeCheck,onTouchEnd:this.barTimeCheck},o.createElement(h.default,{player:this._video,disable:!1,isPlay:this._isPlay,complete:this.playEnd,togglePlay:this._onPlayStop,toggleFullscreen:this._toggleFullscreen,stopClick:this._stopClick,toggleMute:this._toggleMute,playType:"video",barDrag:!0,isFull:this.isFull})))),o.createElement("span",{className:"time-box",hidden:this._videoState<=1},o.createElement("img",{draggable:!1,hidden:this._videoState<2||this._videoState>4,src:"/content/mathalive_lib/MA/module_portfolio/common/icon_recording.png"}))))):void 0,"audio"===this.recordState?o.createElement(o.Fragment,null,o.createElement("div",{className:"audio"},o.createElement("audio",{controls:!1,autoPlay:!1,ref:this._refAudio})),o.createElement("div",{className:"btn-box audio"},o.createElement("div",{className:"center-box"},o.createElement("div",{className:"audio_box_container"},o.createElement("div",{className:"audio_box",onClick:this.barTimeCheck,onTouchEnd:this.barTimeCheck},o.createElement(h.default,{player:this._audio,disable:!1,isPlay:this._isPlay,complete:this.playEnd,togglePlay:this._onPlayStop,stopClick:this._stopClick,toggleFullscreen:this._toggleFullscreen,barDrag:!0,playType:"audio"})))),o.createElement("span",{className:"time-box",hidden:this._videoState<=1},o.createElement("img",{draggable:!1,hidden:this._videoState<2||this._videoState>4,src:"/content/mathalive_lib/MA/module_portfolio/common/icon_recording.png"})))):void 0,""!==this.recordState?o.createElement("img",{className:"video"===this.recordState?"submitimg video":"submitimg audio",src:"content/"===t.substr(0,8)?"/"+t:t}):o.createElement("img",{className:"submitimg",src:"content/"===t.substr(0,8)?"/"+t:t})))),""===this.recordState?o.createElement("div",{className:this.playlistOpen?"playlist open":"playlist",style:{display:"type04"===i?"block":"none"}},o.createElement("div",{className:"inner"},o.createElement("ul",null,this.presenterBeat)),o.createElement("button",{className:"btn_next",onClick:this._playlistOpen})):void 0)):void 0,o.createElement("div",{className:"control_page",style:{display:"list"===t?"":"none"}},o.createElement("button",{className:"btn_left",onClick:this._onPrev}),o.createElement("button",{className:"btn_menu",onClick:this._onBack.bind(this,t,e)}),o.createElement("button",{className:"btn_right",onClick:this._onNext})),o.createElement("div",{className:"audio"===this.recordState?"btn_container audio":"btn_container",style:{display:"presenter"===t?"":"none"}},o.createElement("button",{className:"btn_01",onClick:this._onBack.bind(this,t,e)},"Back")))}};i([r.observable],f.prototype,"m_view",void 0),i([r.observable],f.prototype,"_curIdx",void 0),i([r.observable],f.prototype,"_sIdx",void 0),i([r.observable],f.prototype,"_imageIdx",void 0),i([r.observable],f.prototype,"_time",void 0),i([r.observable],f.prototype,"playlistOpen",void 0),i([r.observable],f.prototype,"beatSelect",void 0),i([r.observable],f.prototype,"beatProg",void 0),i([r.observable],f.prototype,"presenterBeat",void 0),i([r.observable],f.prototype,"getBeatTime",void 0),i([r.observable],f.prototype,"_playCnt",void 0),i([r.observable],f.prototype,"_loaded",void 0),i([r.observable],f.prototype,"recordUrl",void 0),i([r.observable],f.prototype,"_isPlay",void 0),i([r.observable],f.prototype,"isFull",void 0),i([r.observable],f.prototype,"_videoState",void 0),f=i([a.observer],f);let g=class extends o.Component{constructor(){super(...arguments),this._step="setting",this.submitUserNum=0,this.userCnt=0,this.randomThumb0="",this.randomThumb1="",this.randomThumb2="",this.randomThumb3="",this.randomName="",this.displayMode="1",this.randomTime=!1,this.students=[],this.studentsThumb=[],this.studentsName=[],this._onMinus=()=>{this.props.view&&(this.userCnt<=1||(l.App.pub_playChoiceBtn(),this.userCnt--))},this._onPlus=()=>{this.props.view&&0!==this.userCnt&&(this.userCnt>=this.submitUserNum||4===this.userCnt||(l.App.pub_playChoiceBtn(),this.userCnt++))},this._hidePresenter=()=>{this.props.view&&(l.App.pub_playBtnTab(),this.props.hidePresenter())},this._showDetail=t=>{this.props.view&&(l.App.pub_quizDone(),this.props.showDetail(t))},this._onBack=()=>{this.props.view&&(l.App.pub_playBtnTab(),this._step="setting")},this._onSuffle=()=>{for(this.students=[];;){let t=Math.floor(Math.random()*l.App.students.length+0),e=this.students.findIndex(e=>e.id===l.App.students[t].id),s=d.findIndex(this.props.submitStudents[0],{student:{id:l.App.students[t].id}});if(!(e>-1||this.props.submitStudents[0][s].nosubmit)&&(this.students.push({id:l.App.students[t].id,name:l.App.students[t].name,nickname:l.App.students[t].nickname,thumb:l.App.students[t].thumb,avatar:l.App.students[t].avatar,displayMode:l.App.students[t].displayMode,gender:l.App.students[t].gender}),this.displayMode=this.students[0].displayMode,this.students.length===this.userCnt))break}},this._onPick=()=>{this.props.view&&(l.App.pub_pick_presenter(),this._onSuffle(),this._step="choose",this.randomThumb0=this.studentsThumb[0],this.randomName=this.studentsName[0],this._randomStart())},this._randomStart=()=>{this.props.view&&(this.randomTime||(l.App.pub_pick_presenter(),this.randomTime=!0,this._onSuffle(),l.App.students.map((t,e)=>{"1"===this.displayMode?(t.thumb&&""!==t.thumb?this.studentsThumb.push(t.thumb):this.studentsThumb.push(t.name.substring(0,2).toUpperCase()),this.studentsName.push(t.name)):"2"===this.displayMode&&(this.studentsThumb.push(t.avatar),this.studentsName.push(t.nickname))}),this._setTime(),setTimeout(()=>{this.randomTime=!1},2e3)))},this._setTime=()=>{setTimeout(()=>{this.randomThumb0=this.studentsThumb[Math.floor(Math.random()*this.studentsThumb.length)],this.randomThumb1=this.studentsThumb[Math.floor(Math.random()*this.studentsThumb.length)],this.randomThumb2=this.studentsThumb[Math.floor(Math.random()*this.studentsThumb.length)],this.randomThumb3=this.studentsThumb[Math.floor(Math.random()*this.studentsThumb.length)],this.randomName=this.studentsName[Math.floor(Math.random()*this.studentsName.length)],this.randomTime&&this._setTime()},50)}}componentDidUpdate(t){this.props.view&&!t.view&&(this._step="setting",this.submitUserNum=l.App.students.length-this.props.submitStudents[0].filter(t=>t.nosubmit).length,this.userCnt=this.submitUserNum>=4?4:this.submitUserNum)}render(){const{view:t}=this.props;return o.createElement("div",{className:"presenter",style:{display:t?"":"none"}},o.createElement("div",{className:"presenter_content"},o.createElement("h3",null,"Presenter"),o.createElement("button",{className:"btn_close",onClick:this._hidePresenter}),o.createElement("div",{className:"presenter_wrap",style:{display:"choose"===this._step?"":"none"}},o.createElement("ul",null,this.students.map((t,e)=>o.createElement("li",{key:"q_"+e,className:this.randomTime?"on random":"on click"},this.randomTime?void 0:o.createElement("span",{className:"ico_heart"}),this.randomTime?o.createElement("div",{className:"img"},"1"===t.displayMode?o.createElement("div",null,0===e?o.createElement("div",null,o.createElement("img",{src:this.randomThumb0,style:{display:""===t.thumb?"none":""}})):void 0,1===e?o.createElement("div",null,o.createElement("img",{src:this.randomThumb1,style:{display:""===t.thumb?"none":""}})):void 0,2===e?o.createElement("div",null,o.createElement("img",{src:this.randomThumb2,style:{display:""===t.thumb?"none":""}})):void 0,3===e?o.createElement("div",null,o.createElement("img",{src:this.randomThumb3,style:{display:""===t.thumb?"none":""}})):void 0,0===e?o.createElement("div",{className:"F"===t.gender?"defaultImg_f":"defaultImg_m",style:{display:""===t.thumb?"":"none"}},o.createElement("div",null,this.randomThumb0)):void 0,1===e?o.createElement("div",{className:"F"===t.gender?"defaultImg_f":"defaultImg_m",style:{display:""===t.thumb?"":"none"}},o.createElement("div",null,this.randomThumb1)):void 0,2===e?o.createElement("div",{className:"F"===t.gender?"defaultImg_f":"defaultImg_m",style:{display:""===t.thumb?"":"none"}},o.createElement("div",null,this.randomThumb2)):void 0,3===e?o.createElement("div",{className:"F"===t.gender?"defaultImg_f":"defaultImg_m",style:{display:""===t.thumb?"":"none"}},o.createElement("div",null,this.randomThumb3)):void 0):o.createElement("div",null,o.createElement("div",{style:{display:0===e?"":"none"}},o.createElement("img",{src:this.randomThumb0,style:{display:""===t.avatar?"none":""}})),o.createElement("div",{style:{display:1===e?"":"none"}},o.createElement("img",{src:this.randomThumb1,style:{display:""===t.avatar?"none":""}})),o.createElement("div",{style:{display:2===e?"":"none"}},o.createElement("img",{src:this.randomThumb2,style:{display:""===t.avatar?"none":""}})),o.createElement("div",{style:{display:3===e?"":"none"}},o.createElement("img",{src:this.randomThumb3,style:{display:""===t.avatar?"none":""}})))):o.createElement("div",{className:"img",onClick:this._showDetail.bind(this,t.id)},"1"===t.displayMode?o.createElement("div",null,o.createElement("img",{src:t.thumb,style:{display:""===t.thumb?"none":""}}),o.createElement("div",{className:"F"===t.gender?"defaultImg_f":"defaultImg_m",style:{display:""===t.thumb?"":"none"}},o.createElement("div",null,t.name.substring(0,2).toUpperCase()))):o.createElement("div",null,o.createElement("img",{src:t.avatar,style:{display:""===t.avatar?"none":""}}),o.createElement("img",{src:"/content/mathalive_lib/images/default_candy.png",style:{display:""===t.avatar&&"F"===t.gender?"":"none"}}),o.createElement("img",{src:"/content/mathalive_lib/images/default_cheese.png",style:{display:""===t.avatar&&"M"===t.gender?"":"none"}}))),this.randomTime?o.createElement("p",null,this.randomName):o.createElement("p",null,void 0!==t.displayMode&&"1"===t.displayMode?t.name:t.nickname)))),o.createElement("div",{className:"btn_control"},o.createElement("button",{className:"btn_01",onClick:this._onBack},"Back"),o.createElement("button",{className:"btn_02",onClick:this._randomStart},"Again"))),o.createElement("div",{className:"timesetting_wrap",style:{display:"setting"===this._step?"":"none"}},o.createElement("div",{className:"timebox"},o.createElement("div",{className:"time"},this.userCnt),o.createElement("button",{className:"btn_time minus",onClick:this._onMinus}),o.createElement("button",{className:"btn_time plus",onClick:this._onPlus})),o.createElement("div",{className:"btn_control"},o.createElement("button",{className:"btn_02",onClick:this._onPick},"Pick")))))}};i([r.observable],g.prototype,"_step",void 0),i([r.observable],g.prototype,"submitUserNum",void 0),i([r.observable],g.prototype,"userCnt",void 0),i([r.observable],g.prototype,"randomThumb0",void 0),i([r.observable],g.prototype,"randomThumb1",void 0),i([r.observable],g.prototype,"randomThumb2",void 0),i([r.observable],g.prototype,"randomThumb3",void 0),i([r.observable],g.prototype,"randomName",void 0),i([r.observable],g.prototype,"displayMode",void 0),i([r.observable],g.prototype,"randomTime",void 0),g=i([a.observer],g);let w=class extends o.Component{constructor(){super(...arguments),this._viewPresenter=!1,this.isFlip=[],this._viewDetail=!1,this._from="list",this._studentId="",this.thumeType=this.props.thumeType,this.isFinished=!1,this._onClick=(t,e)=>{l.App.pub_playBtnTab(),this.isFinished?(this._viewDetail=!0,this._from="list",this._studentId=e,this.props.onSendPresenter(e)):this.isFlip[t]=!this.isFlip[t]},this._showDetailPopup=t=>{this._from="presenter",this._viewDetail=!0,this._studentId=t,this.props.onSendPresenter(t)},this._closeDetailPopup=(t,e)=>{this._viewDetail=!1,"presenter"===t&&this.props.onSendLiveget(e)},this.onNext=t=>{this.props.onNext(t)},this.onPrev=t=>{this.props.onPrev(t)}}componentWillReceiveProps(t){if(!this.props.isReset&&t.isReset){if(this.isFlip.length>0)for(let t=0;t<this.isFlip.length;t++)this.isFlip[t]=!1;this.isFinished=!1}if(this.isFlip.length<=0)for(let e=0;e<t.submitStudent[0].length;e++)this.isFlip.push(!1)}componentDidUpdate(t){if(this.props.view&&!t.view&&(this.isFinished=!1,this._from="list"),this.props.isAllFlip&&!t.isAllFlip){for(let t=0;t<this.isFlip.length;t++)this.isFlip[t]=!0;this.isFinished=!0}}render(){const{type:t,submitStudent:e,showhide:s,contentType:i}=this.props;let n="";"3"===t?n="r3":"4"===t&&(n="r4");let r,a=[[]];if(e&&e.length>0){for(let t=0;t<e.length;t++)a.push(e[t]);a[0]=d.orderBy(e[0],["trycnt","order"],["desc","asc"])}return r="type01"===i?"Math Journal":"type02"===i?"Role Play":"type03"===i?"Concept Board":"type04"===i?"Lyrics Lab":"type05"===i?"Let Me Explain":"pink"===i||"orange"===i||"blue"===i||"green"===i||"purple"===i?"STEAM PORTFOLIO":"",o.createElement(o.Fragment,null,o.createElement("div",{className:"content "+n},o.createElement("div",{className:"thumbset"},(a&&a[0]).map((t,e)=>{if(t.trycnt>0){const n="2"===t.student.displayMode&&t.student.nickname?t.student.nickname:t.student.name,a="2"===t.student.displayMode?t.student.avatar:t.student.thumb;return o.createElement("div",{key:"q_"+e,className:"thumb_cnt "+(this.isFlip[e]?"":"user"),onClick:this._onClick.bind(this,e,t.student.id)},o.createElement("div",{className:"front"},""===a&&o.createElement("div",{className:"F"===t.student.gender?"defaultImg_f":"defaultImg_m"},o.createElement("div",null,n.substring(0,2).toUpperCase())),""!==a&&o.createElement("img",{src:a,style:{display:"show"===s?"":"none"}}),o.createElement("img",{src:"/content/mathalive_lib/images/penimage.png",style:{display:"hide"===s?"":"none"}}),o.createElement("div",{className:"name",style:{display:"show"===s?"":"none"}},n)),o.createElement("div",{className:"back"},t.playTime?o.createElement("p",{className:"play_time"},t.playTime):void 0,o.createElement("div",{className:`thumb_img ${i} ${i?"":"noheader"} ${t.videos.length>0&&t.videos[0]?"video":""}`},o.createElement("div",{className:"header"},r),t.videos.length>0&&t.videos[0]?o.createElement("video",{src:t.videos[0]}):o.createElement("img",{src:t.images&&t.images.length>0?"content/"===t.images[0].substr(0,8)?"/"+t.images[0]:t.images[0]:"/content/mathalive_lib/images/img_send_error.png"})),o.createElement("div",{className:"title user",style:{display:"show"===s?"":"none"}},""===a&&o.createElement("div",{className:"F"===t.student.gender?"defaultImg_f":"defaultImg_m"},o.createElement("div",null,n.substring(0,2).toUpperCase())),""!==a&&o.createElement("div",{className:"img"},o.createElement("img",{src:a})),n,o.createElement("div",{className:"live_bubble",style:{display:t.livePoint>0?"":" none"}},t.livePoint))))}{const i="2"===t.student.displayMode&&t.student.nickname?t.student.nickname:t.student.name,n="2"===t.student.displayMode?t.student.avatar:t.student.thumb;return o.createElement("div",{key:"q_"+e,className:"thumb_cnt"},o.createElement("div",{className:"not_submitted"}),"show"===s&&o.createElement("div",{className:"title user"},""===n&&o.createElement("div",{className:"F"===t.student.gender?"defaultImg_f":"defaultImg_m"},o.createElement("div",null,i.substring(0,2).toUpperCase())),""!==n&&o.createElement("div",{className:"img"},o.createElement("img",{src:n})),i))}}))),o.createElement(g,{view:this.props.viewPresenter,submitStudents:d.cloneDeep(a),hidePresenter:this.props.hidePresenter,showDetail:this._showDetailPopup}),o.createElement(f,{view:this._viewDetail,showhide:s,from:this._from,submitStudents:d.cloneDeep(a),onClosed:this._closeDetailPopup,onSendLiveget:this.props.onSendLiveget,quizIdx:this.props.quizIdx,studentId:this._studentId,onNext:this.onNext,onPrev:this.onPrev,contentType:i,contentName:r}))}};i([r.observable],w.prototype,"_viewPresenter",void 0),i([r.observable],w.prototype,"isFlip",void 0),i([r.observable],w.prototype,"_viewDetail",void 0),i([r.observable],w.prototype,"_from",void 0),i([r.observable],w.prototype,"_studentId",void 0),w=i([a.observer],w),e.SubmitList=w;let S=class extends o.Component{constructor(t){super(t),this._type="show",this._step="selection",this._listType="3",this._submitusers=[],this._viewPresenter=!1,this.isAllFlip=!1,this._thumeType=this.props.type,this._showPresenter=()=>{var t;if(!this.props.view)return;if(!this.isAllFlip)return;null===(t=document.querySelector("#wrap > .content-container"))||void 0===t||t.setAttribute("style","z-index: 1000;");const e=document.querySelector("#wrap .t_sendshare .contents.r3");e&&(e.scrollTop=0);document.querySelectorAll(".btn_heart").forEach((t,e)=>{t.setAttribute("style","display: none; z-index: 0")}),l.App.pub_quizDone(),this._viewPresenter=!0},this._hidePresenter=()=>{var t;null===(t=document.querySelector("#wrap > .content-container"))||void 0===t||t.removeAttribute("style");document.querySelectorAll(".btn_heart").forEach((t,e)=>{t.removeAttribute("style")}),this._viewPresenter=!1,this.props.onHidePresenter()},this._onShowHide=t=>{"show"===t?(this._type="show",this._step="list"):"hide"===t&&(this._type="hide",this._step="list"),l.App.pub_playBtnTab(),this.props.checkIsPlayed()},this.onSendLiveget=t=>{this.props.onSendLiveget(t)},this.onSendPresenter=t=>{this.props.onSendPresenter(t,this._type)},this._toggleBtn=t=>{l.App.pub_playBtnTab(),"show"===t?this._type="show":"hide"===t&&(this._type="hide")},this._callBackFnc=(t,e)=>{let s={live:e};v.sendPADToID(t,21,s)},this._onClickList=t=>{l.App.pub_playBtnTab(),this._listType=t},this.onNext=t=>{this.props.onNext(t,this._type)},this.onPrev=t=>{this.props.onPrev(t,this._type)}}componentWillReceiveProps(t){t.submitStudent.length>0&&(this._submitusers=d.cloneDeep(t.submitStudent))}componentDidUpdate(t){this.props.view&&!t.view&&(this._listType="3",this._viewPresenter=!1,this.isAllFlip=!1,this.props.isPlayed||(this._step="selection")),this.props.isComplete&&!t.isComplete&&(this.isAllFlip=!0)}render(){const{view:t,contentType:e}=this.props;return o.createElement("div",{className:"t_sendshare"+("selection"===this._step?" selection":""),style:{display:t?"":"none"}},o.createElement("div",{className:"top_header"},o.createElement("div",{className:this.isAllFlip?"presenter btn complete":"presenter btn",onClick:this._showPresenter},"Presenter"),o.createElement("div",{className:"select_list"},o.createElement("button",{className:"list_01"+("2"===this._listType?" on":""),onClick:this._onClickList.bind(this,"2")},o.createElement("span",null),o.createElement("span",null)),o.createElement("button",{className:"list_02"+("3"===this._listType?" on":""),onClick:this._onClickList.bind(this,"3")},o.createElement("span",null),o.createElement("span",null),o.createElement("span",null)),o.createElement("button",{className:"list_03"+("4"===this._listType?" on":""),onClick:this._onClickList.bind(this,"4")},o.createElement("span",null),o.createElement("span",null),o.createElement("span",null),o.createElement("span",null))),o.createElement("div",{className:"msg_text",style:{opacity:this.isAllFlip?0:1}},"Waiting for student responses...")),o.createElement("div",{className:"openhiding",style:{display:"list"===this._step?"":"none"}},o.createElement("div",{className:"inner"},o.createElement("button",{className:"show"===this._type?"on":"",onClick:this._toggleBtn.bind(this,"show")},"Show"),o.createElement("button",{className:"hide"===this._type?"on":"",onClick:this._toggleBtn.bind(this,"hide")},"Hide"))),o.createElement("div",{className:"content selection",style:{display:"selection"===this._step?"":"none"}},o.createElement("div",{className:"profile"},o.createElement("img",{src:"/content/mathalive_lib/images/ico_student_profile.png"}),o.createElement("p",{className:"t1"},"Student info"),o.createElement("p",{className:"t2",style:{opacity:this.isAllFlip?0:1}},"Waiting for student responses...")),o.createElement("div",{className:"btn_set"},o.createElement("button",{onClick:this._onShowHide.bind(this,"show")},o.createElement("span",null,"Show")),o.createElement("button",{onClick:this._onShowHide.bind(this,"hide")},o.createElement("span",null,"Hide")))),o.createElement(w,{view:"selection"===this._step,viewPresenter:this._viewPresenter,type:this._listType,thumeType:this._thumeType,submitStudent:this._submitusers,showhide:this._type,isReset:this.props.isReset,onSendLiveget:this.onSendLiveget,onSendPresenter:this.onSendPresenter,hidePresenter:this._hidePresenter,isAllFlip:this.isAllFlip,quizIdx:this.props.quizIdx,onNext:this.onNext,onPrev:this.onPrev,contentType:e||""}))}};i([r.observable],S.prototype,"_type",void 0),i([r.observable],S.prototype,"_step",void 0),i([r.observable],S.prototype,"_listType",void 0),i([r.observable],S.prototype,"_submitusers",void 0),i([r.observable],S.prototype,"_viewPresenter",void 0),i([r.observable],S.prototype,"isAllFlip",void 0),S=i([a.observer],S),e.SendnShare=S},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.BtnProgress=void 0;const n=s(0),o=s(1),r=s(2),a=s(6),l=s(15),d=s(3);let p=class extends n.Component{constructor(t){super(t),this.isHide=!1,this.timerid=-1,this._onClick=()=>{d.App.pub_playBtnTab(),this.props.onClick()},this.props.isEnd&&a.delay(()=>{this.isHide=!0},2500)}componentDidUpdate(t){this.props.isEnd&&!t.isEnd?this.timerid=a.delay(()=>{this.isHide=!0},2500):!this.props.isEnd&&t.isEnd&&(this.isHide=!1,clearTimeout(this.timerid))}render(){const{submitStudents:t,totalStudents:e,noFinishView:s}=this.props;return n.createElement("div",{className:"progressWrap"+(this.props.isEnd?" end":"")+(this.props.view?" on":"")},(()=>this.props.noRetryView&&this.props.isEnd?n.createElement(n.Fragment,null):n.createElement(l.ToggleBtn,{className:"btn_progress",view:this.props.view,onClick:this._onClick},n.createElement("span",null,`${t}/${e}`)))(),n.createElement("div",{className:"msg"+(this.isHide||s?" hide":"")},"Finish",n.createElement("span",null),n.createElement("span",null),n.createElement("span",null),n.createElement("span",null),n.createElement("span",null)))}};i([r.observable],p.prototype,"isHide",void 0),p=i([o.observer],p),e.BtnProgress=p},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.AlertPopup=e.WarningPopup=e.StrategyPopup=void 0;const n=s(0),o=s(2),r=s(1),a=s(16),l=s(6),d=s(3);let p=class extends n.Component{componentDidUpdate(t){if(this.props.view&&!t.view){if(!this.props.button){let t=this.props.delay;t||(t=800),l.delay(()=>{this.props.onComplete&&this.props.onComplete()},t)}}else!this.props.view&&t.view}render(){const{type:t}=this.props;let e="";0===t?e="The teacher has stopped you from the activity. After 3 seconds, only the contents has been created so far will be submitted.":1===t?e="All students are already in progress. If you restart, existing data will be deleted. Are you sure you want to request the submission?":2===t?e="You can share a solution only in the problem solving state.":3===t?e="Do you want to save the current learning screen? If there is already saved data, the current data will be overwritten.":4===t?e="Picture not taken.\nYou have reached the maximum number of pictures available.":5===t&&(e="For this activity, We recommend students to wear a headset or an earphone with a microphone.");let s="exclamation";return 4===t?s="nocamera":5===t&&(s="headset"),n.createElement("div",{className:"alertpop strategy"+(this.props.view?" show":"")},n.createElement("div",{className:"alertpop-inner"},n.createElement("div",{className:s}),n.createElement("div",{className:"ment"},e),n.createElement("div",{className:"buttons"+(this.props.isSingle?" single":"")+(this.props.button?"":" hide")},n.createElement("button",{className:"btn cancel",onClick:this.props.onCancel},"Cancel"),n.createElement("button",{className:"btn ok",onClick:this.props.onOk},"Ok"))))}};p=i([r.observer],p),e.StrategyPopup=p;let c=class extends n.Component{constructor(){super(...arguments),this.second=3,this.interval=null}componentDidUpdate(t){if(this.props.view&&!t.view){if(this.second=3,!this.props.button){let t=this.props.delay;t||(t=800),this.interval=setInterval(()=>{this.second--,0===this.second&&(this.props.onComplete&&this.props.onComplete(),null!==this.interval&&clearInterval(this.interval))},1e3)}}else!this.props.view&&t.view&&(null!==this.interval&&clearInterval(this.interval),this.props.onComplete&&this.props.onComplete())}render(){const{type:t}=this.props;let e="";return 0===t&&(e=`Submit your answer within <strong>${this.second} seconds.</strong>`),n.createElement("div",{className:"warningpopup",style:{display:this.props.view?"":"none"}},n.createElement("div",{className:"msg",dangerouslySetInnerHTML:{__html:e}}))}};i([o.observable],c.prototype,"second",void 0),c=i([r.observer],c),e.WarningPopup=c;class h extends n.Component{constructor(){super(...arguments),this._onOk=()=>{this.props.onOk&&this.props.onOk()},this._onClose=()=>{this.props.onClose&&this.props.onClose()}}componentDidUpdate(t){this.props.view&&!t.view||!this.props.view&&t.view&&d.App.pub_playBtnTab()}render(){const{view:t,msg:e,isSingle:s,msgclass:i}=this.props;return n.createElement(a.CoverPopup,{className:"alert_popup",view:t,onClosed:this.props.isSingle?this._onOk:this._onClose},n.createElement("div",{className:"pop_box"},n.createElement("span",{className:"ico_alert"}),n.createElement("span",{className:"text"+(i&&""!==i?" "+i:""),dangerouslySetInnerHTML:{__html:e}}),n.createElement("div",{className:"btns"},n.createElement("button",{className:"btn_cancel",onClick:this._onClose,style:{display:s?"none":""}},n.createElement("span",null,"Cancel")),n.createElement("button",{className:"btn_ok",onClick:this._onOk},n.createElement("span",null,"OK")))))}}e.AlertPopup=h},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.BtnSendLive=void 0;const n=s(0),o=s(1),r=s(15),a=s(3);let l=class extends n.Component{constructor(t){super(t),this._onClick=()=>{a.App.pub_playBtnTab(),this.props.onClick()}}componentDidUpdate(t){}render(){const{view:t,disabled:e,on:s,isStrategy:i}=this.props;return n.createElement(r.ToggleBtn,{className:"btn_heart",style:{right:i?"9px":"0"},view:t,disabled:e,on:s,onClick:this._onClick})}};l=i([o.observer],l),e.BtnSendLive=l},function(t,e,s){"use strict";var i=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.setLivePoint=void 0;const n=s(50),o=s(4);e.setLivePoint=function(t){return i(this,void 0,void 0,(function*(){let e=new FormData;e.append("score",t.score+""),e.append("userIdx",t.userIdx),e.append("clsIdx",t.clsIdx+""),e.append("depthItemIdx",t.depthItemIdx+""),o.showTLoading(!0),yield n.default({method:"post",url:t.addOnHost+`/ma/rw/${t.plusMinusType}/${t.liveType}`,data:e}).then(e=>i(this,void 0,void 0,(function*(){yield n.default.get(t.addOnHost+"/ma/rw/info",{params:{userIdx:t.userIdx}}).then(e=>i(this,void 0,void 0,(function*(){o.showTLoading(!1),e.data&&e.data.resultData&&e.data.resultData.map(e=>{t.callback({redScore:e.redScore,redAccScore:e.redAccScore,greenScore:e.greenScore,greenAccScore:e.greenAccScore})})}))).catch(e=>{o.showTLoading(!1),o.alertToTeacher("    ."),t.error(e)})}))).catch(e=>{o.showTLoading(!1),o.alertToTeacher("    ."),t.error(e)})}))}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(0);class n extends i.Component{componentDidUpdate(t){this.props.view&&!t.view||!this.props.view&&t.view}render(){const{view:t,keywords:e,type:s}=this.props;return i.createElement("div",{className:"keywords"},i.createElement("div",{className:"inner"},i.createElement("div",{className:"title"+(s&&2===s?" second":"")}),i.createElement("div",{className:"list"},i.createElement("ul",null,e.map((t,e)=>i.createElement("li",{key:"k"+e},t.keyword))))))}}e.default=n},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.ImgBtn=e.AudioBtn=e.ToggleBtn=void 0;const n=s(0),o=s(2),r=s(1);class a extends n.Component{constructor(t){super(t),this.m_pID=-1,this._inited=this._inited.bind(this),this._onClick=this._onClick.bind(this)}_inited(t){!this.m_el&&t&&(this.m_el=t,this.props.onRef&&this.props.onRef(t),t.setAttribute("touch-action","none"),t.addEventListener("pointerdown",e=>{if(!(this.m_pID>=0)){if(this.m_pID=e.pointerId,!this.props.disableCapture)try{t.setPointerCapture(this.m_pID)}catch(t){}this.props.onMouseDown&&this.props.onMouseDown(e)}}),t.addEventListener("pointerup",e=>{if(this.m_pID===e.pointerId){try{t.releasePointerCapture(this.m_pID)}catch(t){}this.m_pID=-1,this.props.onMouseUp&&this.props.onMouseUp(e)}}),t.addEventListener("pointerleave",e=>{if(this.props.disableCapture){if(this.m_pID!==e.pointerId)return;try{t.releasePointerCapture(this.m_pID)}catch(t){}this.m_pID=-1}this.props.onMouseLeave&&this.props.onMouseLeave(e)}),t.addEventListener("pointercancel",e=>{if(this.m_pID===e.pointerId){try{t.releasePointerCapture(this.m_pID)}catch(t){}this.m_pID=-1,this.props.onMouseLeave&&this.props.onMouseLeave(e)}}))}_onClick(t){this.props.onClick&&this.props.onClick(t),this.props.preventEvent&&(t.preventDefault(),t.stopPropagation())}componentDidUpdate(t){if((this.props.disabled&&!t.disabled||!this.props.view&&t.view)&&this.m_pID>=0){try{this.m_el&&this.m_el.releasePointerCapture(this.m_pID)}catch(t){}this.m_pID=-1}}}i([o.observable],a.prototype,"m_pID",void 0);let l=class extends a{constructor(t){super(t),this.m_on=!1,this.m_on=!0===t.on}componentWillReceiveProps(t){this.props.on!==t.on&&(this.m_on=!0===t.on)}render(){const t=[];this.props.className&&t.push(this.props.className),this.m_on&&t.push("on"),this.m_pID>0&&t.push("down");const e=t.join(" ");let s=this.props.style;return!1===this.props.view&&(s||(s={}),s.display="none"),n.createElement("button",{id:this.props.id,className:e,onClick:this._onClick,ref:this._inited,disabled:!0===this.props.disabled,draggable:!1,onTransitionEnd:this.props.onTransitionEnd,style:s},this.props.children)}};i([o.observable],l.prototype,"m_on",void 0),l=i([r.observer],l),e.ToggleBtn=l;let d=class extends l{constructor(t){super(t)}play(){this.m_on||(this.m_on=!0,this.props.playFnc(this.props.src,t=>{this.m_on&&(this.m_on=!1,this.props.onPause&&this.props.onPause(t))}))}_onClick(t){this.m_on?(this.props.pauseFnc(),this.m_on=!1):this.play(),super._onClick(t)}};i([o.action],d.prototype,"play",null),i([o.action],d.prototype,"_onClick",null),d=i([r.observer],d),e.AudioBtn=d;let p=class extends a{constructor(t){super(t),this.m_on=!1,this.m_on=!0===t.on}componentWillReceiveProps(t){this.props.on!==t.on&&(this.m_on=!0===t.on)}render(){const t=[];this.props.className&&t.push(this.props.className),this.m_on&&t.push("on"),this.m_pID>0&&t.push("down"),!0===this.props.disabled&&t.push("disable");const e=t.join(" ");let s=this.props.style;return!1===this.props.view&&(s||(s={}),s.display="none"),n.createElement("img",{id:this.props.id,className:e,onClick:this._onClick,ref:this._inited,draggable:!1,onTransitionEnd:this.props.onTransitionEnd,style:s,src:this.props.src,useMap:this.props.useMap})}};i([o.observable],p.prototype,"m_on",void 0),p=i([r.observer],p),e.ImgBtn=p},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r},n=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.CoverPopup=void 0;const o=s(0),r=s(2),a=s(1),l=s(7);let d=class extends o.Component{constructor(){super(...arguments),this.m_state="closed",this._open=()=>n(this,void 0,void 0,(function*(){"closed"===this.m_state&&(this.m_state="opening",yield l.wait(100),this.m_state="open")})),this._close=()=>n(this,void 0,void 0,(function*(){"open"===this.m_state&&(this.m_state="closing",yield l.wait(400),this.props.onClosed(),this.m_state="closed")}))}componentDidUpdate(t){this.props.view!==t.view&&(this.props.view?this._open():this._close())}render(){return o.createElement("div",{className:this.props.className+" "+this.m_state},this.props.children)}};i([r.observable],d.prototype,"m_state",void 0),d=i([a.observer],d),e.CoverPopup=d},function(t,e){t.exports=ReactDraggable},function(t,e,s){"use strict";t.exports=s(31)},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._toStringTimestamp=e.getDateStr=e.nteArray=e.intToHTMLcolor=e.nteBool=e.nteString=e.nteFloat=e.nteInt=e.nteUInt=e.getUnicUrl=e.getUnicNum=e.getUnic=void 0,Date.now||(Date.now=function(){return(new Date).getTime()});let i=0;function n(){return o().toString(36)}function o(){const t=Date.now();return t>i?i=t:i+=1,i}e.getUnic=n,e.getUnicNum=o,e.getUnicUrl=function(t){if(!t)return"";let e=t=t.trim();return 0!==e.indexOf("http://")&&0!==e.indexOf("https://")||(e=e.indexOf("?")>0?e+"&t="+n():e+"?t="+n()),e},e.nteUInt=function(t,e){if(null==t)return e;if("number"==typeof t)return isNaN(t)||t<0?e:Math.round(t);{const s=parseInt(String(t),10);return isNaN(s)||s<0?e:s}},e.nteInt=function(t,e){if(null==t)return e;if("number"==typeof t)return Math.round(t);{const s=parseInt(String(t),10);return isNaN(s)?e:s}},e.nteFloat=function(t,e){if(null==t)return e;if("number"==typeof t)return t;{const s=parseFloat(String(t));return isNaN(s)?e:s}},e.nteString=function(t,e){return null==t?e:String(t)},e.nteBool=function(t,e){if(null==t)return e;if("boolean"==typeof t)return t;const s=String(t);return"true"===s||"false"!==s&&e},e.intToHTMLcolor=function(t){let e,s,i,n=t-0;e=(255&n)<<16,s=65280&n,i=(16711680&n)>>>16,n=e|s|i;let o=n.toString(16);return o="#000000".substring(0,7-o.length)+o,o},e.nteArray=function(t){if(t){if(Array.isArray(t))return t;if("string"==typeof t){const e=t;if(e.indexOf("[")>=0&&e.indexOf("]")>0)try{return JSON.parse(e)}catch(t){}}const e=[];return e.push(t),e}return[]},e.getDateStr=function(t="."){const e=new Date,s=e.getFullYear(),i=e.getMonth()+1,n=e.getDate();return s+t+(i<10?"0"+i:""+i)+t+(n<10?"0"+n:""+n)},e._toStringTimestamp=function(t){let e;const s=t.getFullYear();let i=t.getMonth()+1+"";parseInt(i,10)<10&&(i="0"+i);let n=t.getDate()+"";return parseInt(n,10)<10&&(n="0"+n),e=s+"-"+i+"-"+n+" "+t.toTimeString().substr(0,8),e}},function(t,e,s){"use strict";t.exports=function(t,e){return function(){for(var s=new Array(arguments.length),i=0;i<s.length;i++)s[i]=arguments[i];return t.apply(e,s)}}},function(t,e,s){"use strict";var i=s(5);function n(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,s){if(!e)return t;var o;if(s)o=s(e);else if(i.isURLSearchParams(e))o=e.toString();else{var r=[];i.forEach(e,(function(t,e){null!=t&&(i.isArray(t)?e+="[]":t=[t],i.forEach(t,(function(t){i.isDate(t)?t=t.toISOString():i.isObject(t)&&(t=JSON.stringify(t)),r.push(n(e)+"="+n(t))})))})),o=r.join("&")}if(o){var a=t.indexOf("#");-1!==a&&(t=t.slice(0,a)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},function(t,e,s){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,s){"use strict";(function(e){var i=s(5),n=s(57),o={"Content-Type":"application/x-www-form-urlencoded"};function r(t,e){!i.isUndefined(t)&&i.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var a,l={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==e&&"[object process]"===Object.prototype.toString.call(e))&&(a=s(24)),a),transformRequest:[function(t,e){return n(e,"Accept"),n(e,"Content-Type"),i.isFormData(t)||i.isArrayBuffer(t)||i.isBuffer(t)||i.isStream(t)||i.isFile(t)||i.isBlob(t)?t:i.isArrayBufferView(t)?t.buffer:i.isURLSearchParams(t)?(r(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):i.isObject(t)?(r(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};l.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],(function(t){l.headers[t]={}})),i.forEach(["post","put","patch"],(function(t){l.headers[t]=i.merge(o)})),t.exports=l}).call(this,s(56))},function(t,e,s){"use strict";var i=s(5),n=s(58),o=s(21),r=s(60),a=s(63),l=s(64),d=s(25);t.exports=function(t){return new Promise((function(e,p){var c=t.data,h=t.headers;i.isFormData(c)&&delete h["Content-Type"];var u=new XMLHttpRequest;if(t.auth){var m=t.auth.username||"",_=t.auth.password||"";h.Authorization="Basic "+btoa(m+":"+_)}var v=r(t.baseURL,t.url);if(u.open(t.method.toUpperCase(),o(v,t.params,t.paramsSerializer),!0),u.timeout=t.timeout,u.onreadystatechange=function(){if(u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))){var s="getAllResponseHeaders"in u?a(u.getAllResponseHeaders()):null,i={data:t.responseType&&"text"!==t.responseType?u.response:u.responseText,status:u.status,statusText:u.statusText,headers:s,config:t,request:u};n(e,p,i),u=null}},u.onabort=function(){u&&(p(d("Request aborted",t,"ECONNABORTED",u)),u=null)},u.onerror=function(){p(d("Network Error",t,null,u)),u=null},u.ontimeout=function(){var e="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),p(d(e,t,"ECONNABORTED",u)),u=null},i.isStandardBrowserEnv()){var b=s(65),y=(t.withCredentials||l(v))&&t.xsrfCookieName?b.read(t.xsrfCookieName):void 0;y&&(h[t.xsrfHeaderName]=y)}if("setRequestHeader"in u&&i.forEach(h,(function(t,e){void 0===c&&"content-type"===e.toLowerCase()?delete h[e]:u.setRequestHeader(e,t)})),i.isUndefined(t.withCredentials)||(u.withCredentials=!!t.withCredentials),t.responseType)try{u.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&u.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){u&&(u.abort(),p(t),u=null)})),void 0===c&&(c=null),u.send(c)}))}},function(t,e,s){"use strict";var i=s(59);t.exports=function(t,e,s,n,o){var r=new Error(t);return i(r,e,s,n,o)}},function(t,e,s){"use strict";var i=s(5);t.exports=function(t,e){e=e||{};var s={},n=["url","method","params","data"],o=["headers","auth","proxy"],r=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];i.forEach(n,(function(t){void 0!==e[t]&&(s[t]=e[t])})),i.forEach(o,(function(n){i.isObject(e[n])?s[n]=i.deepMerge(t[n],e[n]):void 0!==e[n]?s[n]=e[n]:i.isObject(t[n])?s[n]=i.deepMerge(t[n]):void 0!==t[n]&&(s[n]=t[n])})),i.forEach(r,(function(i){void 0!==e[i]?s[i]=e[i]:void 0!==t[i]&&(s[i]=t[i])}));var a=n.concat(o).concat(r),l=Object.keys(e).filter((function(t){return-1===a.indexOf(t)}));return i.forEach(l,(function(i){void 0!==e[i]?s[i]=e[i]:void 0!==t[i]&&(s[i]=t[i])})),s}},function(t,e,s){"use strict";function i(t){this.message=t}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,t.exports=i},function(t,e,s){t.exports=s(29)},function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const i=s(18),n=s(0),o=s(32),r=s(3),a=s(4),l=s(33);i.setConfig({ErrorOverlay:t=>n.createElement("div",null)});const d={clear:r.App.pub_clear,importLink:l.importLink,importHTML:l.importHTML};let p;p=s(34);let c=!1;const h=p,u=h.default,m=h.AppProvider,_=h.appContext;d.set=(t,e,s)=>{r.App.pub_set(t,e,s),_.setData(t)},d.render=()=>{r.App.pub_initAudio(),o.render(n.createElement(m,null,n.createElement(u,null)),document.getElementById("wrap"))},d.init=(t,e,s,i,n,o)=>{r.App.pub_load(t,null,e,s,i,n,o)},d.start=()=>{c=!0,setTimeout(()=>_.start(),500)},d.receive=t=>{if(4===t.type){const e=t.data;c?e&&e.id&&""!==e.id&&(r.App.isStarted?a.sendPADToID(e.id,0,null):a.sendPADToID(e.id,1,null)):r.App.pub_addInitedStudent(e)&&(c||(c=!0,_.start()))}else _.receive(t)},d.teachingTool=t=>{},d.notifyNaviInfo=(t,e,s,i,n,o)=>{_.notifyNaviInfo(t,e,s,i,n,o)},d.notifyBookCaptureInfo=t=>{_.notifyBookCaptureInfo(t)},d.notifyUploadToServerResult=t=>{_.uploaded(t)},d.notifyUploadToServerMultiResult=t=>{_.multiUploaded(t)},d.notifyAlert=t=>{_.notifyAlert(t)},d.notifyPenToolState=(t,e)=>{_.notifyPenToolState(t,e)},d.notifyHamburgerMenuClicked=t=>{_.notifyHamburgerMenuClicked(t)},d.callThreeminState=()=>{_.callThreeminState()},s(73),t.app_o=d}).call(this,s(30))},function(t,e){var s;s=function(){return this}();try{s=s||new Function("return this")()}catch(t){"object"==typeof window&&(s=window)}t.exports=s},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n=(i=s(0))&&"object"==typeof i&&"default"in i?i.default:i;function o(t){return o.warnAboutHMRDisabled&&(o.warnAboutHMRDisabled=!0,console.error("React-Hot-Loader: misconfiguration detected, using production version in non-production environment."),console.error("React-Hot-Loader: Hot Module Replacement is not enabled.")),n.Children.only(t.children)}o.warnAboutHMRDisabled=!1;var r=function t(){return t.shouldWrapWithAppContainer?function(t){return function(e){return n.createElement(o,null,n.createElement(t,e))}}:function(t){return t}};r.shouldWrapWithAppContainer=!1;e.AppContainer=o,e.hot=r,e.areComponentsEqual=function(t,e){return t===e},e.setConfig=function(){},e.cold=function(t){return t},e.configureComponent=function(){}},function(t,e){t.exports=ReactDOM},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.importLink=e.importHTML=void 0,e.importHTML=function(t){return new Promise((e,s)=>{const i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="document",i.onload=t=>{if(!t)return;const n=i.response;n&&n.body&&n.body.firstElementChild?e(n.body.firstElementChild):n&&n.documentElement?e(n.documentElement):s("error")},i.onerror=t=>{s(t)},i.send(null)})},e.importLink=function(t,e){return new Promise((e,s)=>{const i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="document",i.onload=t=>{if(!t)return;const s=i.response;e(s)},i.onerror=t=>{s(t)},i.send(null)})}},function(t,e,s){"use strict";(function(t){var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.appContext=e.AppProvider=void 0;const n=s(0),o=s(1),r=s(18),a=s(36),l=s(37);s(38),s(39);const d=s(40);Object.defineProperty(e,"AppProvider",{enumerable:!0,get:function(){return d.TeacherProvider}}),Object.defineProperty(e,"appContext",{enumerable:!0,get:function(){return d.tContext}});const p=s(43);let c=class extends n.Component{render(){const{state:t,actions:e}=this.props,s=t.viewDiv;return n.createElement(n.Fragment,null,n.createElement("div",{className:"content-container"},n.createElement("div",{className:"content-wrapper",style:{left:("direction"===s?0:-1280)+"px"}},n.createElement(a.default,{className:"video-direction",view:"direction"===s,on:t.directionON,isTeacher:!0,lesson:e.getCurriculum(),bookId:t.bookid,subtitle:"",poster_url:"/content/mathalive_lib/MA/module_portfolio/common/bg_direction.jpg",video_url:"/content/mathalive_lib/MA/module_portfolio/common/mv_module_portfolio.mp4",video_frame:125,onEndStart:e.onDirectionEndStart,onEnd:e.onDirectionEnded,audio_url:"/content/mathalive_lib/mp3/11_Module_Portfolio.mp3"}),n.createElement("div",null,n.createElement(p.default,{view:"content"===s,state:t,actions:e})))),n.createElement(l.Navi,Object.assign({},t.navi,{onLeftClick:e.naviLeft,onRightClick:e.naviRight})))}};c=i([o.observer],c);const h=d.useTeacher(t=>n.createElement(o.Observer,null,()=>n.createElement(c,{state:t.state,actions:t.actions})));e.default=r.hot(t)(h)}).call(this,s(35)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r},n=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const o=s(0),r=s(2),a=s(1),l=s(7);let d=class extends o.Component{constructor(t){super(t),this.m_on=!1,this.m_showMathKit=!1,this.bookInfo=[],this.curIndex=0,this._list=[],this._onClick=()=>{this.props.isTeacher&&this._off()},this._off=()=>n(this,void 0,void 0,(function*(){this.props.view&&this.m_on&&(this.m_on=!1,this.props.onEndStart&&this.props.onEndStart(),yield l.wait(500),this.props.view&&!this.m_on&&this.props.onEnd&&this.props.onEnd())})),this.m_on=t.view&&t.on}_on(){return n(this,void 0,void 0,(function*(){this.m_on=!0}))}componentWillReceiveProps(t){if(t.lesson&&this.props.lesson!==t.lesson||this.props.view!==t.view){for(;this.bookInfo.length>0;)this.bookInfo.pop();t.lesson&&t.lesson.childrenList&&t.lesson.childrenList.length>0&&t.lesson.childrenList.map((e,s)=>{try{if(e.book){e.book.id===t.bookId&&(this.curIndex=this.bookInfo.length);let s=e.depth_name?e.depth_name:"";s=s.replace(/\&lt;/g,"<"),s=s.replace(/\&gt;/g,">"),this.bookInfo.push({bookName:e.name?e.name:"",id:e.id,lesson:t.lesson?t.lesson.name:"",subtitle:s})}}catch(t){alert("A ee  "+JSON.stringify(t))}})}}componentDidUpdate(t){this.props.view?t.view?this.props.on&&!t.on?this._on():!this.props.on&&t.on&&this._off():this.props.on?this._on():this.m_on=!1:this.m_on=!1}render(){const{isTeacher:t,subtitle:e}=this.props,s=[];s.push(this.props.className);const i=document.querySelector(".bgm");return this.props.view?(this.m_on&&s.push("on"),i&&i.play()):(s.push("hide"),i&&(i.pause(),i.currentTime=0)),o.createElement("div",{className:s.join(" "),onClick:this._onClick},t&&this.bookInfo&&o.createElement("span",{className:"concept_name"},this.bookInfo.length>0?this.bookInfo[this.curIndex].lesson:""),o.createElement("div",{className:"progress_dot"},t&&this.bookInfo&&this.bookInfo.map((t,e)=>o.createElement("span",{key:"q_"+e,className:this.curIndex===e?"on":""}))),o.createElement("div",{className:"video"},o.createElement("video",{muted:!0,autoPlay:!0,poster:this.props.poster_url?this.props.poster_url:void 0},o.createElement("source",{src:this.props.video_url,type:"video/mp4"}),o.createElement("strong",null,"Your browser does not support the video tag."))),o.createElement("div",{className:"text"},o.createElement("div",{className:"t1"},this.bookInfo&&this.bookInfo.length>0?this.bookInfo[this.curIndex].bookName:""),t&&o.createElement("div",{className:"t2",dangerouslySetInnerHTML:{__html:this.bookInfo&&this.bookInfo.length>0?this.bookInfo[this.curIndex].subtitle:""}}),!t&&o.createElement("div",{className:"t2",dangerouslySetInnerHTML:{__html:0===e.length&&this.bookInfo[this.curIndex]?this.bookInfo[this.curIndex].subtitle:e}})),o.createElement("audio",{className:"bgm",autoPlay:!0,src:this.props.audio_url?this.props.audio_url:void 0}))}};i([r.observable],d.prototype,"m_on",void 0),i([r.observable],d.prototype,"_list",void 0),i([r.action],d.prototype,"_off",void 0),d=i([a.observer],d),e.default=d},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.Navi=void 0;const n=s(0),o=s(2),r=s(1),a=s(15);let l=class extends n.Component{constructor(t){super(t),this.m_on=!1,this.m_isStarted=!1,this._onClick=t=>{this.m_on=!0}}componentDidUpdate(t){this.m_isStarted||!this.props.view||t.view||(this.m_isStarted=!0,this.m_on=!0)}render(){const t=this.m_on?void 0:"off",e={visibility:this.props.view?"visible":"hidden"};return n.createElement(n.Fragment,null,n.createElement("div",{id:"common_navi_left",className:t,style:e},n.createElement("div",null,n.createElement("div",{onClick:this._onClick},n.createElement(a.ToggleBtn,{className:"right",disabled:!this.props.enableRight,onClick:this.props.onRightClick}),n.createElement(a.ToggleBtn,{className:"left",disabled:!this.props.enableLeft,onClick:this.props.onLeftClick})))),n.createElement("div",{id:"common_navi_right",className:t,style:e},n.createElement("div",null,n.createElement("div",{onClick:this._onClick},n.createElement(a.ToggleBtn,{className:"right",disabled:!this.props.enableRight,onClick:this.props.onRightClick}),n.createElement(a.ToggleBtn,{className:"left",disabled:!this.props.enableLeft,onClick:this.props.onLeftClick})))))}};i([o.observable],l.prototype,"m_on",void 0),l=i([r.observer],l),e.Navi=l},function(t,e,s){"use strict";s.r(e)},function(t,e,s){"use strict";s.r(e)},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.SENDPROG=e.useTeacher=e.tContext=e.TeacherConsumer=e.TeacherProvider=e.TeacherContext=void 0;const n=s(0),o=s(2),r=s(4),a=s(41);var l;!function(t){t[t.READY=0]="READY",t[t.SENDING=1]="SENDING",t[t.SENDED=2]="SENDED",t[t.STOPED=3]="STOPED",t[t.COMPLETE=4]="COMPLETE"}(l||(l={})),e.SENDPROG=l;class d extends a.TeacherContextBase{constructor(){super(),this._mathJournalResultFnc=null,this._rolePlayingResultFnc=null,this._conceptBoardResultFnc=null,this._lyricsLabResultFnc=null,this._letMeExplainResultFnc=null,this._livepointResultFnc=null,this._setAlertResponse=null,this._checkLivePoint=null,this.navi=this.state.navi={view:!1,enableLeft:!0,enableRight:!0},this.state.prog="content_select",this.state.recordProg="",this.state.selBeat="",this.actions.getData=()=>this._data,this.actions.getCurriculum=()=>this._curriculum,this.actions.gotoDirection=()=>this._setViewDiv("direction"),this.actions.gotoNextBook=()=>{r.sendLauncher(9,null)},this.actions.setMathJournalResultFnc=t=>{this._mathJournalResultFnc=t},this.actions.setRolePlayingResultFnc=t=>{this._rolePlayingResultFnc=t},this.actions.setConceptBoardResultFnc=t=>{this._conceptBoardResultFnc=t},this.actions.setLyricsLabResultFnc=t=>{this._lyricsLabResultFnc=t},this.actions.setLetMeExplainResultFnc=t=>{this._letMeExplainResultFnc=t},this.actions.setLivepointResultFnc=t=>{this._livepointResultFnc=t},this.actions.setAlertResponse=t=>{this._setAlertResponse=t},this.actions.checkLivePoint=t=>{this._checkLivePoint=t}}_setViewDiv(t){super._setViewDiv(t)}receive(t){super.receive(t);const e=t.data;let s="",i="";if("math_journal_end"===e.msgtype){const t=e;this._mathJournalResultFnc&&this._mathJournalResultFnc(t)}else if("role_playing_end"===e.msgtype){const t=e;this._rolePlayingResultFnc&&this._rolePlayingResultFnc(t)}else if("concept_board_end"===e.msgtype){const t=e;this._conceptBoardResultFnc&&this._conceptBoardResultFnc(t)}else if("lyrics_lab_end"===e.msgtype){const t=e;this._lyricsLabResultFnc&&this._lyricsLabResultFnc(t)}else if("let_me_explain_end"===e.msgtype){const t=e;this._letMeExplainResultFnc&&this._letMeExplainResultFnc(t)}else if("livepoint_send"===e.msgtype){const t=e;this._livepointResultFnc&&this._livepointResultFnc(t)}else if("math_journal_recording_end"===e.msgtype){const t=e;if(console.log("math_journal_recording_end ---\x3e lms save",t),this._mathJournalResultFnc&&this._mathJournalResultFnc(t),"math_journal"===this.state.recordProg)s="MP0101";else if("role_playing"===this.state.recordProg)s="MP0102";else if("concept_board"===this.state.recordProg)s="MP0103";else if("lyrics_lab"===this.state.recordProg)switch(s="MP0104",t.beat&&(this.state.selBeat=t.beat.substr(-6)),this.state.selBeat){case"01.mp3":i="MP010401";break;case"02.mp3":i="MP010402";break;case"03.mp3":i="MP010403";break;case"04.mp3":i="MP010404";break;case"05.mp3":i="MP010405";break;case"06.mp3":i="MP010406"}else("let_me_explain_a"===this.state.recordProg||"let_me_explain_b"===this.state.recordProg||"let_me_explain_c"===this.state.recordProg)&&(s="MP0105");let n,o=[],a=new Date,l=["",""];if(t.saveImageUrl)l[0]=t.saveImageUrl;else if(""===t.saveImageUrl||!t.saveImageUrl)switch(s){case"MP0101":l[0]="content/mathalive_lib/MA/module_portfolio/common/bg_s_math_journal.png";break;case"MP0102":l[0]="content/mathalive_lib/MA/module_portfolio/common/bg_s_role_playing.png";break;case"MP0103":l[0]="content/mathalive_lib/MA/module_portfolio/common/bg_s_concept_board.png";break;case"MP0104":l[0]="content/mathalive_lib/MA/module_portfolio/common/bg_s_lyrics_lab.png";break;case"MP0105":l[0]="content/mathalive_lib/MA/module_portfolio/common/temp_letme_explain_problem.png"}l[1]=t.imageUrl,n=`${a.getFullYear()}-${a.getMonth()+1}-${a.getDate()} ${a.getHours()}:${a.getMinutes()}:${a.getSeconds()}`,o.push({std_cont_seq:0,studentId:t.id,ans_tf:"1",ans_submit:"",objKindDetailCd:i,ans_starttime:n,ans_endtime:n,sc_div1:"",sc_div2:"",sc_div3:"",sc_div4:"",files:l,ans_correct:"",tab_index:"1",obj_kind:s}),console.log("userReports",o),o.length>0&&r.uploadInclassReport(o)}}setData(t){this._data=t}notifyAlert(t){t&&this._setAlertResponse&&this._setAlertResponse()}notifyNaviInfo(t,e,s,i,n,o){this._curriculum=t,this.state.bookid=e,this.state.classid=s,this.state.navi.view=!0}notifyHamburgerMenuClicked(t){t&&this._checkLivePoint&&this._checkLivePoint()}}i([o.observable],d.prototype,"state",void 0),i([o.action],d.prototype,"_setViewDiv",null),e.TeacherContext=d;const p=new d;e.tContext=p;const{Provider:c,Consumer:h}=n.createContext(p);e.TeacherConsumer=h;class u extends n.Component{render(){return n.createElement(c,{value:p},this.props.children)}}e.TeacherProvider=u,e.useTeacher=function(t){return function(e){return n.createElement(h,null,e=>n.createElement(t,Object.assign({},e)))}}},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.TeacherContextBase=void 0;const n=s(2),o=s(3),r=s(4),a=s(42);class l{constructor(){this._naviLeftFnc=null,this._naviRightFnc=null,this.state={viewDiv:"direction",directionON:!1,navi:{view:!1,enableLeft:!1,enableRight:!1},svg_bg:{view:!0,bPlay:!1,viewCharactor:!0},loading:!1,retCnt:0,numOfStudent:0,bookid:0,bookkey:0,curriculumid:0,classid:0,unitid:0,lessonid:0,conceptLibiary:{view:!1,datatype:"grade",resultmode:!1}},this.actions={onDirectionEndStart:()=>{"direction"===this.state.viewDiv&&r.sendPAD(3,null)},onDirectionEnded:()=>{"direction"===this.state.viewDiv&&this._setViewDiv("content"),o.App.isStarted=!0},setNaviView:t=>{this.state.navi.view=t},setNavi:(t,e)=>{this.state.navi.enableLeft=t,this.state.navi.enableRight=e},setNaviFnc:(t,e)=>{this._naviLeftFnc=t,this._naviRightFnc=e},naviLeft:()=>{"direction"===this.state.viewDiv?r.sendLauncher(8,null):(o.App.pub_playBtnPage(),this._naviLeftFnc?this._naviLeftFnc():this._setViewDiv("direction"))},naviRight:()=>{"direction"===this.state.viewDiv?(o.App.pub_playBtnPage(),this.state.directionON=!1):(o.App.pub_playBtnPage(),this._naviRightFnc?this._naviRightFnc():r.sendLauncher(9,null))},setRetCnt:t=>{t>this.state.numOfStudent&&(t=this.state.numOfStudent),this.state.retCnt=t},setNumOfStudent:t=>{this.state.numOfStudent=t},setConcepLibaryView:t=>{this.state.conceptLibiary.view=t},setConcepLibaryDataType:t=>{this.state.conceptLibiary.datatype=t},setConcepLibaryResultMode:t=>{this.state.conceptLibiary.resultmode=t},setLoading:t=>{r.showTLoading(t)}},this.notifyBookCaptureInfo=t=>{},this.clickSendButton=()=>{},this.notifyRecordData=(t,e)=>{}}_setViewDiv(t,e){this.state.viewDiv!==t&&(e||o.App.pub_stop(),"direction"===t?(this.state.directionON=!0,this.state.svg_bg.bPlay=!0,this.state.svg_bg.viewCharactor=!0,r.sendLauncher(5,null),r.sendPAD(1,null),this.state.navi.view=!0,this.state.navi.enableLeft=o.App.prevBook,this.state.navi.enableRight=!0,this._naviLeftFnc=null,this._naviRightFnc=null,this.state.conceptLibiary.view=!1,this.state.conceptLibiary.datatype="grade",this.state.conceptLibiary.resultmode=!1):(this.state.directionON=!1,this.state.svg_bg.bPlay=!1,this.state.svg_bg.viewCharactor=!1,r.sendLauncher(6,null),r.sendPAD(0,null)),this._naviLeftFnc=null,this._naviRightFnc=null,this.state.numOfStudent=0,this.state.retCnt=0,this.state.viewDiv=t)}start(){if("direction"===this.state.viewDiv&&(this.state.directionON=!0,this.state.navi.view=!0,this.state.navi.enableLeft=o.App.prevBook,this.state.navi.enableRight=!0,this.state.svg_bg.bPlay=!0,r.sendLauncher(5,null),r.sendPAD(1,null)),o.App.isDvlp){0;let t="";if(t="M0410",""===t)return;let e={id:1e3,code:"",depth:4,depth_name:a.parseDept4Div(t),info:"",div:t,subDiv:"",name:"M0408"===t?"Identify the Number 0, Read and Write 0":"",thumbnail:"",cmsLevel:"",childrenList:[]},s="",i="",n="";if("Concept"===a.parseDept4Div(t))for(let t=0;t<3;t++){0===t?(s="M0503",i="M050303",n=a.parseDept5SubDiv("M050303")):1===t?(s="M0503",i="M050304",n=a.parseDept5SubDiv("M050304")):2===t&&(s="M0506",i="M050601",n=a.parseDept5SubDiv("M050601"));let o={id:16815+t,code:"",depth:5,depth_name:n,info:"",div:s,subDiv:i,name:n,thumbnail:"",cmsLevel:"",childrenList:[],book:{id:9e4+t,path:"/content/"+(5787+t),viewMode:2,key:5280+t,cmsKey:5787+t,completed:0,updatetime:""}};e.childrenList.push(o)}else if("Problem"===a.parseDept4Div(t))for(let t=0;t<3;t++){0===t?(s="M0505",i="M050504",n="Reasoning (1)"):1===t?(s="M0505",i="M050504",n=a.parseDept5SubDiv("M050504")):2===t&&(s="M0506",i="M050602",n=a.parseDept5SubDiv("M050602"));let o={id:16815+t,code:"",depth:5,depth_name:n,info:"",div:s,subDiv:i,name:n,thumbnail:"",cmsLevel:"",childrenList:[],book:{id:8e4+t,path:"/content/"+(5787+t),viewMode:2,key:5280+t,cmsKey:5787+t,completed:0,updatetime:""}};e.childrenList.push(o)}else if("Concept Learning"===a.parseDept4Div(t))for(let t=0;t<12;t++){0===t?(s="M0501",i="M050101",n="WarmUp Quiz"):1===t?(s="M0501",i="M050101",n="I SPY"):2===t?(s="M0501",i="M050101",n="Hit a Mole"):3===t?(s="M0506",i="M050601",n="Memory Game"):4===t?(s="M0506",i="M050601",n="Math Talk"):5===t?(s="M0501",i="M050102",n="Learning Objectives"):6===t?(s="M0502",i="M050202",n="Concept Acivity"):7===t?(s="M0502",i="M050203",n="Concept Tool"):8===t?(s="M0502",i="M050204",n="Concept Summary"):9===t?(s="M0505",i="M050501",n="Independent Practice"):10===t?(s="M0505",i="M050502",n="Extended Practice"):11===t&&(s="M0505",i="M050505",n="CL Strategy");let o={id:16815+t,code:"",depth:5,depth_name:n,info:"",div:s,subDiv:i,name:n,thumbnail:"",cmsLevel:"",childrenList:[],book:{id:1e4+t,path:"/content/"+(5787+t),viewMode:2,key:5280+t,cmsKey:5787+t,completed:0,updatetime:""}};e.childrenList.push(o)}else if("Topic Learning"===a.parseDept4Div(t))for(let t=0;t<1;t++){0===t&&(s="M0507",i="M050701",n=a.parseDept5SubDiv("M050701"));let o={id:16815+t,code:"",depth:5,depth_name:n,info:"",div:s,subDiv:i,name:n,thumbnail:"",cmsLevel:"",childrenList:[],book:{id:2e4+t,path:"/content/"+(5787+t),viewMode:2,key:5280+t,cmsKey:5787+t,completed:0,updatetime:""}};e.childrenList.push(o)}else if("Module Learning"===a.parseDept4Div(t))for(let t=0;t<3;t++){0===t?(s="M0508",i="M050801",n=a.parseDept5SubDiv("M050801")):1===t?(s="M0508",i="M050803",n=a.parseDept5SubDiv("M050803")):2===t&&(s="M0508",i="M050804",n=a.parseDept5SubDiv("M050804"));let o={id:16815+t,code:"",depth:5,depth_name:n,info:"",div:s,subDiv:i,name:n,thumbnail:"",cmsLevel:"",childrenList:[],book:{id:3e4+t,path:"/content/"+(5787+t),viewMode:2,key:5280+t,cmsKey:5787+t,completed:0,updatetime:""}};e.childrenList.push(o)}else if("Module Test"===a.parseDept4Div(t))for(let t=0;t<1;t++){0===t&&(s="M0509",i="M050905",n=a.parseDept5SubDiv("M050905"));let o={id:16815+t,code:"",depth:5,depth_name:n,info:"",div:s,subDiv:i,name:n,thumbnail:"",cmsLevel:"",childrenList:[],book:{id:4e4+t,path:"/content/"+(5787+t),viewMode:2,key:5280+t,cmsKey:5787+t,completed:0,updatetime:""}};e.childrenList.push(o)}let o=1e4;o=30001,this.notifyNaviInfo(e,o,1)}else{let t="";0,r.getNaviInfo(t)}}receive(t){}uploaded(t){}multiUploaded(t){}notify(t){}notifyRecorded(t){}notifyVideoRecord(t){}notifyNaviInfo(t,e,s,i,n,o){}notifyPenToolState(t,e){}notifyLiveGivePopupClose(){}notifyAlert(t){}notifyHamburgerMenuClicked(t){}callThreeminState(){}}i([n.observable],l.prototype,"state",void 0),i([n.action],l.prototype,"_setViewDiv",null),i([n.action],l.prototype,"start",null),e.TeacherContextBase=l},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parseClassColor=e.parseDept5SubDiv=e.parseDept5Div=e.parseDept4Div=e.parseDept3Div=void 0,e.parseDept3Div=function(t){return"M0301"===t?"Number&Operations":"M0302"===t?"Measurement&Date":"M0303"===t?"Operations&Algebra":"M0304"===t?"Geometry":"M0305"===t?"Topic":"M0306"===t?"Module Review":""},e.parseDept4Div=function(t){return"M0401"===t?"Concept":"M0402"===t?"Problem":"M0403"===t?"Strategy":"M0404"===t?"Number&Operations":"M0405"===t?"Measurement&Date":"M0406"===t?"Operations&Algebra":"M0407"===t?"Geometry":"M0408"===t?"Concept Learning":"M0409"===t?"Topic Learning":"M0410"===t?"Module Learning":"M0411"===t?"Module Test":""},e.parseDept5Div=function(t){return"M0501"===t?"Warm-Up":"M0502"===t?"Concept Learning":"M0503"===t?"Concept Learning 2":"M0504"===t?"Concept Learning 3":"M0505"===t?"Problem Solving":"M0506"===t?"Wrap-Up":"M0507"===t?"Topic Learning":"M0508"===t?"Module Learning":"M0509"===t?"Module Test":""},e.parseDept5SubDiv=function(t){return"M050101"===t?"Warm-Up Activity":"M050102"===t?"Learning Objectives":"M050103"===t?"Concept Summary":"M050201"===t?"Concept Learning":"M050202"===t?"Concept Activity":"M050203"===t?"Concept Tool":"M050204"===t?"Concept Summary":"M050301"===t?"Activity":"M050302"===t?"Concept Tool":"M050303"===t?"Summary":"M050304"===t?"Check":"M050401"===t?"Activity":"M050402"===t?"Concept Tool":"M050403"===t?"Summary":"M050404"===t?"Check":"M050501"===t?"Independent Practice":"M050502"===t?"Extended Practice":"M050503"===t?"Strategy":"M050504"===t?"Reasoning (2)":"M050505"===t?"Strategy":"M050601"===t?"Wrap-Up Activity":"M050602"===t?"Portfolio":"M050701"===t?"Topic Strategy":"M050702"===t?"Adaptive Learning":"M050801"===t?"Module Review":"M050802"===t?"Adaptive Learning":"M050803"===t?"Module Portfolio":"M050804"===t?"Module Strategy":"M050901"===t?"Assessment":"M050902"===t?"Module Portfolio":"M050903"===t?"Assessment Review":"M050904"===t?"STEAM Activity":"M050905"===t?"STEAM Portfolio":""},e.parseClassColor=function(t){return"B62001"===t?"Black":"White"}},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0});const n=s(0),o=s(1),r=s(4),a=s(44),l=s(45),d=s(68),p=s(69),c=s(70),h=s(71),u=s(72);let m=class extends n.Component{constructor(t){super(t);t.actions.getData()}_setNavi(){this.props.actions.setNaviView(!0),this.props.actions.setNavi(!0,!0),this.props.actions.setNaviFnc(()=>{this.props.state.prog="",r.clearTPenTool(),this.props.actions.gotoDirection()},()=>{r.clearTPenTool(),this.props.actions.gotoNextBook()})}componentDidUpdate(t){this.props.view&&!t.view?this.props.state.prog="content_select":!this.props.view&&t.view}render(){const{view:t,state:e,actions:s}=this.props;s.getData();return n.createElement("div",{className:"t_module_portfolio"},n.createElement(a.default,{view:t&&"content_select"===e.prog,state:e,actions:s}),n.createElement(l.default,{view:t&&"math_journal"===e.prog,state:e,actions:s}),n.createElement(d.default,{view:t&&"math_journal_recording"===e.prog,state:e,actions:s}),n.createElement(p.default,{view:t&&"role_playing"===e.prog,state:e,actions:s}),n.createElement(c.default,{view:t&&"concept_board"===e.prog,state:e,actions:s}),n.createElement(h.default,{view:t&&"lyrics_lab"===e.prog,state:e,actions:s}),n.createElement(u.default,{view:t&&"let_me_explain_a"===e.prog,state:e,actions:s}))}};m=i([o.observer],m),e.default=m},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.TContentSelect=void 0;const n=s(0),o=s(1),r=s(2),a=s(4),l=s(3),d=s(16);let p=class extends n.Component{constructor(t){super(t),this._viewCheckAlert=!1,this.selectContent=t=>{l.App.pub_playBtnTab(),1===t?this.props.state.prog="math_journal":2===t?this.props.state.prog="role_playing":3===t?this.props.state.prog="concept_board":4===t?this._viewCheckAlert=!0:5===t&&(this.props.state.prog="let_me_explain_a")},this._onCheckAlertOk=()=>{this._viewCheckAlert=!1,this.props.state.prog="lyrics_lab"},this._onCheckAlertClosed=()=>{this._viewCheckAlert=!1}}_setNavi(){this.props.view&&"content_select"===this.props.state.prog&&(this.props.actions.setNaviView(!0),this.props.actions.setNavi(!0,!0),this.props.actions.setNaviFnc(()=>{this.props.state.prog="",a.clearTPenTool(),this.props.actions.gotoDirection()},()=>{a.clearTPenTool(),this.props.actions.gotoNextBook()}))}componentDidUpdate(t){this.props.view&&!t.view&&this._setNavi()}render(){const{view:t}=this.props;return n.createElement("div",{className:"t_content_select",style:{display:t?"":"none"}},n.createElement("div",{className:"topHeader"}),n.createElement("div",{className:"portfolioContent"},n.createElement("div",{className:"page_list"},n.createElement("ul",null,n.createElement("li",null,n.createElement("div",{className:"image",onClick:this.selectContent.bind(this,1)},n.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/thumb_math_journal.png"})),n.createElement("div",{className:"title",onClick:this.selectContent.bind(this,1)},"Math Journal")),n.createElement("li",null,n.createElement("div",{className:"image",onClick:this.selectContent.bind(this,2)},n.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/thumb_role_playing.png"})),n.createElement("div",{className:"title",onClick:this.selectContent.bind(this,2)},"Role Play")),n.createElement("li",null,n.createElement("div",{className:"image",onClick:this.selectContent.bind(this,3)},n.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/thumb_concept_board.png"})),n.createElement("div",{className:"title",onClick:this.selectContent.bind(this,3)},"Concept Board")),n.createElement("li",null,n.createElement("div",{className:"image",onClick:this.selectContent.bind(this,4)},n.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/thumb_lyrics_lab.png"})),n.createElement("div",{className:"title",onClick:this.selectContent.bind(this,4)},"Lyrics Lab")),n.createElement("li",null,n.createElement("div",{className:"image",onClick:this.selectContent.bind(this,5)},n.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/thumb_letme_explain.png"})),n.createElement("div",{className:"title",onClick:this.selectContent.bind(this,5)},"Let Me Explain"))))),n.createElement("div",{className:"dim",style:{display:this._viewCheckAlert?"block":"none"}}),n.createElement(d.CoverPopup,{className:"alert_popup",view:this._viewCheckAlert,onClosed:this._onCheckAlertClosed},n.createElement("div",{className:"pop_box"},n.createElement("span",{className:"ico_alert"}),n.createElement("span",{className:"text"},"For this activity, ",n.createElement("br",null),"We recommend students to wear",n.createElement("br",null),"a headset or an earphone ",n.createElement("br",null),"with a microphone."),n.createElement("div",{className:"btns"},n.createElement("button",{className:"btn_cancel",onClick:this._onCheckAlertClosed},n.createElement("span",null,"Cancel")),n.createElement("button",{className:"btn_ok",onClick:this._onCheckAlertOk},n.createElement("span",null,"OK"))))))}};i([r.observable],p.prototype,"_viewCheckAlert",void 0),p=i([o.observer],p),e.TContentSelect=p,e.default=p},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r},n=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TMathJournal=void 0;const o=s(0),r=s(1),a=s(2),l=s(6),d=s(4),p=s(7),c=s(3),h=s(14),u=s(8),m=s(9),_=s(10),v=s(11),b=s(12),y=s(13);let f=class extends o.Component{constructor(t){super(t),this._viewSample=!1,this._prog=0,this._viewAlert=!1,this._submitStudents=[],this._submitStudentCnt=0,this._isComplete=!1,this.isReset=!1,this._isPlayed=!1,this.viewList=!1,this._alerttype="",this._isLivePoint=!1,this._isViewSendLive=!0,this.finishBtn=!1,this._totalUsers=0,this.sendType="navileft",this.msg="Do you want to send\nGreen lives?",this.onViewSample=()=>{c.App.pub_playBtnTab(),this._viewSample=!0},this.onCloseSample=()=>{c.App.pub_playBtnTab(),this._viewSample=!1},this._offAlert=()=>{this._viewAlert=!1},this._openRetryPopup=()=>{this._viewAlert=!0,this._alerttype="retry"},this._openForcePopup=()=>{this._prog<=1||(this._viewAlert=!0,this._alerttype="force")},this._onSend=()=>{if(!this.props.view)return;this._prog=1,this.finishBtn=!0,c.App.pub_playToPad();d.sendPAD(10,{msgtype:"math_journal_send"}),this.props.actions.setMathJournalResultFnc(this._onMathJournalResultFnc),this.props.actions.setAlertResponse(this._onSendLivePoint),this.props.actions.checkLivePoint(this._onMenuButtonClick),c.App.pub_reloadStudents(()=>n(this,void 0,void 0,(function*(){if(!this.props.view)return;if(1!==this._prog)return;yield p.wait(600),this._prog=2,this._setNavi(),this.viewList=!0,this.isReset=!1;const t={msgtype:"send_students",students:JSON.stringify(c.App.students)};if(this._totalUsers=c.App.students?c.App.students.length:0,d.sendPAD(10,t),2===this._prog)for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<this._totalUsers;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,videos:[""],audios:[""],beat:[],record:"",recordType:"",order:-1,nosubmit:!0},i=this._submitStudents[t].findIndex(t=>t.student.id===s.student.id);i<=-1?this._submitStudents[t].push(s):this._submitStudents[t][i].student=s.student}})))},this._onMathJournalResultFnc=t=>{if(console.log("qmsg",t),!this.props.view)return;if(this._submitStudentCnt===c.App.students.length)return;if(t.tryCnt<2)this._submitStudentCnt++;else if(t.tryCnt>=2)return;const e=l.find(c.App.students,{id:t.id});if(!e)return;const s=this._submitStudents[0].findIndex(e=>e.student.id===t.id);if(s>-1)this._submitStudents[0][s].trycnt=t.tryCnt,this._submitStudents[0][s].nosubmit=!1,this._submitStudents[0][s].images===[]?this._submitStudents[0][s].images.push(t.imageUrl):this._submitStudents[0][s].images[0]=t.imageUrl;else{let s={student:e,correct:!1,trycnt:1,livePoint:0,videos:[""],audios:[""],beat:[],record:"",recordType:"",images:[t.imageUrl],nosubmit:!1};this._submitStudents[0].push(s)}this._submitStudentCnt===c.App.students.length&&(this._isComplete=!0,this.finishBtn=!1,this._prog=4,this.props.actions.setNavi(!0,!0))},this._onSendStop=()=>n(this,void 0,void 0,(function*(){if(!this.props.view)return;if(2!==this._prog)return;if(this._prog>=3)return;c.App.pub_playToPad();d.sendPAD(10,{msgtype:"send_stop"}),this._prog=3,this.finishBtn=this._viewAlert=!1,this.props.actions.setNavi(!0,!0),this._submitStudentCnt>0?this._isComplete=!0:this._isComplete=!1,this._alerttype="retry"})),this._onSendRetry=()=>{for(let t=0;t<c.App.students.length;t++){let e={student:c.App.students[t],correct:!1,trycnt:0,images:[],livePoint:0,videos:[""],audios:[""],beat:[],record:"",recordType:"",order:-1,nosubmit:!0};this._submitStudents[0][t]=e}this._prog=0,this._viewAlert=!1,this._submitStudentCnt=0,this._isComplete=!1,this.isReset=!0;d.sendPAD(10,{msgtype:"retry"})},this._onSendPresenter=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t),i={msgtype:"presenter_send",step:1,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i),this.props.actions.setLivepointResultFnc(this._onLivePointResult),this._isViewSendLive=!1})),this._onLivePointResult=t=>{const e=this._submitStudents[0].findIndex(e=>e.student.id===t.to);300!==this._submitStudents[0][e].livePoint&&(this._submitStudents[0][e].livePoint+=t.livePoint)},this._onSendLiveget=t=>n(this,void 0,void 0,(function*(){const e=this._submitStudents[0].findIndex(e=>e.student.id===t);let s=this._submitStudents[0][e].livePoint;const i={msgtype:"presenter_end",studentId:t,livePoint:s};d.sendPAD(10,i),this._isViewSendLive=!0})),this._onHidePresenter=()=>{d.sendPAD(10,{msgtype:"math_journal_send"})},this._checkisPlayed=()=>{this._isPlayed=!0},this.onNext=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t);d.sendPAD(10,{msgtype:"next_presenter"}),yield p.wait(600);const i={msgtype:"presenter_send",step:1,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i)})),this.onPrev=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t);d.sendPAD(10,{msgtype:"next_presenter"}),yield p.wait(600);const i={msgtype:"presenter_send",step:1,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i)})),this._callBackFnc=(t,e,s)=>{let i=l.find(this._submitStudents[0],e=>e.student.id===t);i&&(i.livePoint=0);let n={live:e};if(d.sendPADToID(t,21,n),"navileft"===this.sendType&&this._submitStudents[0].length-1===s){const t={msgtype:"content_select"};this.props.state.prog="content_select",this.props.state.recordProg="",this._prog=0,d.sendPAD(0,t)}if("naviright"===this.sendType&&this._submitStudents[0].length-1===s){this.props.state.prog="math_journal_recording",this.props.state.recordProg="math_journal";const t={msgtype:"math_journal_recording_ready"};d.sendPAD(10,t)}},this._onSendLivePoint=()=>{if(c.App.isDvlp&&(this._viewAlert=!1),this._submitStudents[0].length>0)for(let t=0;t<this._submitStudents[0].length;t++){let e={addOnHost:c.App.addOnHost,liveType:"green",plusMinusType:"plus",score:this._submitStudents[0][t].livePoint,userIdx:this._submitStudents[0][t].student.id,clsIdx:this.props.state.classid,depthItemIdx:this.props.state.curriculumid,callback:s=>{this._callBackFnc(e.userIdx,e.score,t)},error:t=>{console.log("Request Error ! Check the params")}};!c.App.isDvlp&&e.score>0&&y.setLivePoint(e),c.App.isDvlp&&this._callBackFnc(e.userIdx,e.score,t)}},this._onMenuButtonClick=()=>{this._isLivePoint&&(this.sendType="button",d.alertToTeacher({text:this.msg,from:"book"}))},this._onBtnHeaert=()=>{c.App.isDvlp?(this._alerttype="livepoint",this._viewAlert=!0,this.sendType="button"):(this.sendType="button",d.alertToTeacher({text:this.msg,from:"book"}))},this.keywords=this.props.actions.getData().keywords,this.dataGrade=this.props.actions.getData().grade;for(let t=0;t<5;t++)this._submitStudents.push([])}_checkLivePoint(){this._submitStudents[0].filter((t,e)=>t.livePoint>0).length>0?this._isLivePoint=!0:this._isLivePoint=!1}_setNavi(){this.props.view&&"math_journal"===this.props.state.prog&&(this.props.actions.setNaviView(!0),this.props.actions.setNavi(!0,!1),this.props.actions.setNaviFnc(()=>{if(this._isLivePoint)return this.sendType="navileft",this._alerttype="livepoint",void(c.App.isDvlp?this._viewAlert=!0:d.alertToTeacher({text:this.msg,from:"book"}));this.props.state.prog="content_select",this.props.state.recordProg="",this._prog=0,d.sendPAD(0,{msgtype:"content_select"})},()=>{if(this._isLivePoint)return this.sendType="naviright",this._alerttype="livepoint",void(c.App.isDvlp?this._viewAlert=!0:d.alertToTeacher({text:this.msg,from:"book"}));this.props.state.prog="math_journal_recording",this.props.state.recordProg="math_journal";d.sendPAD(10,{msgtype:"math_journal_recording_ready"})}))}componentDidUpdate(t){if(this.props.view&&!t.view){this._submitStudentCnt=0,this._viewSample=!1,this._prog=0,this._isComplete=!1,this.viewList=!1,this._isPlayed=!1,this.props.actions.setAlertResponse(null),this.props.actions.checkLivePoint(null),this._submitStudents[0]=[];for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<c.App.students.length;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],videos:[""],audios:[""],beat:[],record:"",livePoint:0,recordType:"",order:-1,nosubmit:!0};this._submitStudents[t].findIndex(t=>t.student.id===s.student.id)<=-1?this._submitStudents[t].push(s):this._submitStudents[t][e]=s}const t={msgtype:"send_students",students:JSON.stringify(c.App.students)};d.sendPAD(10,t),this._setNavi()}else!this.props.view&&t.view&&(this._submitStudentCnt=0,this._viewSample=!1,this.props.actions.setAlertResponse(null),this.props.actions.checkLivePoint(null),this._checkLivePoint());this.props.view&&this.viewList&&this._isComplete&&this._checkLivePoint(),2===this._prog||1===this._prog?this.props.state.navi.enableLeft=!1:this.props.state.navi.enableLeft=!0}render(){const{view:t,actions:e}=this.props;return o.createElement("div",{className:"t_math_journal",style:{display:t?"":"none"}},o.createElement("div",{className:"topHeader",style:{display:this._prog<=1?"":"none"}},o.createElement("div",{className:"type c"},"TYPE ",o.createElement("span",null,"A")),o.createElement("button",{className:"btn_help"}),o.createElement("button",{className:"btn_answer"},"Answer")),o.createElement("div",{className:"portfolioContent",style:{display:this._prog<=1?"":"none"}},o.createElement("div",{className:"content"},o.createElement("div",{className:"artboard"},o.createElement("div",{className:"inner"},o.createElement("h2",null,"Math Journal"),o.createElement("button",{className:"btn_sample",onClick:this.onViewSample},"Sample"),o.createElement("div",{className:"title"},o.createElement("span",{className:"num n01"}),"Learning Objectives"),o.createElement("div",{className:"textarea type01"}),o.createElement("div",{className:"title"},o.createElement("span",{className:"num n02"}),"What I Learned"),o.createElement("div",{className:"textarea type01"}),o.createElement("div",{className:"title"},o.createElement("span",{className:"num n03"}),"My Ideas"),o.createElement("div",{className:"textarea type01"}),o.createElement("div",{className:"title"},o.createElement("span",{className:"num n04"}),"Reflections"),o.createElement("div",{className:"textarea type01"}))),o.createElement(h.default,{view:t,keywords:this.keywords}))),o.createElement("div",{className:"pop"+(this._viewSample?" show":"")},o.createElement("div",{className:"stage"},o.createElement("div",{className:"header"},"Math Journal",o.createElement("div",{className:"user"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/temp_user_01.png"}),o.createElement("span",{className:"name"},"Jinny")),o.createElement("button",{className:"btn_close",onClick:this.onCloseSample})),o.createElement("div",{className:"content"},o.createElement("div",{className:"scroll"},2===this.dataGrade?o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/sample/type01_upper.png"}):o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/sample/type01_lower.png"}))))),o.createElement(v.AlertPopup,{view:this._viewAlert,onClose:this._offAlert,onOk:"force"===this._alerttype?this._onSendStop:"livepoint"===this._alerttype?this._onSendLivePoint:this._onSendRetry,msg:"force"===this._alerttype?"Force Quit?":"livepoint"===this._alerttype?"Do you want to send <br> Green lives?":"Retry?"}),o.createElement(u.default,{view:0===this._prog,type:"teacher",sended:!1,originY:0,onSend:this._onSend}),o.createElement(_.BtnProgress,{view:this.finishBtn&&0!==this._prog,isEnd:this._isComplete,totalStudents:c.App.students?c.App.students.length:0,submitStudents:this._submitStudentCnt,onClick:this._isComplete?this._openRetryPopup:this._openForcePopup}),this.viewList&&this._prog>=2&&this._isViewSendLive&&!this.finishBtn?o.createElement(b.BtnSendLive,{view:!0,disabled:!this._isLivePoint,on:this._isLivePoint,onClick:this._onBtnHeaert}):void 0,o.createElement(m.SendnShare,{view:this._prog>=2&&this.viewList,type:"image",submitStudent:l.cloneDeep(this._submitStudents),isComplete:this._prog>=3&&this._isComplete,isReset:this.isReset,onSendPresenter:this._onSendPresenter,onSendLiveget:this._onSendLiveget,onHidePresenter:this._onHidePresenter,quizIdx:0,checkIsPlayed:this._checkisPlayed,isPlayed:this._isPlayed,onNext:this.onNext,onPrev:this.onPrev,contentType:"type01",clsIdx:this.props.state.classid,curriculumid:this.props.state.curriculumid}))}};i([a.observable],f.prototype,"_viewSample",void 0),i([a.observable],f.prototype,"_prog",void 0),i([a.observable],f.prototype,"_viewAlert",void 0),i([a.observable],f.prototype,"_submitStudents",void 0),i([a.observable],f.prototype,"_submitStudentCnt",void 0),i([a.observable],f.prototype,"_isComplete",void 0),i([a.observable],f.prototype,"isReset",void 0),i([a.observable],f.prototype,"_isPlayed",void 0),i([a.observable],f.prototype,"viewList",void 0),i([a.observable],f.prototype,"_alerttype",void 0),i([a.observable],f.prototype,"_isLivePoint",void 0),i([a.observable],f.prototype,"_isViewSendLive",void 0),i([a.observable],f.prototype,"finishBtn",void 0),i([a.observable],f.prototype,"_totalUsers",void 0),i([a.observable],f.prototype,"sendType",void 0),f=i([r.observer],f),e.TMathJournal=f,e.default=f},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e._getTimeStr=void 0;const n=s(0),o=s(1),r=s(15),a=s(2),l=s(17),d=s(6);function p(t,e){const s=Math.round(e/1e3);let i=Math.round(t/1e3),n=Math.floor(i/60),o=Math.floor(n/60),r="";return i%=60,n%=60,o>0||s>=3600?(r=o+":",r+=n>=10?n+":":"0"+n+":"):s>=600?r+=n>=10?n+":":"0"+n+":":r=n+":",r+=i>=10?i:"0"+i,r}e._getTimeStr=p;let c=class extends n.Component{constructor(){super(...arguments),this.m_dragging=!1,this.m_bgW=0,this.m_s=0,this.m_dragLeft=0,this.m_dragLeft_s=0,this._seek=d.throttle(t=>{if(this.props.disable)return;const e=this.props.player;e.seek(e.duration*t/100)},300,{leading:!1}),this._refBG=t=>{!this.m_bg&&t&&(this.m_bg=t)},this._start=(t,e)=>{if(!this.m_bg||this.props.disable)return;if(this.props.player.duration<=0)return;if(this.m_bgW=this.m_bg.getBoundingClientRect().width,this.m_bgW<=0)return;let s=100*e.x/this.m_bgW;s<0?s=0:s>100&&(s=100),this.m_dragLeft_s=s,this.m_dragLeft=s,this.m_s=e.x,this.m_dragging=!0},this._drag=(t,e)=>{if(!this.m_dragging||this.props.disable)return;let s=this.m_dragLeft_s+100*(e.x-this.m_s-100)/this.m_bgW;s<0?s=0:s>100&&(s=100),this.m_dragLeft=s;this.props.player.bPlay||this._seek(s)},this._stop=(t,e)=>{if(!this.m_dragging||this.props.disable)return;this.m_dragging=!1;const s=this.props.player;s.seek(s.duration*this.m_dragLeft/100)}}render(){const t=this.props.player;let e=0;t.duration>0&&(e=t.viewTime/t.duration*100);let s=0,i=this.m_dragLeft;return s=this.m_dragging?i:e,n.createElement(n.Fragment,null,this.props.barDrag?n.createElement(l.DraggableCore,{onDrag:this._drag,onStart:this._start,onStop:this._stop},n.createElement("div",{className:"prog_box"},n.createElement("div",{className:"prog_bg",ref:this._refBG},n.createElement("div",{className:"prog_bar",style:{width:s+"%"}}),n.createElement("div",{className:"prog_tmp"}),n.createElement(r.ToggleBtn,{className:"prog_btn",style:{left:s+"%"}})))):n.createElement("div",{className:"prog_box"},n.createElement("div",{className:"prog_bg",ref:this._refBG},n.createElement("div",{className:"prog_bar",style:{width:s+"%"}}),n.createElement("div",{className:"prog_tmp"}),n.createElement(r.ToggleBtn,{className:"prog_btn",style:{left:s+"%"}}))),n.createElement("div",{className:"video_time",style:{width:(t.duration>=6e5?110:105)+"px"}},n.createElement("span",{className:"crt_time"},p(t.viewTime,t.duration))," / ",n.createElement("span",null,p(t.duration,t.duration))))}};i([a.observable],c.prototype,"m_dragLeft",void 0),c=i([o.observer],c);let h=class extends n.Component{constructor(t){super(t),this._isPlay=!1,this._isFull=!1,void 0!==this.props.isFull&&(this._isFull=this.props.isFull)}componentDidUpdate(t){this._isPlay=this.props.isPlay,void 0!==this.props.isFull&&(this._isFull=this.props.isFull)}render(){const t=this.props.player;let e=p(t.viewTime,t.duration).replace(":","");return e*=1,this.props.player.duration>0&&this.props.player.viewTime>=this.props.player.duration&&this.props.complete(),n.createElement("div",{className:"control detail "+this.props.playType},n.createElement("div",{className:"control_top"},n.createElement("div",null,n.createElement(c,{player:t,disable:this.props.disable,barDrag:this.props.barDrag}))),n.createElement("div",{className:"control_btm"},n.createElement("div",null,n.createElement(r.ToggleBtn,{className:this._isPlay?"btn_play_pause on":"btn_play_pause",onClick:this.props.togglePlay.bind(this,e)}),n.createElement(r.ToggleBtn,{className:"btn_stop",onClick:this.props.stopClick})),n.createElement("div",null,n.createElement(r.ToggleBtn,{className:"btn_sound",onClick:this.props.toggleMute,on:t.muted}),n.createElement(r.ToggleBtn,{className:this._isFull?"btn_fullscreen_off":"btn_fullscreen",onClick:this.props.toggleFullscreen}))))}};i([a.observable],h.prototype,"_isPlay",void 0),i([a.observable],h.prototype,"_isFull",void 0),h=i([o.observer],h),e.default=h},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r},n=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.MALiveHeader=void 0;const o=s(0),r=s(1),a=s(7),l=s(3);s(48).default;let d=class extends o.Component{constructor(t){super(t),this.editClassName=()=>n(this,void 0,void 0,(function*(){let t=document.getElementsByClassName("live_guage");yield a.wait(1900),t[0].className="live_guage"}))}componentDidUpdate(t){return n(this,void 0,void 0,(function*(){this.props.view&&t.view}))}render(){const{studentName:t,livePoint:e,thumb:s,showhide:i,gender:n,contentType:r,contentName:a}=this.props;let d=0,p=!1,c=!1;return e&&e>300?d=300:e&&300===e?(this.props.view&&!1===p&&l.App.pub_playgreat(),c=!0,p=!0,d=e,this.editClassName()):e&&e<300&&(d=e,p=!1),o.createElement("div",{className:"maheader "+r},o.createElement("div",{className:"user",style:{opacity:"show"===i?1:0}},""===s&&o.createElement("div",{className:"F"===n?"defaultImg_f":"defaultImg_m"},o.createElement("div",null,t.substring(0,2).toUpperCase())),""!==s&&o.createElement("img",{src:s}),o.createElement("span",{className:"name"},t)),o.createElement("div",{className:"live_guage"+(c?" twinkle":"")},o.createElement("div",{className:"heart"}),o.createElement("div",{className:"bar_wrap"},o.createElement("div",{className:"bar",style:{width:d/3+"%"}}),o.createElement("div",{className:"num"+(p?" overmax":""),"data-value":d+""},d))),o.createElement("div",{className:"typeName"},a))}};d=i([r.observer],d),e.MALiveHeader=d},function(t,e){t.exports=ReactIdSwiper},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.MPRState=e.MConfig=e.MPlayer=void 0;const n=s(2);var o,r,a,l,d,p,c;!function(t){t.STRETCH="stretch",t.LETTERBOX="letterbox"}(o||(o={})),function(t){t.NONE="none",t.METADATA="metadata",t.AUTO="auto"}(r||(r={})),function(t){t.ORGIN="origin",t.TRANS="trans",t.ALL="all",t.NONE="none"}(a||(a={})),function(t){t[t.UNINITIALIZED=0]="UNINITIALIZED",t[t.LOADING=1]="LOADING",t[t.PLAYBACK_ERROR=2]="PLAYBACK_ERROR",t[t.READY=3]="READY",t[t.STANDBY=4]="STANDBY",t[t.BUFFERING=5]="BUFFERING",t[t.PAUSED=6]="PAUSED",t[t.PLAYING=7]="PLAYING"}(l||(l={})),e.MPRState=l,function(t){t[t.UNSET=-1]="UNSET",t[t.CAN_NOT_ALL_DIR=1]="CAN_NOT_ALL_DIR",t[t.CAN_NOT_NEXT_DIR=2]="CAN_NOT_NEXT_DIR",t[t.CAN_ALL_DIR=10]="CAN_ALL_DIR"}(d||(d={})),function(t){t[t.HAVE_NOTHING=0]="HAVE_NOTHING",t[t.HAVE_METADATA=1]="HAVE_METADATA",t[t.HAVE_CURRENT_DATA=2]="HAVE_CURRENT_DATA",t[t.HAVE_FUTURE_DATA=3]="HAVE_FUTURE_DATA",t[t.HAVE_ENOUGH_DATA=4]="HAVE_ENOUGH_DATA"}(p||(p={})),function(t){t[t.NETWORK_EMPTY=0]="NETWORK_EMPTY",t[t.NETWORK_IDLE=1]="NETWORK_IDLE",t[t.NETWORK_LOADING=2]="NETWORK_LOADING",t[t.NETWORK_NO_SOURCE=3]="NETWORK_NO_SOURCE"}(c||(c={}));class h{constructor(t){this.defaultVolume=100,this.lenOfFvlToFile=25165824,this.sections=[],this.isVideo=t,this.autoPlay=!1,this.controlBox=!0,this.typeOfPosByMouse=10,this.loop=1,this.preload="auto",this.scaleMode="stretch",this.bgColor=-1,this.initTime=0,this.startTime=0,this.endTime=0,this.chkTime=250,this.playBtn=!0,this.closeBtn=!1,this.popupBtn=!1,this.fullscreenBtn=!0,this.volumeBtn=!0,this.centerPlayBtn=!0,this.centerLoading=!0,this.mousePlayPause=!0,this.bDoFullscreen=!0,this.volumeBox=!0,this.speedBtn=!1,this.scroller=!0,this.togglePlayBtn=!0,this.autoBtn=!1,this.langBtn=!1,this.menuOverlap=!0,this.haveScript=!1,this.viewScriptBox=!1,this.bScriptBtn=!1,this.scriptViewLang="none",this.etcData=""}get isMobile(){return!1}get iskdmPC(){return!1}isLoadControls(t){return this.controlBox||t&&(this.centerPlayBtn||this.centerLoading||this.viewScriptBox)}pcGetURL(t){return t}clone(){const t=new h(this.isVideo);return t.copy(this),t}copy(t){this.autoPlay=t.autoPlay,this.controlBox=t.controlBox,this.typeOfPosByMouse=t.typeOfPosByMouse,this.loop=t.loop,this.preload=t.preload,this.scaleMode=t.scaleMode,this.bgColor=t.bgColor,this.initTime=t.initTime,this.startTime=t.startTime,this.endTime=t.endTime,this.chkTime=t.chkTime,this.playBtn=t.playBtn,this.closeBtn=t.closeBtn,this.popupBtn=t.popupBtn,this.fullscreenBtn=t.fullscreenBtn,this.volumeBtn=t.volumeBtn,this.centerPlayBtn=t.centerPlayBtn,this.centerLoading=t.centerLoading,this.mousePlayPause=t.mousePlayPause,this.volumeBox=t.volumeBox,this.speedBtn=t.speedBtn,this.scroller=t.scroller,this.togglePlayBtn=t.togglePlayBtn,this.autoBtn=t.autoBtn,this.langBtn=t.langBtn,this.menuOverlap=t.menuOverlap,this.haveScript=t.haveScript,this.viewScriptBox=t.viewScriptBox,this.bScriptBtn=t.bScriptBtn,this.scriptViewLang=t.scriptViewLang,this.defaultVolume=t.defaultVolume,this.etcData=t.etcData}}e.MConfig=h;class u{constructor(t){this.m_media=null,this.m_url=null,this.m_startTime=0,this.m_endTime=0,this.m_maxTime=0,this.m_seekTime=-1,this.m_onTimer=-1,this.m_playEnded=!1,this.m_standBy=!1,this.m_bPlay_temp=!1,this.m_startTime_temp=-1,this.m_endTime_temp=-1,this.m_loop_temp=-1,this.m_loopCnt_temp=-1,this.m_onstates=[],this.m_ontimes=[],this.m_onends=[],this.m_onendtemps=[],this.m_bPlay=!1,this.m_myState=0,this.m_duration=0,this.m_volume=1,this.m_currentTime=0,this.m_viewTime=0,this.fullscreen=!1,this.m_muted=!1,this.m_config=t,this.m_bPlay=t.autoPlay,this.m_startTime=t.startTime,this.m_endTime=t.endTime,this.mediaInited=this.mediaInited.bind(this),this._onTime=this._onTime.bind(this)}get bPlay(){return this.m_bPlay}get myState(){return this.m_myState}get duration(){return this.m_duration}get muted(){return this.m_muted}get viewTime(){return this.m_viewTime}get volume(){return this.m_volume}get media(){return this.m_media}get config(){return this.m_config}get currentTime(){return this.m_currentTime}setStartEndTime(t,e){this.m_startTime=t,this.m_endTime=e}setMuted(t){this.m_muted=t,this.m_media&&(this.m_media.muted=t)}setMutedTemp(t){this.m_media&&(this.m_media.muted=t)}setVolume(t){this.m_media&&(this.m_media.volume=t)}_initTemp(){this.m_standBy=!1,this.m_bPlay_temp=!1,this.m_startTime_temp=-1,this.m_endTime_temp=-1,this.m_loop_temp=-1,this.m_loopCnt_temp=0}play(){this.m_bPlay=!0,this._initTemp(),this.m_playEnded&&this.m_media&&this.m_myState>=3&&(this.m_media.currentTime=this.m_startTime/1e3),this.m_playEnded=!1,this._playOrPause()}pause(){this.m_bPlay=!1,this._initTemp(),this._playOrPause()}start(){this.seek(0),this.play()}seek(t){if(!this.m_media||this.m_myState<3)this.m_seekTime=t;else{if(this._initTemp(),this.m_seekTime=-1,isNaN(t)||t<0)t=0;else if(t>=this.m_duration-100)return t=this.m_duration,void this._playEnded();this.m_playEnded=!1,this.m_media.currentTime=(this.m_startTime+t)/1e3,this._onTimeUpdate(),this.m_viewTime=this.m_currentTime}}gotoAndPlay(t,e,s){if(this.m_standBy=!1,!this.m_media||this.m_duration<=0)return this._load(),this.m_bPlay_temp=!0,this.m_startTime_temp=t,this.m_endTime_temp=e,void(this.m_loop_temp=s);this.m_playEnded=!1,this.m_bPlay_temp=!1,this.m_startTime_temp=t,this.m_endTime_temp=e,t=t>=0?t:this.currentTime,e=e>=0&&e<this.m_duration?e:this.m_duration,this.m_bPlay=!0,t>=e||s<=0?(this.m_startTime_temp=-1,this.m_endTime_temp=-1,this.m_loop_temp=-1,this.m_loopCnt_temp=0):(this.m_endTime_temp>=this.m_duration&&(this.m_endTime_temp=-1),this.m_loop_temp=s,this.m_loopCnt_temp=0,this.m_startTime_temp>=0&&(this.m_media.currentTime=(t+this.m_startTime)/1e3,this._onTimeUpdate(),this.m_viewTime=this.m_currentTime)),this._playOrPause()}gotoAndPause(t){this.m_bPlay=!1,this._initTemp(),this.m_media&&(t=t>=0&&t<this.m_duration?t:this.currentTime,this.m_media.currentTime=(t+this.m_startTime)/1e3,this._onTimeUpdate(),this.m_viewTime=this.m_currentTime,this._playOrPause())}connect(){if(this.m_media){this.m_media;this.m_url&&this.m_myState>=1&&3===this.m_media.networkState&&0===this.m_media.readyState&&(this.m_media.src=this.m_url,this.m_media.load())}}unconnect(){this.m_media&&(this.m_media.paused||this.m_media.pause(),this.m_myState>=1&&(this.m_myState>=3&&(this.m_seekTime=1e3*this.m_media.currentTime-this.m_startTime),this.m_media.src="",this.m_media.load()))}_load(){this.m_media&&this.m_url&&this.m_myState<1&&(this._setState(1),this.m_media.src=this.m_url,this.m_media.load())}load(t){this.m_url=t,this._load()}unload(){this.m_media&&(this.m_media.paused||this.m_media.pause(),this.m_media.volume=1,this.m_myState>=1&&(this.m_media.src="",this.m_media.load())),this.m_url=null,this.m_bPlay=!1,this.m_bPlay_temp=!1,this.m_startTime=0,this.m_endTime=0,this.m_maxTime=0,this.m_seekTime=-1,this.m_onTimer=-1,this.m_playEnded=!1,this.m_standBy=!1,this.m_bPlay_temp=!1,this.m_startTime_temp=-1,this.m_endTime_temp=-1,this.m_loop_temp=-1,this.m_loopCnt_temp=-1,this.m_duration=0,this.m_currentTime=0,this.m_viewTime=0,this.fullscreen=!1,this.m_muted=!1,this.m_volume=1,this._setState(0)}destory(){this.unload(),this.m_media=null}_setState(t){if(this.m_myState===t)return;7===t?this.m_onTimer<0&&(this.m_onTimer=window.requestAnimationFrame(this._onTime)):6===t&&this.m_onTimer>=0&&(window.cancelAnimationFrame(this.m_onTimer),this.m_onTimer=-1);const e=this.m_myState;this.m_myState=t;for(let s=0,i=this.m_onstates.length;s<i;s++)this.m_onstates[s](t,e)}_playOrPause(){if(this.m_media&&!(this.m_myState<3))if(this.m_bPlay){if(this._setState(7),this.m_media.paused){const t=this.m_media.play();t&&t.then(t=>{!this.m_media||this.m_bPlay||this.m_media.paused||this.m_media.pause()}).catch(t=>{!this.m_media||this.m_bPlay||this.m_media.paused||this.m_media.pause()})}}else this._setState(6),this.m_media.paused||this.m_media.pause()}_onTimeUpdate(){if(!this.m_media)return;let t=1e3*this.m_media.currentTime;if(this.m_loop_temp>0&&this.m_bPlay)if(t<this.m_startTime)t=this.m_startTime;else if(this.m_endTime_temp>0&&t>=this.m_endTime_temp+this.m_startTime){this.m_currentTime=this.m_endTime_temp,this.m_viewTime=this.m_currentTime;for(let t=0,e=this.m_ontimes.length;t<e;t++)this.m_ontimes[t](this.m_currentTime);this._playEnded()}else{this.m_currentTime=t-this.m_startTime;for(let t=0,e=this.m_ontimes.length;t<e;t++)this.m_ontimes[t](this.m_currentTime)}else if(t<this.m_startTime)t=this.m_startTime;else{if(this.m_endTime>0&&t>=this.m_endTime){this.m_currentTime=this.m_endTime-this.m_startTime,this.m_viewTime=this.m_currentTime;for(let t=0,e=this.m_ontimes.length;t<e;t++)this.m_ontimes[t](this.m_currentTime);return void this._playEnded()}this.m_currentTime=t-this.m_startTime;for(let t=0,e=this.m_ontimes.length;t<e;t++)this.m_ontimes[t](this.m_currentTime)}}_playEnded(){if(this.m_media&&!this.m_playEnded)if(this.m_loop_temp>0&&this.m_bPlay){if(this.m_loopCnt_temp++,this.m_endTime_temp<=0){this.m_bPlay=!1;for(let t=0,e=this.m_onends.length;t<e;t++)this.m_onends[t]()}if(this.m_loopCnt_temp<this.m_loop_temp){const t=this.m_startTime_temp>=0&&this.m_startTime_temp<this.m_duration?this.m_startTime_temp:0;this.m_media.currentTime=(t+this.m_startTime)/1e3,this.m_media.paused&&this.m_media.play()}else{this.m_media.paused||this.m_media.pause(),this.m_bPlay=!1;for(let t=0,e=this.m_onendtemps.length;t<e;t++)this.m_onendtemps[t]()}}else{for(let t=0,e=this.m_onends.length;t<e;t++)this.m_onends[t]();0===this.m_config.loop&&this.m_bPlay?(this.m_media.currentTime=this.m_startTime/1e3,this.m_media.paused&&this.m_media.play()):(this.m_playEnded=!0,this.m_bPlay=!1,this.m_media.paused||this.m_media.pause(),1e3*this.m_media.currentTime<this.m_maxTime-100&&(this.m_media.currentTime=this.m_maxTime/1e3),this.m_currentTime=this.m_maxTime-this.m_startTime,this.m_viewTime=this.m_currentTime,this._setState(6))}}reset(){}_onTime(t){this.m_onTimer>=0&&(this._onTimeUpdate(),this.m_onTimer=window.requestAnimationFrame(this._onTime))}mediaInited(t){if(this.m_media||!t)return;this.m_media=t;const e=e=>{if(!this.m_media)return;this.m_config;if(t.duration>0){if(t.duration>1e6)return void(t.currentTime=1e6);this.m_maxTime<=0?(this.m_maxTime=1e3*t.duration,this.m_endTime>=this.m_maxTime?this.m_endTime=0:this.m_endTime>0&&(this.m_maxTime=this.m_endTime),(this.m_startTime<0||this.m_startTime>=this.m_maxTime)&&(this.m_startTime=0),this.m_duration=this.m_maxTime-this.m_startTime,this.m_bPlay_temp?(this._setState(3),this.gotoAndPlay(this.m_startTime_temp,this.m_endTime_temp,this.m_loop_temp)):this.m_seekTime>0&&this.m_seekTime<this.m_duration?(this._setState(3),this.m_media.currentTime=(this.m_seekTime+this.m_startTime)/1e3):0===this.m_startTime?(this.m_media.currentTime=0,this._setState(3),this._playOrPause()):this.m_media.currentTime=this.m_startTime/1e3,this.m_seekTime=-1):this.m_seekTime>=0&&(this.m_seekTime<this.m_duration&&(this.m_media.currentTime=(this.m_seekTime+this.m_startTime)/1e3),this.m_seekTime=-1)}};t.onabort=t=>{console.log("onabort")},t.oncanplay=e,t.oncanplaythrough=e,t.ondurationchange=e,t.onloadeddata=e,t.onloadedmetadata=e,t.onerror=t=>{1===this.m_myState&&this._setState(2)},t.onended=t=>{this.m_media&&(this.m_maxTime<=0||this.m_myState<3||this._playEnded())},t.onpause=t=>{this.m_media&&(this.m_maxTime<=0||this.m_myState<3||this._setState(6))},t.onplaying=t=>{this.m_media&&(this.m_maxTime<=0||this.m_myState<3||!this.m_bPlay?this.m_media.paused||this.m_media.pause():this._setState(7))},t.onseeking=t=>{!this.m_media||this.m_maxTime<=0||this.m_myState>=3&&this._setState(5)},t.onseeked=t=>{if(this.m_media&&!(this.m_maxTime<=0))if(this.m_myState>=3)this._playOrPause();else if(this.m_myState<3&&this.m_startTime>0){Math.abs(this.m_startTime-1e3*this.m_media.currentTime)<100?(this._setState(3),this._playOrPause()):this.m_media.currentTime=this.m_startTime/1e3}},t.ontimeupdate=t=>{this.m_myState<=2||(this._onTimeUpdate(),this.m_viewTime=this.m_currentTime)},t.onvolumechange=e=>{this.m_volume=t.volume},this._load()}addOnState(t){this.m_onstates.indexOf(t)>=0||this.m_onstates.push(t)}removeOnState(t){const e=this.m_onstates.indexOf(t);e<0||this.m_onstates.splice(e,1)}addOnTime(t){this.m_ontimes.indexOf(t)>=0||this.m_ontimes.push(t)}removeOnTime(t){const e=this.m_ontimes.indexOf(t);e<0||this.m_ontimes.splice(e,1)}addOnPlayEnd(t){this.m_onends.indexOf(t)>=0||this.m_onends.push(t)}removeOnPlayEnd(t){const e=this.m_onends.indexOf(t);e<0||this.m_onends.splice(e,1)}addOnPlayEndTemp(t){this.m_onendtemps.indexOf(t)>=0||this.m_onendtemps.push(t)}removeOnPlayEndTemp(t){const e=this.m_onendtemps.indexOf(t);e<0||this.m_onendtemps.splice(e,1)}}i([n.observable],u.prototype,"m_bPlay",void 0),i([n.observable],u.prototype,"m_myState",void 0),i([n.observable],u.prototype,"m_duration",void 0),i([n.observable],u.prototype,"m_volume",void 0),i([n.observable],u.prototype,"m_viewTime",void 0),i([n.observable],u.prototype,"fullscreen",void 0),i([n.observable],u.prototype,"m_muted",void 0),i([n.computed],u.prototype,"bPlay",null),i([n.computed],u.prototype,"myState",null),i([n.computed],u.prototype,"duration",null),i([n.computed],u.prototype,"muted",null),i([n.computed],u.prototype,"viewTime",null),i([n.computed],u.prototype,"volume",null),e.MPlayer=u},function(t,e,s){t.exports=s(51)},function(t,e,s){"use strict";var i=s(5),n=s(20),o=s(52),r=s(26);function a(t){var e=new o(t),s=n(o.prototype.request,e);return i.extend(s,o.prototype,e),i.extend(s,e),s}var l=a(s(23));l.Axios=o,l.create=function(t){return a(r(l.defaults,t))},l.Cancel=s(27),l.CancelToken=s(66),l.isCancel=s(22),l.all=function(t){return Promise.all(t)},l.spread=s(67),t.exports=l,t.exports.default=l},function(t,e,s){"use strict";var i=s(5),n=s(21),o=s(53),r=s(54),a=s(26);function l(t){this.defaults=t,this.interceptors={request:new o,response:new o}}l.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=a(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=[r,void 0],s=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));e.length;)s=s.then(e.shift(),e.shift());return s},l.prototype.getUri=function(t){return t=a(this.defaults,t),n(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(t){l.prototype[t]=function(e,s){return this.request(i.merge(s||{},{method:t,url:e}))}})),i.forEach(["post","put","patch"],(function(t){l.prototype[t]=function(e,s,n){return this.request(i.merge(n||{},{method:t,url:e,data:s}))}})),t.exports=l},function(t,e,s){"use strict";var i=s(5);function n(){this.handlers=[]}n.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},n.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},n.prototype.forEach=function(t){i.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=n},function(t,e,s){"use strict";var i=s(5),n=s(55),o=s(22),r=s(23);function a(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return a(t),t.headers=t.headers||{},t.data=n(t.data,t.headers,t.transformRequest),t.headers=i.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||r.adapter)(t).then((function(e){return a(t),e.data=n(e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(a(t),e&&e.response&&(e.response.data=n(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},function(t,e,s){"use strict";var i=s(5);t.exports=function(t,e,s){return i.forEach(s,(function(s){t=s(t,e)})),t}},function(t,e){var s,i,n=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function a(t){if(s===setTimeout)return setTimeout(t,0);if((s===o||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(e){try{return s.call(null,t,0)}catch(e){return s.call(this,t,0)}}}!function(){try{s="function"==typeof setTimeout?setTimeout:o}catch(t){s=o}try{i="function"==typeof clearTimeout?clearTimeout:r}catch(t){i=r}}();var l,d=[],p=!1,c=-1;function h(){p&&l&&(p=!1,l.length?d=l.concat(d):c=-1,d.length&&u())}function u(){if(!p){var t=a(h);p=!0;for(var e=d.length;e;){for(l=d,d=[];++c<e;)l&&l[c].run();c=-1,e=d.length}l=null,p=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===r||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function _(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)e[s-1]=arguments[s];d.push(new m(t,e)),1!==d.length||p||a(u)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=_,n.addListener=_,n.once=_,n.off=_,n.removeListener=_,n.removeAllListeners=_,n.emit=_,n.prependListener=_,n.prependOnceListener=_,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,e,s){"use strict";var i=s(5);t.exports=function(t,e){i.forEach(t,(function(s,i){i!==e&&i.toUpperCase()===e.toUpperCase()&&(t[e]=s,delete t[i])}))}},function(t,e,s){"use strict";var i=s(25);t.exports=function(t,e,s){var n=s.config.validateStatus;!n||n(s.status)?t(s):e(i("Request failed with status code "+s.status,s.config,null,s.request,s))}},function(t,e,s){"use strict";t.exports=function(t,e,s,i,n){return t.config=e,s&&(t.code=s),t.request=i,t.response=n,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},function(t,e,s){"use strict";var i=s(61),n=s(62);t.exports=function(t,e){return t&&!i(e)?n(t,e):e}},function(t,e,s){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,s){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,s){"use strict";var i=s(5),n=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,s,o,r={};return t?(i.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=i.trim(t.substr(0,o)).toLowerCase(),s=i.trim(t.substr(o+1)),e){if(r[e]&&n.indexOf(e)>=0)return;r[e]="set-cookie"===e?(r[e]?r[e]:[]).concat([s]):r[e]?r[e]+", "+s:s}})),r):r}},function(t,e,s){"use strict";var i=s(5);t.exports=i.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a");function n(t){var i=t;return e&&(s.setAttribute("href",i),i=s.href),s.setAttribute("href",i),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:"/"===s.pathname.charAt(0)?s.pathname:"/"+s.pathname}}return t=n(window.location.href),function(e){var s=i.isString(e)?n(e):e;return s.protocol===t.protocol&&s.host===t.host}}():function(){return!0}},function(t,e,s){"use strict";var i=s(5);t.exports=i.isStandardBrowserEnv()?{write:function(t,e,s,n,o,r){var a=[];a.push(t+"="+encodeURIComponent(e)),i.isNumber(s)&&a.push("expires="+new Date(s).toGMTString()),i.isString(n)&&a.push("path="+n),i.isString(o)&&a.push("domain="+o),!0===r&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,s){"use strict";var i=s(27);function n(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var s=this;t((function(t){s.reason||(s.reason=new i(t),e(s.reason))}))}n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var t;return{token:new n((function(e){t=e})),cancel:t}},t.exports=n},function(t,e,s){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r},n=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TMathJournal=void 0;const o=s(0),r=s(1),a=s(2),l=s(6),d=s(4),p=s(7),c=s(3),h=s(14),u=s(8),m=s(9),_=s(10),v=s(11),b=s(12),y=s(13);let f=class extends o.Component{constructor(t){super(t),this._viewSample=!1,this._prog=0,this.recordSel=!0,this.recordType="video",this._viewAlert=!1,this._submitStudents=[],this._submitStudentCnt=0,this._isComplete=!1,this.isReset=!1,this._isPlayed=!1,this.viewList=!1,this._onPresent=!1,this.recordBg="bg_math_journal.png",this._alerttype="",this._isLivePoint=!1,this._isViewSendLive=!1,this.finishBtn=!1,this._totalUsers=0,this.sendType="navileft",this.msg="Do you want to send\nGreen lives?",this.recordStopTimer=!1,this.onViewSample=()=>{c.App.pub_playBtnTab(),this._viewSample=!0},this.onCloseSample=()=>{c.App.pub_playBtnTab(),this._viewSample=!1},this._offAlert=()=>{this._viewAlert=!1},this._openRetryPopup=()=>{this._viewAlert=!0,this._alerttype="retry"},this._openForcePopup=()=>{this._prog<=1||(this._viewAlert=!0,this._alerttype="force")},this._onSend=()=>{if(!this.props.view)return;let t;this._prog=1,this.finishBtn=!0,c.App.pub_playToPad(),t="audio"===this.recordType?{msgtype:"math_journal_audio_send"}:{msgtype:"math_journal_video_send"},d.sendPAD(10,t),this.props.actions.setMathJournalResultFnc(this._onMathJournalResultFnc),this.props.actions.setAlertResponse(this._onSendLivePoint),this.props.actions.checkLivePoint(this._onMenuButtonClick),c.App.pub_reloadStudents(()=>n(this,void 0,void 0,(function*(){if(!this.props.view)return;if(1!==this._prog)return;yield p.wait(600),this._prog=2,this.viewList=!0,this.recordSel=!1,this._setNavi(),this.isReset=!1;const t={msgtype:"send_students",students:JSON.stringify(c.App.students)};if(this._totalUsers=c.App.students?c.App.students.length:0,d.sendPAD(10,t),2===this._prog)for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<this._totalUsers;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,videos:[""],audios:[""],beat:[],record:"",recordType:"",order:-1,nosubmit:!0},i=this._submitStudents[t].findIndex(t=>t.student.id===s.student.id);i<=-1?this._submitStudents[t].push(s):this._submitStudents[t][i].student=s.student}})))},this._onMathJournalResultFnc=t=>{var e;if(!this.props.view)return;console.log("re qmsg",t);const s=l.find(c.App.students,{id:t.id});if(!s)return;const i=this._submitStudents[0].findIndex(e=>e.student.id===t.id);if(i>-1)this._submitStudents[0][i].trycnt=t.tryCnt,this._submitStudents[0][i].nosubmit=!1,t.saveImageUrl&&(this._submitStudents[0][i].images?this._submitStudents[0][i].images[0]=t.saveImageUrl:null===(e=this._submitStudents[0][i].images)||void 0===e||e.push(t.saveImageUrl)),"math_journal_video"===t.record?(this._submitStudents[0][i].record="video",this._submitStudents[0][i].videos[0]=t.imageUrl):"math_journal_audio"===t.record&&(this._submitStudents[0][i].record="audio",this._submitStudents[0][i].audios[0]=t.imageUrl),""!==t.beat&&t.beat&&this._submitStudents[0][i].beat.push(t.beat),t.playTime?this._submitStudents[0][i].playTime=t.playTime:this._submitStudents[0][i].playTime="00:00";else{let e;"math_journal_video"===t.record?(e={student:s,correct:!1,trycnt:0,livePoint:0,images:[""],record:"video",recordType:"lyrics_lab"===this.props.state.recordProg?"lyrics_lab":"",videos:[t.imageUrl],beat:""!==t.beat&&t.beat?[t.imageUrl]:[],playTime:t.playTime?t.playTime:"00:00",audios:[],nosubmit:!1},this._submitStudents[0].push(e)):"math_journal_audio"===t.record&&(e={student:s,correct:!1,trycnt:0,livePoint:0,images:[""],record:"audio",videos:[],recordType:"lyrics_lab"===this.props.state.recordProg?"lyrics_lab":"",beat:""!==t.beat&&t.beat?[t.imageUrl]:[],playTime:t.playTime?t.playTime:"00:00",audios:[t.imageUrl],nosubmit:!1},this._submitStudents[0].push(e))}this._submitStudentCnt++,this._submitStudentCnt===c.App.students.length&&(this._isComplete=!0,this.finishBtn=!1,this._prog=4,this.props.actions.setNavi(!0,!1))},this._onSendStop=()=>n(this,void 0,void 0,(function*(){if(!this.props.view&&this.recordStopTimer)return;if(2!==this._prog)return;if(this._prog>=3)return;c.App.pub_playToPad();d.sendPAD(10,{msgtype:"send_stop"}),this._prog=3,this.finishBtn=this._viewAlert=!1,this._submitStudentCnt>0?this._isComplete=!0:this._isComplete=!1,this._alerttype="retry"})),this._onSendRetry=()=>{for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<c.App.students.length;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,order:-1,record:"",videos:[],beat:[],recordType:"lyrics_lab"===this.props.state.recordProg?"lyrics_lab":"",playTime:"",audios:[],nosubmit:!0};this._submitStudents[t][e]=s}this._prog=0,this._viewAlert=!1,this._submitStudentCnt=0,this._isComplete=!1,this.isReset=!0,this.recordSel=!0,this.recordType="";d.sendPAD(10,{msgtype:"retry"})},this._onSendPresenter=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t),i={msgtype:"presenter_send",step:2,id:t,showhide:e,recordType:this.recordType,student:JSON.stringify(s)};d.sendPAD(10,i),this.props.actions.setLivepointResultFnc(this._onLivePointResult),this._isViewSendLive=!1})),this._onLivePointResult=t=>{const e=this._submitStudents[0].findIndex(e=>e.student.id===t.to);300!==this._submitStudents[0][e].livePoint&&(this._submitStudents[0][e].livePoint+=t.livePoint)},this._onSendLiveget=t=>n(this,void 0,void 0,(function*(){const e=this._submitStudents[0].findIndex(e=>e.student.id===t);let s=this._submitStudents[0][e].livePoint;const i={msgtype:"presenter_end",recordType:this.recordType,studentId:t,livePoint:s};d.sendPAD(10,i),this._isViewSendLive=!0})),this._onHidePresenter=()=>{d.sendPAD(10,{msgtype:"math_journal_recording_send"})},this._checkisPlayed=()=>{this._isPlayed=!0},this.onNext=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t);d.sendPAD(10,{msgtype:"next_presenter"}),yield p.wait(600);const i={msgtype:"presenter_send",step:1,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i)})),this.onPrev=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t);d.sendPAD(10,{msgtype:"next_presenter"}),yield p.wait(600);const i={msgtype:"presenter_send",step:1,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i)})),this._callBackFnc=(t,e,s)=>{let i=l.find(this._submitStudents[0],e=>e.student.id===t);i&&(i.livePoint=0);let n={live:e};if(d.sendPADToID(t,21,n),"navileft"===this.sendType&&this._submitStudents[0].length-1===s){const t={msgtype:"content_select"};this.props.state.prog="content_select",this._prog=0,d.sendPAD(0,t)}"naviright"===this.sendType&&this._submitStudents[0].length},this._onSendLivePoint=()=>{if(c.App.isDvlp&&(this._viewAlert=!1),this._submitStudents[0].length>0)for(let t=0;t<this._submitStudents[0].length;t++){let e={addOnHost:c.App.addOnHost,liveType:"green",plusMinusType:"plus",score:this._submitStudents[0][t].livePoint,userIdx:this._submitStudents[0][t].student.id,clsIdx:this.props.state.classid,depthItemIdx:this.props.state.curriculumid,callback:s=>{this._callBackFnc(e.userIdx,e.score,t)},error:t=>{console.log("Request Error ! Check the params")}};!c.App.isDvlp&&e.score>0&&y.setLivePoint(e),c.App.isDvlp&&this._callBackFnc(e.userIdx,e.score,t)}},this._onMenuButtonClick=()=>{this._isLivePoint&&(this.sendType="button",d.alertToTeacher({text:this.msg,from:"book"}))},this._onBtnHeaert=()=>{c.App.isDvlp?(this._alerttype="livepoint",this._viewAlert=!0,this.sendType="button"):(this.sendType="button",d.alertToTeacher({text:this.msg,from:"book"}))},this.keywords=this.props.actions.getData().keywords;for(let t=0;t<5;t++)this._submitStudents.push([])}_checkLivePoint(){this._submitStudents[0].filter((t,e)=>t.livePoint>0).length>0?this._isLivePoint=!0:this._isLivePoint=!1}_setNavi(){this.props.view&&"math_journal_recording"===this.props.state.prog&&(this.props.actions.setNaviView(!0),this.props.actions.setNavi(!0,!1),this.props.actions.setNaviFnc(()=>{if(this._isLivePoint)return this.sendType="navileft",this._alerttype="livepoint",void(c.App.isDvlp?this._viewAlert=!0:d.alertToTeacher({text:this.msg,from:"book"}));this.props.state.prog="content_select",this._prog=0,d.sendPAD(0,{msgtype:"content_select"})},()=>{if(this._isLivePoint)return this.sendType="naviright",this._alerttype="livepoint",void(c.App.isDvlp?this._viewAlert=!0:d.alertToTeacher({text:this.msg,from:"book"}))}))}_recordType(t){c.App.pub_playBtnTab(),this.recordType=t}componentDidUpdate(t){if(this.props.view&&!t.view){this._submitStudentCnt=0,this._prog=0,this.recordStopTimer=this._viewSample=this._isComplete=this._isPlayed=this.viewList=!1,this.recordSel=!0,this._isViewSendLive=!1,this._submitStudents[0]=[];document.querySelectorAll(".btn_heart").forEach((t,e)=>{t.setAttribute("style","display: none; z-index: 0")}),"math_journal"===this.props.state.recordProg?this.recordBg="bg_math_journal.png":"lyrics_lab"===this.props.state.recordProg?this.recordBg="bg_lyrics_lab.png":"let_me_explain_a"!==this.props.state.recordProg&&"let_me_explain_b"!==this.props.state.recordProg&&"let_me_explain_c"!==this.props.state.recordProg||(this.recordBg="bg_letme_explain.png");for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<c.App.students.length;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,order:-1,record:"",videos:[],beat:[],recordType:"lyrics_lab"===this.props.state.recordProg?"lyrics_lab":"",playTime:"",audios:[],nosubmit:!0};this._submitStudents[t].findIndex(t=>t.student.id===s.student.id)<=-1?this._submitStudents[t].push(s):this._submitStudents[t][e]=s}const t={msgtype:"send_students",students:JSON.stringify(c.App.students)};d.sendPAD(10,t),this._setNavi()}else!this.props.view&&t.view&&(this._submitStudentCnt=0,this._viewSample=!1,this.props.actions.setAlertResponse(null),this.props.actions.checkLivePoint(null),this._checkLivePoint());this.props.view&&this.viewList&&this._isComplete&&this._checkLivePoint(),2===this._prog||1===this._prog?this.props.state.navi.enableLeft=!1:this.props.state.navi.enableLeft=!0}render(){const{view:t,actions:e}=this.props;let s;return s="math_journal"===this.props.state.recordProg?"type01":"role_playing"===this.props.state.recordProg?"type02":"concept_board"===this.props.state.recordProg?"type03":"lyrics_lab"===this.props.state.recordProg?"type04":"let_me_explain_a"===this.props.state.recordProg||"let_me_explain_b"===this.props.state.prog||"let_me_explain_c"===this.props.state.prog?"type05":"",o.createElement("div",{className:"t_math_journal record",style:{display:t?"":"none"}},o.createElement("div",{style:{display:this.recordSel?"":"none"},className:"recordContent"},o.createElement("div",{className:"record_set"},o.createElement("button",{className:"video"===this.recordType?"btn video on":"btn video",onClick:this._recordType.bind(this,"video")}),o.createElement("button",{className:"audio"===this.recordType?"btn audio on":"btn audio",onClick:this._recordType.bind(this,"audio")}))),o.createElement("div",{className:"portfolioContent record",style:{display:this._prog<=1?"":"none"}},o.createElement("div",{className:"topHeader"}),o.createElement("div",{className:"content"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/"+this.recordBg,className:"recordBg"}),o.createElement(h.default,{view:t,keywords:this.keywords}))),o.createElement("div",{className:"pop"+(this._viewSample?" show":"")},o.createElement("div",{className:"stage"},o.createElement("div",{className:"header"},"Math Journal",o.createElement("div",{className:"user"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/temp_user_01.png"}),o.createElement("span",{className:"name"},"Jinny")),o.createElement("button",{className:"btn_close",onClick:this.onCloseSample})))),o.createElement(v.AlertPopup,{view:this._viewAlert,onClose:this._offAlert,onOk:"force"===this._alerttype?this._onSendStop:"livepoint"===this._alerttype?this._onSendLivePoint:this._onSendRetry,msg:"force"===this._alerttype?"Force Quit?":"livepoint"===this._alerttype?"Do you want to send <br> Green lives?":"Retry?"}),o.createElement(u.default,{view:0===this._prog,type:"teacher",sended:!1,originY:0,onSend:this._onSend}),o.createElement(b.BtnSendLive,{view:this.viewList&&this._prog>=1&&this._isViewSendLive&&!this.finishBtn,disabled:!this._isLivePoint,on:this._isLivePoint,onClick:this._onBtnHeaert}),o.createElement(_.BtnProgress,{view:this.finishBtn&&0!==this._prog,isEnd:this._isComplete,totalStudents:c.App.students?c.App.students.length:0,submitStudents:this._submitStudentCnt,onClick:this._isComplete?this._openRetryPopup:this._openForcePopup}),this.viewList&&this._prog>=2?o.createElement(m.SendnShare,{view:!0,type:"video",submitStudent:l.cloneDeep(this._submitStudents),isComplete:this._prog>=3&&this._isComplete,isReset:this.isReset,onSendPresenter:this._onSendPresenter,onSendLiveget:this._onSendLiveget,onHidePresenter:this._onHidePresenter,quizIdx:0,checkIsPlayed:this._checkisPlayed,isPlayed:this._isPlayed,onNext:this.onNext,onPrev:this.onPrev,contentType:s,clsIdx:this.props.state.classid,curriculumid:this.props.state.curriculumid}):void 0)}};i([a.observable],f.prototype,"_viewSample",void 0),i([a.observable],f.prototype,"_prog",void 0),i([a.observable],f.prototype,"recordSel",void 0),i([a.observable],f.prototype,"recordType",void 0),i([a.observable],f.prototype,"_viewAlert",void 0),i([a.observable],f.prototype,"_submitStudents",void 0),i([a.observable],f.prototype,"_submitStudentCnt",void 0),i([a.observable],f.prototype,"_isComplete",void 0),i([a.observable],f.prototype,"isReset",void 0),i([a.observable],f.prototype,"_isPlayed",void 0),i([a.observable],f.prototype,"viewList",void 0),i([a.observable],f.prototype,"_onPresent",void 0),i([a.observable],f.prototype,"recordBg",void 0),i([a.observable],f.prototype,"_alerttype",void 0),i([a.observable],f.prototype,"_isLivePoint",void 0),i([a.observable],f.prototype,"_isViewSendLive",void 0),i([a.observable],f.prototype,"finishBtn",void 0),i([a.observable],f.prototype,"_totalUsers",void 0),i([a.observable],f.prototype,"sendType",void 0),i([a.observable],f.prototype,"recordStopTimer",void 0),f=i([r.observer],f),e.TMathJournal=f,e.default=f},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r},n=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TRolePlaying=void 0;const o=s(0),r=s(1),a=s(2),l=s(6),d=s(4),p=s(7),c=s(3),h=s(14),u=s(8),m=s(9),_=s(10),v=s(11),b=s(12),y=s(13);let f=class extends o.Component{constructor(t){super(t),this._viewSample=!1,this._prog=0,this._viewAlert=!1,this._submitStudents=[],this._submitStudentCnt=0,this._isComplete=!1,this.isReset=!1,this._isPlayed=!1,this.viewList=!1,this._alerttype="",this._isLivePoint=!1,this._isViewSendLive=!0,this.finishBtn=!1,this._totalUsers=0,this.sendType="navileft",this.msg="Do you want to send\nGreen lives?",this.onViewSample=()=>{c.App.pub_playBtnTab(),this._viewSample=!0},this.onCloseSample=()=>{c.App.pub_playBtnTab(),this._viewSample=!1},this._offAlert=()=>{this._viewAlert=!1},this._openRetryPopup=()=>{this._viewAlert=!0,this._alerttype="retry"},this._openForcePopup=()=>{this._prog<=1||(this._viewAlert=!0,this._alerttype="force")},this._onSend=()=>{if(!this.props.view)return;this._prog=1,this.finishBtn=!0,c.App.pub_playToPad();d.sendPAD(10,{msgtype:"role_playing_send"}),this.props.actions.setRolePlayingResultFnc(this._onRolePlayingResultFnc),this.props.actions.setAlertResponse(this._onSendLivePoint),this.props.actions.checkLivePoint(this._onMenuButtonClick),c.App.pub_reloadStudents(()=>n(this,void 0,void 0,(function*(){if(!this.props.view)return;if(1!==this._prog)return;yield p.wait(600),this._prog=2,this._setNavi(),this.viewList=!0,this.isReset=!1;const t={msgtype:"send_students",students:JSON.stringify(c.App.students)};if(this._totalUsers=c.App.students?c.App.students.length:0,d.sendPAD(10,t),2===this._prog)for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<this._totalUsers;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,videos:[""],audios:[""],beat:[],record:"",recordType:"",order:-1,nosubmit:!0},i=this._submitStudents[t].findIndex(t=>t.student.id===s.student.id);i<=-1?this._submitStudents[t].push(s):this._submitStudents[t][i].student=s.student}})))},this._onRolePlayingResultFnc=t=>{if(!this.props.view)return;if(this._submitStudentCnt===c.App.students.length)return;if(t.tryCnt<2)this._submitStudentCnt++;else if(t.tryCnt>=2)return;const e=l.find(c.App.students,{id:t.id});if(!e)return;const s=this._submitStudents[0].findIndex(e=>e.student.id===t.id);if(s>-1)this._submitStudents[0][s].trycnt=t.tryCnt,this._submitStudents[0][s].nosubmit=!1,this._submitStudents[0][s].images===[]?this._submitStudents[0][s].images.push(t.imageUrl):this._submitStudents[0][s].images[0]=t.imageUrl;else{let s={student:e,correct:!1,trycnt:1,livePoint:0,images:[t.imageUrl],record:"",videos:[],beat:[],recordType:"",audios:[],nosubmit:!1};this._submitStudents[0].push(s)}this._submitStudentCnt===c.App.students.length&&(this._isComplete=!0,this.finishBtn=!1,this._prog=4,this.props.actions.setNavi(!0,!0))},this._onSendStop=()=>{if(!this.props.view)return;if(2!==this._prog)return;if(this._prog>=3)return;c.App.pub_playToPad();d.sendPAD(10,{msgtype:"send_stop"}),this._prog=3,this.finishBtn=this._viewAlert=!1,this.props.actions.setNavi(!0,!0),this._submitStudentCnt>0?this._isComplete=!0:this._isComplete=!1,this._alerttype="retry"},this._onSendRetry=()=>{for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<c.App.students.length;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,order:-1,record:"",beat:[],recordType:"",videos:[],audios:[],nosubmit:!0};this._submitStudents[t][e]=s}this._prog=0,this._viewAlert=!1,this._submitStudentCnt=0,this._isComplete=!1,this.isReset=!0;d.sendPAD(10,{msgtype:"retry"})},this._onSendPresenter=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t),i={msgtype:"presenter_send",step:3,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i),this.props.actions.setLivepointResultFnc(this._onLivePointResult),this._isViewSendLive=!1})),this._onLivePointResult=t=>{const e=this._submitStudents[0].findIndex(e=>e.student.id===t.to);300!==this._submitStudents[0][e].livePoint&&(this._submitStudents[0][e].livePoint+=t.livePoint)},this._onSendLiveget=t=>n(this,void 0,void 0,(function*(){const e=this._submitStudents[0].findIndex(e=>e.student.id===t);let s=this._submitStudents[0][e].livePoint;const i={msgtype:"presenter_end",studentId:t,livePoint:s};d.sendPAD(10,i),this._isViewSendLive=!0})),this._onHidePresenter=()=>{d.sendPAD(10,{msgtype:"role_playing_send"})},this._checkisPlayed=()=>{this._isPlayed=!0},this.onNext=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t);d.sendPAD(10,{msgtype:"next_presenter"}),yield p.wait(600);const i={msgtype:"presenter_send",step:3,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i)})),this.onPrev=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t);d.sendPAD(10,{msgtype:"next_presenter"}),yield p.wait(600);const i={msgtype:"presenter_send",step:3,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i)})),this._callBackFnc=(t,e,s)=>{let i=l.find(this._submitStudents[0],e=>e.student.id===t);i&&(i.livePoint=0);let n={live:e};if(d.sendPADToID(t,21,n),"navileft"===this.sendType&&this._submitStudents[0].length-1===s){const t={msgtype:"content_select"};this.props.state.prog="content_select",this.props.state.recordProg="",this._prog=0,d.sendPAD(0,t)}if("naviright"===this.sendType&&this._submitStudents[0].length-1===s){this.props.state.prog="math_journal_recording",this.props.state.recordProg="role_playing";const t={msgtype:"math_journal_recording_ready"};d.sendPAD(10,t)}},this._onSendLivePoint=()=>{if(c.App.isDvlp&&(this._viewAlert=!1),this._submitStudents[0].length>0)for(let t=0;t<this._submitStudents[0].length;t++){let e={addOnHost:c.App.addOnHost,liveType:"green",plusMinusType:"plus",score:this._submitStudents[0][t].livePoint,userIdx:this._submitStudents[0][t].student.id,clsIdx:this.props.state.classid,depthItemIdx:this.props.state.curriculumid,callback:s=>{this._callBackFnc(e.userIdx,e.score,t)},error:t=>{console.log("Request Error ! Check the params")}};!c.App.isDvlp&&e.score>0&&y.setLivePoint(e),c.App.isDvlp&&this._callBackFnc(e.userIdx,e.score,t)}},this._onMenuButtonClick=()=>{this._isLivePoint&&(this.sendType="button",d.alertToTeacher({text:this.msg,from:"book"}))},this._onBtnHeaert=()=>{c.App.isDvlp?(this._alerttype="livepoint",this._viewAlert=!0,this.sendType="button"):(this.sendType="button",d.alertToTeacher({text:this.msg,from:"book"}))},this.keywords=this.props.actions.getData().keywords,this.dataGrade=this.props.actions.getData().grade,this._submitStudents.push([])}_checkLivePoint(){this._submitStudents[0].filter((t,e)=>t.livePoint>0).length>0?this._isLivePoint=!0:this._isLivePoint=!1}_setNavi(){this.props.view&&"role_playing"===this.props.state.prog&&(this.props.actions.setNaviView(!0),this.props.actions.setNavi(!0,!1),this.props.actions.setNaviFnc(()=>{if(this._isLivePoint)return this.sendType="navileft",this._alerttype="livepoint",void(c.App.isDvlp?this._viewAlert=!0:d.alertToTeacher({text:this.msg,from:"book"}));this.props.state.prog="content_select",this.props.state.recordProg="",this._prog=0,d.sendPAD(0,{msgtype:"content_select"})},()=>{if(this._isLivePoint)return this.sendType="naviright",this._alerttype="livepoint",void(c.App.isDvlp?this._viewAlert=!0:d.alertToTeacher({text:this.msg,from:"book"}));this.props.state.prog="math_journal_recording",this.props.state.recordProg="role_playing";d.sendPAD(10,{msgtype:"math_journal_recording_ready"})}))}componentDidUpdate(t){if(this.props.view&&!t.view){this._submitStudentCnt=0,this._viewSample=!1,this._prog=0,this._isComplete=!1,this.viewList=!1,this._isPlayed=!1,this.props.actions.setAlertResponse(null),this.props.actions.checkLivePoint(null),this._submitStudents[0]=[];for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<c.App.students.length;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,videos:[""],audios:[""],beat:[],recordType:"",record:"",order:-1,nosubmit:!0};this._submitStudents[t].findIndex(t=>t.student.id===s.student.id)<=-1?this._submitStudents[t].push(s):this._submitStudents[t][e]=s}const t={msgtype:"send_students",students:JSON.stringify(c.App.students)};d.sendPAD(10,t),this._setNavi()}else!this.props.view&&t.view&&(this._submitStudentCnt=0,this._viewSample=!1,this.props.actions.setAlertResponse(null),this.props.actions.checkLivePoint(null),this._checkLivePoint());this.props.view&&this.viewList&&this._isComplete&&this._checkLivePoint(),2===this._prog||1===this._prog?this.props.state.navi.enableLeft=!1:this.props.state.navi.enableLeft=!0}render(){const{view:t,actions:e}=this.props;return o.createElement("div",{className:"t_roleplay_content",style:{display:t?"":"none"}},o.createElement("div",{className:"topHeader",style:{display:this._prog<=1?"":"none"}},o.createElement("div",{className:"type c"},"TYPE ",o.createElement("span",null,"A")),o.createElement("button",{className:"btn_help"}),o.createElement("button",{className:"btn_answer"},"Answer")),o.createElement("div",{className:"portfolioContent",style:{display:this._prog<=1?"":"none"}},o.createElement("div",{className:"content"},o.createElement("div",{className:"artboard"},o.createElement("div",{className:"inner"},o.createElement("h2",null,"Role Play"),o.createElement("button",{className:"btn_sample",onClick:this.onViewSample},"Sample"),o.createElement("div",{className:"talk left"},o.createElement("div",{className:"user"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/ico_rp_char_01.png"})),o.createElement("div",{className:"message"})),o.createElement("div",{className:"talk right"},o.createElement("div",{className:"user"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/ico_rp_char_02.png"})),o.createElement("div",{className:"message"})),o.createElement("div",{className:"talk left"},o.createElement("div",{className:"user"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/ico_rp_char_01.png"})),o.createElement("div",{className:"message"})),o.createElement("div",{className:"talk right"},o.createElement("div",{className:"user"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/ico_rp_char_02.png"})),o.createElement("div",{className:"message"})))),o.createElement(h.default,{view:t,keywords:this.keywords}))),o.createElement("div",{className:"pop"+(this._viewSample?" show":"")},o.createElement("div",{className:"stage"},o.createElement("div",{className:"header"},"Role Play",o.createElement("div",{className:"user"},o.createElement("div",{className:"img"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/temp_user_01.png"})),o.createElement("span",{className:"name"},"Jinny")),o.createElement("button",{className:"btn_close",onClick:this.onCloseSample})),o.createElement("div",{className:"content"},o.createElement("div",{className:"scroll"},2===this.dataGrade?o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/sample/type02_upper.png"}):o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/sample/type02_lower.png"}))))),o.createElement(v.AlertPopup,{view:this._viewAlert,onClose:this._offAlert,onOk:"force"===this._alerttype?this._onSendStop:"livepoint"===this._alerttype?this._onSendLivePoint:this._onSendRetry,msg:"force"===this._alerttype?"Force Quit?":"livepoint"===this._alerttype?"Do you want to send <br> Green lives?":"Retry?"}),o.createElement(u.default,{view:0===this._prog,type:"teacher",sended:!1,originY:0,onSend:this._onSend}),o.createElement(_.BtnProgress,{view:this.finishBtn&&0!==this._prog,isEnd:this._isComplete,totalStudents:c.App.students?c.App.students.length:0,submitStudents:this._submitStudentCnt,onClick:this._isComplete?this._openRetryPopup:this._openForcePopup}),this.viewList&&this._prog>=2&&this._isViewSendLive&&!this.finishBtn?o.createElement(b.BtnSendLive,{view:!0,disabled:!this._isLivePoint,on:this._isLivePoint,onClick:this._onBtnHeaert}):void 0,o.createElement(m.SendnShare,{view:this._prog>=2&&this.viewList,type:"image",submitStudent:l.cloneDeep(this._submitStudents),isComplete:this._prog>=3&&this._isComplete,isReset:this.isReset,onSendPresenter:this._onSendPresenter,onSendLiveget:this._onSendLiveget,onHidePresenter:this._onHidePresenter,quizIdx:0,checkIsPlayed:this._checkisPlayed,isPlayed:this._isPlayed,onNext:this.onNext,onPrev:this.onPrev,contentType:"type02",clsIdx:this.props.state.classid,curriculumid:this.props.state.curriculumid}))}};i([a.observable],f.prototype,"_viewSample",void 0),i([a.observable],f.prototype,"_prog",void 0),i([a.observable],f.prototype,"_viewAlert",void 0),i([a.observable],f.prototype,"_submitStudents",void 0),i([a.observable],f.prototype,"_submitStudentCnt",void 0),i([a.observable],f.prototype,"_isComplete",void 0),i([a.observable],f.prototype,"isReset",void 0),i([a.observable],f.prototype,"_isPlayed",void 0),i([a.observable],f.prototype,"viewList",void 0),i([a.observable],f.prototype,"_alerttype",void 0),i([a.observable],f.prototype,"_isLivePoint",void 0),i([a.observable],f.prototype,"_isViewSendLive",void 0),i([a.observable],f.prototype,"finishBtn",void 0),i([a.observable],f.prototype,"_totalUsers",void 0),i([a.observable],f.prototype,"sendType",void 0),f=i([r.observer],f),e.TRolePlaying=f,e.default=f},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r},n=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TConceptBoard=void 0;const o=s(0),r=s(1),a=s(2),l=s(6),d=s(4),p=s(7),c=s(3),h=s(14),u=s(8),m=s(9),_=s(10),v=s(11),b=s(12),y=s(13);let f=class extends o.Component{constructor(t){super(t),this._viewSample=!1,this._prog=0,this._viewAlert=!1,this._submitStudents=[],this._submitStudentCnt=0,this._isComplete=!1,this.isReset=!1,this._isPlayed=!1,this.viewList=!1,this._alerttype="",this._isLivePoint=!1,this._isViewSendLive=!0,this.finishBtn=!1,this._totalUsers=0,this.sendType="navileft",this.msg="Do you want to send\nGreen lives?",this.onViewSample=()=>{c.App.pub_playBtnTab(),this._viewSample=!0},this.onCloseSample=()=>{c.App.pub_playBtnTab(),this._viewSample=!1},this._offAlert=()=>{this._viewAlert=!1},this._openRetryPopup=()=>{this._viewAlert=!0,this._alerttype="retry"},this._openForcePopup=()=>{this._prog<=1||(this._viewAlert=!0,this._alerttype="force")},this._onSend=()=>{if(!this.props.view)return;this._prog=1,this.finishBtn=!0,c.App.pub_playToPad();d.sendPAD(10,{msgtype:"concept_board_send"}),this.props.actions.setConceptBoardResultFnc(this._onConceptBoardResultFnc),this.props.actions.setAlertResponse(this._onSendLivePoint),this.props.actions.checkLivePoint(this._onMenuButtonClick),c.App.pub_reloadStudents(()=>n(this,void 0,void 0,(function*(){if(!this.props.view)return;if(1!==this._prog)return;yield p.wait(600),this._prog=2,this._setNavi(),this.viewList=!0,this.isReset=!1;const t={msgtype:"send_students",students:JSON.stringify(c.App.students)};if(this._totalUsers=c.App.students?c.App.students.length:0,d.sendPAD(10,t),2===this._prog)for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<this._totalUsers;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,videos:[""],audios:[""],beat:[],record:"",recordType:"",order:-1,nosubmit:!0},i=this._submitStudents[t].findIndex(t=>t.student.id===s.student.id);i<=-1?this._submitStudents[t].push(s):this._submitStudents[t][i].student=s.student}})))},this._onConceptBoardResultFnc=t=>{if(!this.props.view)return;if(this._submitStudentCnt===c.App.students.length)return;if(t.tryCnt<2)this._submitStudentCnt++;else if(t.tryCnt>=2)return;const e=l.find(c.App.students,{id:t.id});if(!e)return;const s=this._submitStudents[0].findIndex(e=>e.student.id===t.id);if(s>-1)this._submitStudents[0][s].trycnt=t.tryCnt,this._submitStudents[0][s].nosubmit=!1,this._submitStudents[0][s].images===[]?this._submitStudents[0][s].images.push(t.imageUrl):this._submitStudents[0][s].images[0]=t.imageUrl;else{let s={student:e,correct:!1,trycnt:1,livePoint:0,videos:[""],audios:[""],beat:[],record:"",recordType:"",images:[t.imageUrl],nosubmit:!1};this._submitStudents[0].push(s)}this._submitStudentCnt===c.App.students.length&&(this._isComplete=!0,this.finishBtn=!1,this._prog=4,this.props.actions.setNavi(!0,!0))},this._onSendStop=()=>n(this,void 0,void 0,(function*(){if(!this.props.view)return;if(2!==this._prog)return;if(this._prog>=3)return;c.App.pub_playToPad();d.sendPAD(10,{msgtype:"send_stop"}),this._prog=3,this.finishBtn=this._viewAlert=!1,this.props.actions.setNavi(!0,!0),this._submitStudentCnt>0?this._isComplete=!0:this._isComplete=!1,this._alerttype="retry"})),this._onSendRetry=()=>{for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<c.App.students.length;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,videos:[""],audios:[""],beat:[],record:"",recordType:"",order:-1,nosubmit:!0};this._submitStudents[t][e]=s}this._prog=0,this._viewAlert=!1,this._submitStudentCnt=0,this._isComplete=!1,this.isReset=!0;d.sendPAD(10,{msgtype:"retry"})},this._onSendPresenter=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t),i={msgtype:"presenter_send",step:4,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i),this.props.actions.setLivepointResultFnc(this._onLivePointResult),this._isViewSendLive=!1})),this._onLivePointResult=t=>{const e=this._submitStudents[0].findIndex(e=>e.student.id===t.to);300!==this._submitStudents[0][e].livePoint&&(this._submitStudents[0][e].livePoint+=t.livePoint)},this._onSendLiveget=t=>n(this,void 0,void 0,(function*(){const e=this._submitStudents[0].findIndex(e=>e.student.id===t);let s=this._submitStudents[0][e].livePoint;const i={msgtype:"presenter_end",studentId:t,livePoint:s};d.sendPAD(10,i),this._isViewSendLive=!0})),this._onHidePresenter=()=>{},this._checkisPlayed=()=>{this._isPlayed=!0},this.onNext=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t);d.sendPAD(10,{msgtype:"next_presenter"}),yield p.wait(600);const i={msgtype:"presenter_send",step:4,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i)})),this.onPrev=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t);d.sendPAD(10,{msgtype:"next_presenter"}),yield p.wait(600);const i={msgtype:"presenter_send",step:4,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i)})),this._callBackFnc=(t,e,s)=>{let i=l.find(this._submitStudents[0],e=>e.student.id===t);i&&(i.livePoint=0);let n={live:e};if(d.sendPADToID(t,21,n),"navileft"===this.sendType&&this._submitStudents[0].length-1===s){const t={msgtype:"content_select"};this.props.state.prog="content_select",this.props.state.recordProg="",this._prog=0,d.sendPAD(0,t)}if("naviright"===this.sendType&&this._submitStudents[0].length-1===s){this.props.state.prog="math_journal_recording",this.props.state.recordProg="concept_board";const t={msgtype:"math_journal_recording_ready"};d.sendPAD(10,t)}},this._onSendLivePoint=()=>{if(c.App.isDvlp&&(this._viewAlert=!1),this._submitStudents[0].length>0)for(let t=0;t<this._submitStudents[0].length;t++){let e={addOnHost:c.App.addOnHost,liveType:"green",plusMinusType:"plus",score:this._submitStudents[0][t].livePoint,userIdx:this._submitStudents[0][t].student.id,clsIdx:this.props.state.classid,depthItemIdx:this.props.state.curriculumid,callback:s=>{this._callBackFnc(e.userIdx,e.score,t)},error:t=>{console.log("Request Error ! Check the params")}};!c.App.isDvlp&&e.score>0&&y.setLivePoint(e),c.App.isDvlp&&this._callBackFnc(e.userIdx,e.score,t)}},this._onMenuButtonClick=()=>{this._isLivePoint&&(this.sendType="button",d.alertToTeacher({text:this.msg,from:"book"}))},this._onBtnHeaert=()=>{c.App.isDvlp?(this._alerttype="livepoint",this._viewAlert=!0,this.sendType="button"):(this.sendType="button",d.alertToTeacher({text:this.msg,from:"book"}))},this.keywords=this.props.actions.getData().keywords,this.dataGrade=this.props.actions.getData().grade,this._submitStudents.push([])}_checkLivePoint(){this._submitStudents[0].filter((t,e)=>t.livePoint>0).length>0?this._isLivePoint=!0:this._isLivePoint=!1}_setNavi(){this.props.view&&"concept_board"===this.props.state.prog&&(this.props.actions.setNaviView(!0),this.props.actions.setNavi(!0,!1),this.props.actions.setNaviFnc(()=>{if(this._isLivePoint)return this.sendType="navileft",this._alerttype="livepoint",void(c.App.isDvlp?this._viewAlert=!0:d.alertToTeacher({text:this.msg,from:"book"}));this.props.state.prog="content_select",this.props.state.recordProg="",this._prog=0,d.sendPAD(0,{msgtype:"content_select"})},()=>{if(this._isLivePoint)return this.sendType="naviright",this._alerttype="livepoint",void(c.App.isDvlp?this._viewAlert=!0:d.alertToTeacher({text:this.msg,from:"book"}));this.props.state.prog="math_journal_recording",this.props.state.recordProg="concept_board";d.sendPAD(10,{msgtype:"math_journal_recording_ready"})}))}componentDidUpdate(t){if(this.props.view&&!t.view){this._submitStudentCnt=0,this._viewSample=!1,this._prog=0,this._isComplete=!1,this.viewList=!1,this._isPlayed=!1,this.props.actions.setAlertResponse(null),this.props.actions.checkLivePoint(null),this._submitStudents[0]=[];for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<c.App.students.length;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,order:-1,record:"",videos:[],recordType:"",beat:[],audios:[],nosubmit:!0};this._submitStudents[t].findIndex(t=>t.student.id===s.student.id)<=-1?this._submitStudents[t].push(s):this._submitStudents[t][e]=s}const t={msgtype:"send_students",students:JSON.stringify(c.App.students)};d.sendPAD(10,t),this._setNavi()}else!this.props.view&&t.view&&(this._viewSample=!1,this._submitStudentCnt=0,this.props.actions.setAlertResponse(null),this.props.actions.checkLivePoint(null),this._checkLivePoint());this.props.view&&this.viewList&&this._isComplete&&this._checkLivePoint(),2===this._prog||1===this._prog?this.props.state.navi.enableLeft=!1:this.props.state.navi.enableLeft=!0}render(){const{view:t,actions:e}=this.props;return o.createElement("div",{className:"t_concept_board",style:{display:t?"":"none"}},o.createElement("div",{className:"topHeader",style:{display:this._prog<=1?"":"none"}},o.createElement("div",{className:"type c"},"TYPE ",o.createElement("span",null,"A")),o.createElement("button",{className:"btn_help"}),o.createElement("button",{className:"btn_answer"},"Answer")),o.createElement("div",{className:"portfolioContent",style:{display:this._prog<=1?"":"none"}},o.createElement("div",{className:"content"},o.createElement("div",{className:"artboard"},o.createElement("div",{className:"inner"},o.createElement("h2",null,"Concept Board"),o.createElement("button",{className:"btn_sample",onClick:this.onViewSample},"Sample"),o.createElement("div",{className:"board_set"},o.createElement("div",{className:"board b01"}),o.createElement("div",{className:"board b02"}),o.createElement("div",{className:"board b03"}),o.createElement("div",{className:"board b04"}),o.createElement("div",{className:"board subject"},o.createElement("span",{className:"ico_keyboard"}))))),o.createElement(h.default,{view:t,keywords:this.keywords}))),o.createElement("div",{className:"pop"+(this._viewSample?" show":"")},o.createElement("div",{className:"stage"},o.createElement("div",{className:"header"},"Concept Board",o.createElement("div",{className:"user"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/temp_user_01.png"}),o.createElement("span",{className:"name"},"Jinny")),o.createElement("button",{className:"btn_close",onClick:this.onCloseSample})),o.createElement("div",{className:"content"},o.createElement("div",{className:"scroll"},2===this.dataGrade?o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/sample/type03_upper.png"}):o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/sample/type03_lower.png"}))))),o.createElement("div",{className:"pop_concept_board"},o.createElement("div",{className:"stage"},o.createElement("div",{className:"header"},"Concept Board",o.createElement("div",{className:"user"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/temp_user_01.png"}),o.createElement("span",{className:"name"},"Jinny")),o.createElement("button",{className:"btn_close"})),o.createElement("div",{className:"content"},o.createElement("div",{className:"scroll"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/page_concept_board.png"}),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null),o.createElement("br",null))))),o.createElement(v.AlertPopup,{view:this._viewAlert,onClose:this._offAlert,onOk:"force"===this._alerttype?this._onSendStop:"livepoint"===this._alerttype?this._onSendLivePoint:this._onSendRetry,msg:"force"===this._alerttype?"Force Quit?":"livepoint"===this._alerttype?"Do you want to send <br> Green lives?":"Retry?"}),o.createElement(u.default,{view:0===this._prog,type:"teacher",sended:!1,originY:0,onSend:this._onSend}),o.createElement(_.BtnProgress,{view:this.finishBtn&&0!==this._prog,isEnd:this._isComplete,totalStudents:c.App.students?c.App.students.length:0,submitStudents:this._submitStudentCnt,onClick:this._isComplete?this._openRetryPopup:this._openForcePopup}),this.viewList&&this._prog>=2&&this._isViewSendLive&&!this.finishBtn?o.createElement(b.BtnSendLive,{view:!0,disabled:!this._isLivePoint,on:this._isLivePoint,onClick:this._onBtnHeaert}):void 0,o.createElement(m.SendnShare,{view:this._prog>=2&&this.viewList,type:"image",submitStudent:l.cloneDeep(this._submitStudents),isComplete:this._prog>=3&&this._isComplete,isReset:this.isReset,onSendPresenter:this._onSendPresenter,onSendLiveget:this._onSendLiveget,onHidePresenter:this._onHidePresenter,quizIdx:0,checkIsPlayed:this._checkisPlayed,isPlayed:this._isPlayed,onNext:this.onNext,onPrev:this.onPrev,contentType:"type03",clsIdx:this.props.state.classid,curriculumid:this.props.state.curriculumid}))}};i([a.observable],f.prototype,"_viewSample",void 0),i([a.observable],f.prototype,"_prog",void 0),i([a.observable],f.prototype,"_viewAlert",void 0),i([a.observable],f.prototype,"_submitStudents",void 0),i([a.observable],f.prototype,"_submitStudentCnt",void 0),i([a.observable],f.prototype,"_isComplete",void 0),i([a.observable],f.prototype,"isReset",void 0),i([a.observable],f.prototype,"_isPlayed",void 0),i([a.observable],f.prototype,"viewList",void 0),i([a.observable],f.prototype,"_alerttype",void 0),i([a.observable],f.prototype,"_isLivePoint",void 0),i([a.observable],f.prototype,"_isViewSendLive",void 0),i([a.observable],f.prototype,"finishBtn",void 0),i([a.observable],f.prototype,"_totalUsers",void 0),i([a.observable],f.prototype,"sendType",void 0),f=i([r.observer],f),e.TConceptBoard=f,e.default=f},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r},n=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TLyricsLab=void 0;const o=s(0),r=s(1),a=s(2),l=s(6),d=s(4),p=s(7),c=s(3),h=s(14),u=s(8),m=s(9),_=s(10),v=s(11),b=s(12),y=s(13);var f;!function(t){t[t.LODING=0]="LODING",t[t.READY=1]="READY",t[t.PLAY=2]="PLAY",t[t.PAUSE=3]="PAUSE",t[t.STOP=4]="STOP"}(f||(f={}));let g=class extends o.Component{constructor(t){super(t),this._viewSample=!1,this.beatList=[],this.beatAudio=new Audio,this.beatSelect="",this.beatProg=1,this._prog=0,this._viewAlert=!1,this._submitStudents=[],this._submitStudentCnt=0,this._isComplete=!1,this.isReset=!1,this._isPlayed=!1,this.viewList=!1,this._totalUsers=0,this._alerttype="",this._isLivePoint=!1,this._isViewSendLive=!0,this.finishBtn=!1,this.sendType="navileft",this.msg="Do you want to send\nGreen lives?",this.onViewSample=()=>{c.App.pub_playBtnTab(),this._viewSample=!0},this.onCloseSample=()=>{c.App.pub_playBtnTab(),this._viewSample=!1},this._offAlert=()=>{this._viewAlert=!1},this._openRetryPopup=()=>{this._viewAlert=!0,this._alerttype="retry"},this._openForcePopup=()=>{this._prog<=1||(this._viewAlert=!0,this._alerttype="force")},this._onSend=()=>{if(!this.props.view)return;this.beatAudio.pause(),this._prog=1,this.finishBtn=!0,c.App.pub_playToPad();d.sendPAD(10,{msgtype:"lyrics_lab_send"}),this.props.actions.setLyricsLabResultFnc(this._onLyricsLabResultFnc),this.props.actions.setAlertResponse(this._onSendLivePoint),this.props.actions.checkLivePoint(this._onMenuButtonClick),c.App.pub_reloadStudents(()=>n(this,void 0,void 0,(function*(){if(!this.props.view)return;if(1!==this._prog)return;yield p.wait(600),this._prog=2,this._setNavi(),this.viewList=!0,this.isReset=!1;const t={msgtype:"send_students",students:JSON.stringify(c.App.students)};if(this._totalUsers=c.App.students?c.App.students.length:0,d.sendPAD(10,t),2===this._prog)for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<this._totalUsers;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,videos:[""],audios:[""],beat:[],record:"",recordType:"",order:-1,nosubmit:!0},i=this._submitStudents[t].findIndex(t=>t.student.id===s.student.id);i<=-1?this._submitStudents[t].push(s):this._submitStudents[t][i].student=s.student}})))},this._onLyricsLabResultFnc=t=>{if(!this.props.view)return;if(this._submitStudentCnt===c.App.students.length)return;if(t.tryCnt<2)this._submitStudentCnt++;else if(t.tryCnt>=2)return;const e=l.find(c.App.students,{id:t.id});if(!e)return;const s=this._submitStudents[0].findIndex(e=>e.student.id===t.id);if(s>-1)this._submitStudents[0][s].trycnt=t.tryCnt,this._submitStudents[0][s].nosubmit=!1,this._submitStudents[0][s].images===[]?this._submitStudents[0][s].images.push(t.imageUrl):this._submitStudents[0][s].images[0]=t.imageUrl,""!==t.beat&&t.beat?this._submitStudents[0][s].beat.push(t.beat):this._submitStudents[0][s].beat=["/content/mathalive_lib/MA/module_portfolio/common/beat01.mp3"];else{let s={student:e,correct:!1,trycnt:1,livePoint:0,videos:[""],audios:[""],beat:t.beat?[t.beat[0]]:["/content/mathalive_lib/MA/module_portfolio/common/beat01.mp3"],recordType:"lyrics_lab",record:"",images:[t.imageUrl],nosubmit:!1};this._submitStudents[0].push(s)}this._submitStudentCnt===c.App.students.length&&(this._isComplete=!0,this.finishBtn=!1,this._prog=4,this.props.actions.setNavi(!0,!0))},this._onSendStop=()=>n(this,void 0,void 0,(function*(){if(!this.props.view)return;if(2!==this._prog)return;if(this._prog>=3)return;c.App.pub_playToPad();d.sendPAD(10,{msgtype:"send_stop"}),this._prog=3,this.finishBtn=this._viewAlert=!1,this.props.actions.setNavi(!0,!0),this._submitStudentCnt>0?this._isComplete=!0:this._isComplete=!1,this._alerttype="retry"})),this._onSendRetry=()=>{for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<c.App.students.length;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,videos:[""],audios:[""],recordType:"lyrics_lab",beat:[],record:"",order:-1,nosubmit:!0};this._submitStudents[t][e]=s}this._prog=0,this._viewAlert=!1,this._submitStudentCnt=0,this._isComplete=!1,this.isReset=!0;d.sendPAD(10,{msgtype:"retry"})},this._onSendPresenter=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t),i={msgtype:"presenter_send",step:5,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i),this.props.actions.setLivepointResultFnc(this._onLivePointResult),this._isViewSendLive=!1})),this._onLivePointResult=t=>{const e=this._submitStudents[0].findIndex(e=>e.student.id===t.to);300!==this._submitStudents[0][e].livePoint&&(this._submitStudents[0][e].livePoint+=t.livePoint)},this._onSendLiveget=t=>n(this,void 0,void 0,(function*(){const e=this._submitStudents[0].findIndex(e=>e.student.id===t);let s=this._submitStudents[0][e].livePoint;const i={msgtype:"presenter_end",studentId:t,livePoint:s};d.sendPAD(10,i),this._isViewSendLive=!0})),this._onHidePresenter=()=>{},this._checkisPlayed=()=>{this._isPlayed=!0},this.onNext=(t,e)=>n(this,void 0,void 0,(function*(){this.beatAudio.pause();const s=l.find(c.App.students,e=>e.id===t);d.sendPAD(10,{msgtype:"next_presenter"}),yield p.wait(600);const i={msgtype:"presenter_send",step:5,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i)})),this.onPrev=(t,e)=>n(this,void 0,void 0,(function*(){this.beatAudio.pause();const s=l.find(c.App.students,e=>e.id===t);d.sendPAD(10,{msgtype:"next_presenter"}),yield p.wait(600);const i={msgtype:"presenter_send",step:5,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i)})),this.beatPlay=t=>{if(this.beatAudio.loop=!0,this.cTime=this.beatAudio.currentTime,this.beatSelect!==this.beatList[t])return this.beatProg=2,this.beatAudio.currentTime=0,this.beatSelect=this.beatAudio.src=this.beatList[t],void this.beatAudio.play();2===this.beatProg?(this.beatProg=4,this.beatAudio.pause()):(this.beatProg=2,this.beatAudio.currentTime=this.cTime,this.beatAudio.play())},this._callBackFnc=(t,e,s)=>{let i=l.find(this._submitStudents[0],e=>e.student.id===t);i&&(i.livePoint=0);let n={live:e};if(d.sendPADToID(t,21,n),"navileft"===this.sendType&&this._submitStudents[0].length-1===s){const t={msgtype:"content_select"};this.props.state.prog="content_select",this.props.state.recordProg="",this._prog=0,d.sendPAD(0,t)}if("naviright"===this.sendType&&this._submitStudents[0].length-1===s){this.props.state.prog="math_journal_recording",this.props.state.recordProg="lyrics_lab";const t={msgtype:"math_journal_recording_ready"};d.sendPAD(10,t)}},this._onSendLivePoint=()=>{if(c.App.isDvlp&&(this._viewAlert=!1),this._submitStudents[0].length>0)for(let t=0;t<this._submitStudents[0].length;t++){let e={addOnHost:c.App.addOnHost,liveType:"green",plusMinusType:"plus",score:this._submitStudents[0][t].livePoint,userIdx:this._submitStudents[0][t].student.id,clsIdx:this.props.state.classid,depthItemIdx:this.props.state.curriculumid,callback:s=>{this._callBackFnc(e.userIdx,e.score,t)},error:t=>{console.log("Request Error ! Check the params")}};!c.App.isDvlp&&e.score>0&&y.setLivePoint(e),c.App.isDvlp&&this._callBackFnc(e.userIdx,e.score,t)}},this._onMenuButtonClick=()=>{this._isLivePoint&&(this.sendType="button",d.alertToTeacher({text:this.msg,from:"book"}))},this._onBtnHeaert=()=>{c.App.isDvlp?(this._alerttype="livepoint",this._viewAlert=!0,this.sendType="button"):(this.sendType="button",d.alertToTeacher({text:this.msg,from:"book"}))},this.cTime=0,this.keywords=this.props.actions.getData().keywords,this.dataGrade=this.props.actions.getData().grade,this._submitStudents.push([]);t.actions.getData();for(let t=1;t<7;t++)this.beatList.push(`/content/mathalive_lib/MA/module_portfolio/common/beat0${t}.mp3`);c.App.isDvlp&&(this.beatList[0]="/content/mathalive_lib/MA/module_portfolio/common/test_audio.mp3")}_checkLivePoint(){this._submitStudents[0].filter((t,e)=>t.livePoint>0).length>0?this._isLivePoint=!0:this._isLivePoint=!1}_setNavi(){this.props.view&&"lyrics_lab"===this.props.state.prog&&(this.beatAudio.pause(),this.props.actions.setNaviView(!0),this.props.actions.setNavi(!0,!1),this.props.actions.setNaviFnc(()=>{if(this._isLivePoint)return this.sendType="navileft",this._alerttype="livepoint",void(c.App.isDvlp?this._viewAlert=!0:d.alertToTeacher({text:this.msg,from:"book"}));this.props.state.prog="content_select",this.props.state.recordProg="",this._prog=0,d.sendPAD(0,{msgtype:"content_select"})},()=>{if(this._isLivePoint)return this.sendType="naviright",this._alerttype="livepoint",void(c.App.isDvlp?this._viewAlert=!0:d.alertToTeacher({text:this.msg,from:"book"}));this.props.state.prog="math_journal_recording",this.props.state.recordProg="lyrics_lab";d.sendPAD(10,{msgtype:"math_journal_recording_ready"})}))}componentDidUpdate(t){if(this.props.view&&!t.view){this._viewSample=!1,this._prog=0,this._isComplete=!1,this.viewList=!1,this._isPlayed=!1,this.props.actions.setAlertResponse(null),this.props.actions.checkLivePoint(null),this._submitStudents[0]=[];for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<c.App.students.length;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,videos:[""],audios:[""],beat:[],recordType:"lyrics_lab",record:"",order:-1,nosubmit:!0};this._submitStudents[t].findIndex(t=>t.student.id===s.student.id)<=-1?this._submitStudents[t].push(s):this._submitStudents[t][e]=s}const t={msgtype:"send_students",students:JSON.stringify(c.App.students)};d.sendPAD(10,t),this._setNavi()}else!this.props.view&&t.view&&(this._submitStudentCnt=0,this._viewSample=!1,this.beatSelect="",this.beatAudio.pause(),this.props.actions.setAlertResponse(null),this.props.actions.checkLivePoint(null),this._checkLivePoint());this.props.view&&this.viewList&&this._isComplete&&this._checkLivePoint(),2===this._prog||1===this._prog?this.props.state.navi.enableLeft=!1:this.props.state.navi.enableLeft=!0}render(){const{view:t,actions:e}=this.props;return o.createElement("div",{className:"t_lyrics_lab",style:{display:t?"":"none"}},o.createElement("div",{className:"topHeader",style:{display:this._prog<=1?"":"none"}},o.createElement("div",{className:"type c"},"TYPE ",o.createElement("span",null,"A")),o.createElement("button",{className:"btn_help"}),o.createElement("button",{className:"btn_answer"},"Answer")),o.createElement("div",{className:"portfolioContent",style:{display:this._prog<=1?"":"none"}},o.createElement("div",{className:"content"},o.createElement("div",{className:"artboard"},o.createElement("div",{className:"inner"},o.createElement("h2",null,"Lyrics Lab"),o.createElement("button",{className:"btn_sample",onClick:this.onViewSample},"Sample"),o.createElement("div",{className:"btn_set"},o.createElement("button",{onClick:()=>this.beatPlay(0),className:this.beatSelect===this.beatList[0]&&2===this.beatProg?"a check pause":this.beatSelect===this.beatList[0]&&4===this.beatProg?"a check play":"a"}),o.createElement("button",{onClick:()=>this.beatPlay(1),className:this.beatSelect===this.beatList[1]&&2===this.beatProg?"b check pause":this.beatSelect===this.beatList[1]&&4===this.beatProg?"b check play":"b"}),o.createElement("button",{onClick:()=>this.beatPlay(2),className:this.beatSelect===this.beatList[2]&&2===this.beatProg?"c check pause":this.beatSelect===this.beatList[2]&&4===this.beatProg?"c check play":"c"}),o.createElement("button",{onClick:()=>this.beatPlay(3),className:this.beatSelect===this.beatList[3]&&2===this.beatProg?"d check pause":this.beatSelect===this.beatList[3]&&4===this.beatProg?"d check play":"d"}),o.createElement("button",{onClick:()=>this.beatPlay(4),className:this.beatSelect===this.beatList[4]&&2===this.beatProg?"e check pause":this.beatSelect===this.beatList[4]&&4===this.beatProg?"e check play":"e"}),o.createElement("button",{onClick:()=>this.beatPlay(5),className:this.beatSelect===this.beatList[5]&&2===this.beatProg?"f check pause":this.beatSelect===this.beatList[5]&&4===this.beatProg?"f check play":"f"})))),o.createElement(h.default,{view:t,keywords:this.keywords})),o.createElement("div",{className:"controlbar hide"},o.createElement("button",{className:"btn mic"},o.createElement("div",{className:"bubble_note twinkle show"},o.createElement("span",null),o.createElement("span",null),o.createElement("span",null),o.createElement("span",null),o.createElement("span",null),o.createElement("span",null)))),o.createElement("div",{className:"video_screen hide"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/temp_video_screen.png"})),o.createElement("div",{className:"pop_lylics_lab "},o.createElement("div",{className:"stage"},o.createElement("div",{className:"header"},"Lyrics Lab",o.createElement("div",{className:"player"}),o.createElement("div",{className:"user"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/temp_user_01.png"}),o.createElement("span",{className:"name"},"Jinny")),o.createElement("button",{className:"btn_close"})),o.createElement("div",{className:"content"},o.createElement("div",{className:"scroll"},o.createElement("div",{className:"lyrics_sample"},o.createElement("ul",null,o.createElement("li",{className:"title"},"We can write the number in different ways!!",o.createElement("button",{className:"btn_cancel"})),o.createElement("li",null,"Its easy to represent big numbers!",o.createElement("button",{className:"btn_cancel"})),o.createElement("li",null,"What do I do? Listen carefully.",o.createElement("button",{className:"btn_cancel"})),o.createElement("li",null,"Thats what!",o.createElement("button",{className:"btn_cancel"})),o.createElement("li",null,"Expanded form!! Standard form!! Word form!!",o.createElement("button",{className:"btn_cancel"})),o.createElement("li",null,"Its easy to represent big numbers!",o.createElement("button",{className:"btn_cancel"})),o.createElement("li",null,"What do I do? Listen carefully.",o.createElement("button",{className:"btn_cancel"})),o.createElement("li",null,"Thats what!",o.createElement("button",{className:"btn_cancel"})),o.createElement("li",null,"Expanded form!! Standard form!! Word form!!",o.createElement("button",{className:"btn_cancel"}))))))))),o.createElement("div",{className:"pop"+(this._viewSample?" show":"")},o.createElement("div",{className:"stage"},o.createElement("div",{className:"header"},"Lyrics Lab",o.createElement("div",{className:"user"},o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/temp_user_01.png"}),o.createElement("span",{className:"name"},"Jinny")),o.createElement("button",{className:"btn_close",onClick:this.onCloseSample})),o.createElement("div",{className:"content"},o.createElement("div",{className:"scroll"},2===this.dataGrade?o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/sample/type04_upper.png"}):o.createElement("img",{src:"/content/mathalive_lib/MA/module_portfolio/common/sample/type04_lower.png"}))))),o.createElement(v.AlertPopup,{view:this._viewAlert,onClose:this._offAlert,onOk:"force"===this._alerttype?this._onSendStop:"livepoint"===this._alerttype?this._onSendLivePoint:this._onSendRetry,msg:"force"===this._alerttype?"Force Quit?":"livepoint"===this._alerttype?"Do you want to send <br> Green lives?":"Retry?"}),o.createElement(u.default,{view:0===this._prog,type:"teacher",sended:!1,originY:0,onSend:this._onSend}),o.createElement(_.BtnProgress,{view:this.finishBtn&&0!==this._prog,isEnd:this._isComplete,totalStudents:c.App.students?c.App.students.length:0,submitStudents:this._submitStudentCnt,onClick:this._isComplete?this._openRetryPopup:this._openForcePopup}),this.viewList&&this._prog>=2&&this._isViewSendLive&&!this.finishBtn?o.createElement(b.BtnSendLive,{view:!0,disabled:!this._isLivePoint,on:this._isLivePoint,onClick:this._onBtnHeaert}):void 0,o.createElement(m.SendnShare,{view:this._prog>=2&&this.viewList,type:"image",submitStudent:l.cloneDeep(this._submitStudents),isComplete:this._prog>=3&&this._isComplete,isReset:this.isReset,onSendPresenter:this._onSendPresenter,onSendLiveget:this._onSendLiveget,onHidePresenter:this._onHidePresenter,quizIdx:0,checkIsPlayed:this._checkisPlayed,isPlayed:this._isPlayed,onNext:this.onNext,onPrev:this.onPrev,contentType:"type04",clsIdx:this.props.state.classid,curriculumid:this.props.state.curriculumid}))}};i([a.observable],g.prototype,"_viewSample",void 0),i([a.observable],g.prototype,"beatAudio",void 0),i([a.observable],g.prototype,"beatSelect",void 0),i([a.observable],g.prototype,"beatProg",void 0),i([a.observable],g.prototype,"_prog",void 0),i([a.observable],g.prototype,"_viewAlert",void 0),i([a.observable],g.prototype,"_submitStudents",void 0),i([a.observable],g.prototype,"_submitStudentCnt",void 0),i([a.observable],g.prototype,"_isComplete",void 0),i([a.observable],g.prototype,"isReset",void 0),i([a.observable],g.prototype,"_isPlayed",void 0),i([a.observable],g.prototype,"viewList",void 0),i([a.observable],g.prototype,"_totalUsers",void 0),i([a.observable],g.prototype,"_alerttype",void 0),i([a.observable],g.prototype,"_isLivePoint",void 0),i([a.observable],g.prototype,"_isViewSendLive",void 0),i([a.observable],g.prototype,"finishBtn",void 0),i([a.observable],g.prototype,"sendType",void 0),g=i([r.observer],g),e.TLyricsLab=g,e.default=g},function(t,e,s){"use strict";var i=this&&this.__decorate||function(t,e,s,i){var n,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,s,r):n(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r},n=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TLetMeExplain=void 0;const o=s(0),r=s(1),a=s(2),l=s(6),d=s(4),p=s(7),c=s(3),h=s(8),u=s(9),m=s(10),_=s(11),v=s(12),b=s(13);let y=class extends o.Component{constructor(t){super(t),this._prog=0,this._viewAlert=!1,this._submitStudents=[],this._submitStudentCnt=0,this._isComplete=!1,this.isReset=!1,this.typeSel="",this._isPlayed=!1,this.viewList=!1,this.sample=!1,this.help=!1,this._alerttype="",this._isLivePoint=!1,this._isViewSendLive=!0,this.finishBtn=!1,this._totalUsers=0,this.sendType="navileft",this.msg="Do you want to send\nGreen lives?",this.ploblemList=[],this.ploblemAsList=[],this.ploblemHelp=[],this._offAlert=()=>{this._viewAlert=!1},this._openRetryPopup=()=>{this._viewAlert=!0,this._alerttype="retry"},this._openForcePopup=()=>{this._prog<=1||(this._viewAlert=!0,this._alerttype="force")},this._onSend=()=>{if(!this.props.view)return;let t;this._prog=1,this.finishBtn=!0,c.App.pub_playToPad(),"a"===this.typeSel?(t={msgtype:"let_me_explain_send_a"},d.sendPAD(10,t)):"b"===this.typeSel?(t={msgtype:"let_me_explain_send_b"},d.sendPAD(10,t)):"c"===this.typeSel&&(t={msgtype:"let_me_explain_send_c"},d.sendPAD(10,t)),this.props.actions.setLetMeExplainResultFnc(this._onLetMeExplainResultFnc),this.props.actions.setAlertResponse(this._onSendLivePoint),this.props.actions.checkLivePoint(this._onMenuButtonClick),c.App.pub_reloadStudents(()=>n(this,void 0,void 0,(function*(){if(!this.props.view)return;if(1!==this._prog)return;yield p.wait(600),this._prog=2,this._setNavi(),this.viewList=!0,this.isReset=!1;const t={msgtype:"send_students",students:JSON.stringify(c.App.students)};if(this._totalUsers=c.App.students?c.App.students.length:0,d.sendPAD(10,t),2===this._prog)for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<this._totalUsers;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,videos:[""],audios:[""],beat:[],record:"",recordType:"",order:-1,nosubmit:!0},i=this._submitStudents[t].findIndex(t=>t.student.id===s.student.id);i<=-1?this._submitStudents[t].push(s):this._submitStudents[t][i].student=s.student}})))},this._typeSel=t=>{this.typeSel=t,c.App.pub_playBtnTab()},this._onLetMeExplainResultFnc=t=>{if(!this.props.view||!this.finishBtn)return;if(this._submitStudentCnt===c.App.students.length)return;if(t.tryCnt<2)this._submitStudentCnt++;else if(t.tryCnt>=2)return;const e=l.find(c.App.students,{id:t.id});if(!e)return;const s=this._submitStudents[0].findIndex(e=>e.student.id===t.id);if(s>-1)this._submitStudents[0][s].trycnt=t.tryCnt,this._submitStudents[0][s].nosubmit=!1,this._submitStudents[0][s].images===[]?this._submitStudents[0][s].images.push(t.imageUrl):this._submitStudents[0][s].images[0]=t.imageUrl;else{let s={student:e,correct:!1,trycnt:1,livePoint:0,images:[t.imageUrl],record:"",beat:[],recordType:"",videos:[],audios:[],nosubmit:!1};this._submitStudents[0].push(s)}if(this._submitStudentCnt===c.App.students.length){this._isComplete=!0,this.finishBtn=!1,this._prog=4;const t={msgtype:"send_stop"};d.sendPAD(10,t),this.props.actions.setNavi(!0,!0)}},this._onSendStop=()=>n(this,void 0,void 0,(function*(){if(!this.props.view)return;if(2!==this._prog)return;if(this._prog>=3)return;c.App.pub_playToPad();d.sendPAD(10,{msgtype:"send_stop"}),this._prog=3,this.finishBtn=this._viewAlert=!1,this.props.actions.setNavi(!0,!0),this._submitStudentCnt>0?this._isComplete=!0:this._isComplete=!1,this._alerttype="retry"})),this._onSendRetry=()=>{for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<c.App.students.length;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,order:-1,videos:[""],audios:[""],beat:[],recordType:"",record:"",nosubmit:!0};this._submitStudents[t][e]=s}this._prog=0,this._viewAlert=!1,this._submitStudentCnt=0,this.typeSel="",this._isComplete=!1,this.isReset=!0;d.sendPAD(10,{msgtype:"retry"})},this._onSendPresenter=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t),i={msgtype:"presenter_send",step:6,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i),this.props.actions.setLivepointResultFnc(this._onLivePointResult),this._isViewSendLive=!1})),this._onLivePointResult=t=>{const e=this._submitStudents[0].findIndex(e=>e.student.id===t.to);300!==this._submitStudents[0][e].livePoint&&(this._submitStudents[0][e].livePoint+=t.livePoint)},this._onSendLiveget=t=>n(this,void 0,void 0,(function*(){const e=this._submitStudents[0].findIndex(e=>e.student.id===t);let s=this._submitStudents[0][e].livePoint;const i={msgtype:"presenter_end",studentId:t,livePoint:s};d.sendPAD(10,i),this._isViewSendLive=!0})),this._onHidePresenter=()=>{},this._sample=()=>{this.sample=!this.sample},this._help=()=>{this.help=!this.help},this._checkisPlayed=()=>{this._isPlayed=!0},this.onNext=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t);d.sendPAD(10,{msgtype:"next_presenter"}),yield p.wait(600);const i={msgtype:"presenter_send",step:6,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i)})),this.onPrev=(t,e)=>n(this,void 0,void 0,(function*(){const s=l.find(c.App.students,e=>e.id===t);d.sendPAD(10,{msgtype:"next_presenter"}),yield p.wait(600);const i={msgtype:"presenter_send",step:6,id:t,showhide:e,student:JSON.stringify(s)};d.sendPAD(10,i)})),this._callBackFnc=(t,e,s)=>{let i=l.find(this._submitStudents[0],e=>e.student.id===t);i&&(i.livePoint=0);let n={live:e};if(d.sendPADToID(t,21,n),"navileft"===this.sendType&&this._submitStudents[0].length-1===s&&(this.props.state.prog="content_select",this.props.state.recordProg="",this.typeSel="",this._prog=0,d.sendPAD(0,null)),"naviright"===this.sendType&&this._submitStudents[0].length-1===s){this.props.state.prog="math_journal_recording",this.props.state.recordProg="let_me_explain_a";const t={msgtype:"math_journal_recording_ready"};d.sendPAD(10,t)}},this._onSendLivePoint=()=>{if(c.App.isDvlp&&(this._viewAlert=!1),this._submitStudents[0].length>0)for(let t=0;t<this._submitStudents[0].length;t++){let e={addOnHost:c.App.addOnHost,liveType:"green",plusMinusType:"plus",score:this._submitStudents[0][t].livePoint,userIdx:this._submitStudents[0][t].student.id,clsIdx:this.props.state.classid,depthItemIdx:this.props.state.curriculumid,callback:s=>{this._callBackFnc(e.userIdx,e.score,t)},error:t=>{console.log("Request Error ! Check the params")}};!c.App.isDvlp&&e.score>0&&b.setLivePoint(e),c.App.isDvlp&&this._callBackFnc(e.userIdx,e.score,t)}},this._onMenuButtonClick=()=>{this._isLivePoint&&(this.sendType="button",d.alertToTeacher({text:this.msg,from:"book"}))},this._onBtnHeaert=()=>{c.App.isDvlp?(this._alerttype="livepoint",this._viewAlert=!0,this.sendType="button"):(this.sendType="button",d.alertToTeacher({text:this.msg,from:"book"}))},this._submitStudents.push([]);const e=t.actions.getData();this.dataGrade=e.grade,e.explain.map((t,e)=>{this.ploblemList.push(`${c.App.data_url}${t.explain}`),this.ploblemAsList.push(`${c.App.data_url}${t.answer}`),this.ploblemHelp.push(t.explainhelp)})}_checkLivePoint(){this._submitStudents[0].filter((t,e)=>t.livePoint>0).length>0?this._isLivePoint=!0:this._isLivePoint=!1}_setNavi(){this.props.view&&("let_me_explain_a"!==this.props.state.prog&&"let_me_explain_b"!==this.props.state.prog&&"let_me_explain_c"!==this.props.state.prog||(this.props.actions.setNaviView(!0),this.props.actions.setNavi(!0,!1),this.props.actions.setNaviFnc(()=>{if(this._isLivePoint)return this.sendType="navileft",this._alerttype="livepoint",void(c.App.isDvlp?this._viewAlert=!0:d.alertToTeacher({text:this.msg,from:"book"}));this.props.state.prog="content_select",this.props.state.recordProg="",this.finishBtn=!1,this.typeSel="",this._prog=0,d.sendPAD(0,null)},()=>{if(this._isLivePoint)return this.sendType="naviright",this._alerttype="livepoint",void(c.App.isDvlp?this._viewAlert=!0:d.alertToTeacher({text:this.msg,from:"book"}));this.props.state.prog="math_journal_recording",this.props.state.recordProg="let_me_explain_a";d.sendPAD(10,{msgtype:"math_journal_recording_ready"})})))}componentDidUpdate(t){if(this.props.view&&!t.view){this._prog=0,this._isComplete=!1,this.help=!1,this.viewList=!1,this._isPlayed=!1,this.props.actions.setAlertResponse(null),this.props.actions.checkLivePoint(null),this._submitStudents[0]=[];for(let t=0;t<this._submitStudents.length;t++)for(let e=0;e<c.App.students.length;e++){let s={student:c.App.students[e],correct:!1,trycnt:0,images:[],livePoint:0,videos:[""],audios:[""],beat:[],record:"",recordType:"",order:-1,nosubmit:!0};this._submitStudents[t].findIndex(t=>t.student.id===s.student.id)<=-1?this._submitStudents[t].push(s):this._submitStudents[t][e]=s}const t={msgtype:"send_students",students:JSON.stringify(c.App.students)};d.sendPAD(10,t),this._setNavi()}else!this.props.view&&t.view&&(this.typeSel="",this._submitStudentCnt=0,this.props.actions.setAlertResponse(null),this.props.actions.checkLivePoint(null),this._checkLivePoint());this.props.view&&this.viewList&&this._isComplete&&this._checkLivePoint(),2===this._prog||1===this._prog?this.props.state.navi.enableLeft=!1:this.props.state.navi.enableLeft=!0}render(){const{view:t}=this.props;let e=-1;return"a"===this.typeSel?e=0:"b"===this.typeSel?e=1:"c"===this.typeSel&&(e=2),o.createElement("div",{className:"t_letme_explain",style:{display:t?"":"none"}},o.createElement("div",{className:"topHeader",style:{display:this._prog<=1?"":"none"}},"a"===this.typeSel?o.createElement("div",{className:"type a"},"TYPE ",o.createElement("span",null,"A")):void 0,"b"===this.typeSel?o.createElement("div",{className:"type b"},"TYPE ",o.createElement("span",null,"B")):void 0,"c"===this.typeSel?o.createElement("div",{className:"type c"},"TYPE ",o.createElement("span",null,"C")):void 0,o.createElement("div",{className:"help",style:{display:e>=0&&""!==this.ploblemHelp[e]?void 0:"none"}},o.createElement("button",{className:"btn_help "+(this.help?"on":""),onClick:this._help}),o.createElement("div",{className:this.help?"help_explain":"help_explain hide"},o.createElement("div",{className:"inner",dangerouslySetInnerHTML:{__html:this.ploblemHelp[e]+""}}))),""!==this.typeSel?o.createElement("button",{className:"btn_answer",onClick:this._sample},"Answer"):void 0),o.createElement("div",{className:"t_letme_explain_detail",style:{display:this.sample?"":"none"}},o.createElement("div",{className:"pop_solve_zone"},o.createElement("div",{className:"content"},o.createElement("button",{className:"btn_close",onClick:this._sample}),"a"===this.typeSel?o.createElement("img",{src:""+this.ploblemAsList[0]}):void 0,"b"===this.typeSel?o.createElement("img",{src:""+this.ploblemAsList[1]}):void 0,"c"===this.typeSel?o.createElement("img",{src:""+this.ploblemAsList[2]}):void 0))),o.createElement("div",{className:"portfolioContent",style:{display:this._prog<=1?"":"none"}},o.createElement("div",{style:{display:""===this.typeSel?"":"none"}},o.createElement("h2",null,"Let Me Explain"),o.createElement("div",{className:"btn_set"},o.createElement("button",{className:"a",onClick:this._typeSel.bind(this,"a")}),o.createElement("button",{className:"b",onClick:this._typeSel.bind(this,"b")}),o.createElement("button",{className:"c",onClick:this._typeSel.bind(this,"c")}))),o.createElement("div",{style:{display:""===this.typeSel?"none":""}},"a"===this.typeSel?o.createElement("img",{src:""+this.ploblemList[0]}):void 0,"b"===this.typeSel?o.createElement("img",{src:""+this.ploblemList[1]}):void 0,"c"===this.typeSel?o.createElement("img",{src:""+this.ploblemList[2]}):void 0)),o.createElement(_.AlertPopup,{view:this._viewAlert,onClose:this._offAlert,onOk:"force"===this._alerttype?this._onSendStop:"livepoint"===this._alerttype?this._onSendLivePoint:this._onSendRetry,msg:"force"===this._alerttype?"Force Quit?":"livepoint"===this._alerttype?"Do you want to send <br> Green lives?":"Retry?"}),o.createElement(h.default,{view:""!==this.typeSel,type:"teacher",sended:!1,originY:0,onSend:this._onSend}),o.createElement(m.BtnProgress,{view:this.finishBtn&&0!==this._prog,isEnd:this._isComplete,totalStudents:c.App.students?c.App.students.length:0,submitStudents:this._submitStudentCnt,onClick:this._isComplete?this._openRetryPopup:this._openForcePopup}),this.viewList&&this._prog>=2&&this._isViewSendLive&&!this.finishBtn?o.createElement(v.BtnSendLive,{view:!0,disabled:!this._isLivePoint,on:this._isLivePoint,onClick:this._onBtnHeaert}):void 0,o.createElement(u.SendnShare,{view:this._prog>=2&&this.viewList,type:"image",submitStudent:l.cloneDeep(this._submitStudents),isComplete:this._prog>=3&&this._isComplete,isReset:this.isReset,onSendPresenter:this._onSendPresenter,onSendLiveget:this._onSendLiveget,onHidePresenter:this._onHidePresenter,quizIdx:0,checkIsPlayed:this._checkisPlayed,isPlayed:this._isPlayed,onNext:this.onNext,onPrev:this.onPrev,contentType:"type05",clsIdx:this.props.state.classid,curriculumid:this.props.state.curriculumid}))}};i([a.observable],y.prototype,"_prog",void 0),i([a.observable],y.prototype,"_viewAlert",void 0),i([a.observable],y.prototype,"_submitStudents",void 0),i([a.observable],y.prototype,"_submitStudentCnt",void 0),i([a.observable],y.prototype,"_isComplete",void 0),i([a.observable],y.prototype,"isReset",void 0),i([a.observable],y.prototype,"typeSel",void 0),i([a.observable],y.prototype,"_isPlayed",void 0),i([a.observable],y.prototype,"viewList",void 0),i([a.observable],y.prototype,"sample",void 0),i([a.observable],y.prototype,"help",void 0),i([a.observable],y.prototype,"_alerttype",void 0),i([a.observable],y.prototype,"_isLivePoint",void 0),i([a.observable],y.prototype,"_isViewSendLive",void 0),i([a.observable],y.prototype,"finishBtn",void 0),i([a.observable],y.prototype,"_totalUsers",void 0),i([a.observable],y.prototype,"sendType",void 0),y=i([r.observer],y),e.TLetMeExplain=y,e.default=y},function(t,e,s){"use strict";s.r(e)}]);